import{a as vf,b as ds,c as fs,d as Pf,e as ps,f as Ua,g as ms,h as Ba,i as gs,j as _s,k as ys,l as vs}from"./chunk-HAIAN5VX.js";import{a as Ef,b as wf,d as Fa,e as us,f as Tf,g as If,h as Sf,i as Af,j as bf,k as Va,l as hs,m as Cf,n as Yt,q as Rf,r as je,s as Hn}from"./chunk-74K6VITO.js";import{$ as Xd,A as zd,B as ss,C as Wd,D as Gd,Ea as of,F as Qt,Fa as af,G as xa,Ga as cf,H as Kd,J as Hd,K as Qd,L as Yd,M as Kn,N as os,O as Ma,P as as,Q as V,S as J,T as Me,Ta as lf,U as Z,V as G,W as K,Wa as uf,Xa as hf,Y as ee,Z as Jd,Za as df,a as Q,aa as Le,b as ce,c as Ud,ca as cs,cb as ff,d as Gt,da as Zd,e as m,f as Kt,g as Bd,gb as pf,hb as mf,i as qd,ia as ef,ib as gf,j as $d,ja as ot,jb as _f,k as is,ka as ls,l as bt,m as ka,mb as yf,n as Dr,o as Da,oa as tf,pa as La,q as Ht,r as jd,s as ie,t as Oa,ta as nf,u as Ct,ua as rf,w as Gn,wa as sf,x as st,xa as ve,y as Qe,z as Or}from"./chunk-Z65UEY6O.js";var Nf=[{path:"login",loadChildren:()=>import("./chunk-HAAB2PO4.js").then(t=>t.LOGIN_ROUTES)},{path:"main",loadChildren:()=>import("./chunk-2FNI6PZ2.js").then(t=>t.MAIN_ROUTES)},{path:"rounds",loadChildren:()=>import("./chunk-TCHRV54O.js").then(t=>t.ROUNDS_ROUTES)},{path:"**",pathMatch:"full",redirectTo:"main"}];var N=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(N||{}),at="*";function kf(t,e=null){return{type:N.Sequence,steps:t,options:e}}function qa(t){return{type:N.Style,styles:t,offset:null}}var Jt=class{constructor(e=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){let n=e=="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},xr=class{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let n=0,r=0,i=0,s=this.players.length;s==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++n==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){let n=e*this.totalTime;this.players.forEach(r=>{let i=r.totalTime?Math.min(1,n/r.totalTime):1;r.setPosition(i)})}getPosition(){let e=this.players.reduce((n,r)=>n===null||r.totalTime>n.totalTime?r:n,null);return e!=null?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){let n=e=="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},Es="!";function Df(t){return new V(3e3,!1)}function Zv(){return new V(3100,!1)}function eE(){return new V(3101,!1)}function tE(t){return new V(3001,!1)}function nE(t){return new V(3003,!1)}function rE(t){return new V(3004,!1)}function iE(t,e){return new V(3005,!1)}function sE(){return new V(3006,!1)}function oE(){return new V(3007,!1)}function aE(t,e){return new V(3008,!1)}function cE(t){return new V(3002,!1)}function lE(t,e,n,r,i){return new V(3010,!1)}function uE(){return new V(3011,!1)}function hE(){return new V(3012,!1)}function dE(){return new V(3200,!1)}function fE(){return new V(3202,!1)}function pE(){return new V(3013,!1)}function mE(t){return new V(3014,!1)}function gE(t){return new V(3015,!1)}function _E(t){return new V(3016,!1)}function yE(t,e){return new V(3404,!1)}function vE(t){return new V(3502,!1)}function EE(t){return new V(3503,!1)}function wE(){return new V(3300,!1)}function TE(t){return new V(3504,!1)}function IE(t){return new V(3301,!1)}function SE(t,e){return new V(3302,!1)}function AE(t){return new V(3303,!1)}function bE(t,e){return new V(3400,!1)}function CE(t){return new V(3401,!1)}function RE(t){return new V(3402,!1)}function PE(t,e){return new V(3505,!1)}function Xt(t){switch(t.length){case 0:return new Jt;case 1:return t[0];default:return new xr(t)}}function Gf(t,e,n=new Map,r=new Map){let i=[],s=[],o=-1,a=null;if(e.forEach(c=>{let l=c.get("offset"),u=l==o,h=u&&a||new Map;c.forEach((d,p)=>{let f=p,g=d;if(p!=="offset")switch(f=t.normalizePropertyName(f,i),g){case Es:g=n.get(p);break;case at:g=r.get(p);break;default:g=t.normalizeStyleValue(p,f,g,i);break}h.set(f,g)}),u||s.push(h),a=h,o=l}),i.length)throw vE(i);return s}function uc(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&$a(n,"start",t)));break;case"done":t.onDone(()=>r(n&&$a(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&$a(n,"destroy",t)));break}}function $a(t,e,n){let r=n.totalTime,i=!!n.disabled,s=hc(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,r??t.totalTime,i),o=t._data;return o!=null&&(s._data=o),s}function hc(t,e,n,r,i="",s=0,o){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function Ve(t,e,n){let r=t.get(e);return r||t.set(e,r=n),r}function Of(t){let e=t.indexOf(":"),n=t.substring(1,e),r=t.slice(e+1);return[n,r]}var NE=typeof document>"u"?null:document.documentElement;function dc(t){let e=t.parentNode||t.host||null;return e===NE?null:e}function kE(t){return t.substring(1,6)=="ebkit"}var yn=null,xf=!1;function DE(t){yn||(yn=OE()||{},xf=yn.style?"WebkitAppearance"in yn.style:!1);let e=!0;return yn.style&&!kE(t)&&(e=t in yn.style,!e&&xf&&(e="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in yn.style)),e}function OE(){return typeof document<"u"?document.body:null}function Kf(t,e){for(;e;){if(e===t)return!0;e=dc(e)}return!1}function Hf(t,e,n){if(n)return Array.from(t.querySelectorAll(e));let r=t.querySelector(e);return r?[r]:[]}var fc=(()=>{let e=class e{validateStyleProperty(r){return DE(r)}matchesElement(r,i){return!1}containsElement(r,i){return Kf(r,i)}getParentElement(r){return dc(r)}query(r,i,s){return Hf(r,i,s)}computeStyle(r,i,s){return s||""}animate(r,i,s,o,a,c=[],l){return new Jt(s,o)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})(),_c=class _c{};_c.NOOP=new fc;var wn=_c,Tn=class{};var xE=1e3,Qf="{{",ME="}}",Yf="ng-enter",Ha="ng-leave",ws="ng-trigger",bs=".ng-trigger",Mf="ng-animating",Qa=".ng-animating";function Rt(t){if(typeof t=="number")return t;let e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Ya(parseFloat(e[1]),e[2])}function Ya(t,e){switch(e){case"s":return t*xE;default:return t}}function Cs(t,e,n){return t.hasOwnProperty("duration")?t:LE(t,e,n)}function LE(t,e,n){let r=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,i,s=0,o="";if(typeof t=="string"){let a=t.match(r);if(a===null)return e.push(Df(t)),{duration:0,delay:0,easing:""};i=Ya(parseFloat(a[1]),a[2]);let c=a[3];c!=null&&(s=Ya(parseFloat(c),a[4]));let l=a[5];l&&(o=l)}else i=t;if(!n){let a=!1,c=e.length;i<0&&(e.push(Zv()),a=!0),s<0&&(e.push(eE()),a=!0),a&&e.splice(c,0,Df(t))}return{duration:i,delay:s,easing:o}}function FE(t){return t.length?t[0]instanceof Map?t:t.map(e=>new Map(Object.entries(e))):[]}function ct(t,e,n){e.forEach((r,i)=>{let s=pc(i);n&&!n.has(i)&&n.set(i,t.style[s]),t.style[s]=r})}function En(t,e){e.forEach((n,r)=>{let i=pc(r);t.style[i]=""})}function Mr(t){return Array.isArray(t)?t.length==1?t[0]:kf(t):t}function VE(t,e,n){let r=e.params||{},i=Jf(t);i.length&&i.forEach(s=>{r.hasOwnProperty(s)||n.push(tE(s))})}var Ja=new RegExp(`${Qf}\\s*(.+?)\\s*${ME}`,"g");function Jf(t){let e=[];if(typeof t=="string"){let n;for(;n=Ja.exec(t);)e.push(n[1]);Ja.lastIndex=0}return e}function Fr(t,e,n){let r=`${t}`,i=r.replace(Ja,(s,o)=>{let a=e[o];return a==null&&(n.push(nE(o)),a=""),a.toString()});return i==r?t:i}var UE=/-+([a-z0-9])/g;function pc(t){return t.replace(UE,(...e)=>e[1].toUpperCase())}function BE(t,e){return t===0||e===0}function qE(t,e,n){if(n.size&&e.length){let r=e[0],i=[];if(n.forEach((s,o)=>{r.has(o)||i.push(o),r.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,mc(t,a)))}}return e}function Fe(t,e,n){switch(e.type){case N.Trigger:return t.visitTrigger(e,n);case N.State:return t.visitState(e,n);case N.Transition:return t.visitTransition(e,n);case N.Sequence:return t.visitSequence(e,n);case N.Group:return t.visitGroup(e,n);case N.Animate:return t.visitAnimate(e,n);case N.Keyframes:return t.visitKeyframes(e,n);case N.Style:return t.visitStyle(e,n);case N.Reference:return t.visitReference(e,n);case N.AnimateChild:return t.visitAnimateChild(e,n);case N.AnimateRef:return t.visitAnimateRef(e,n);case N.Query:return t.visitQuery(e,n);case N.Stagger:return t.visitStagger(e,n);default:throw rE(e.type)}}function mc(t,e){return window.getComputedStyle(t)[e]}var $E=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),Rs=class extends Tn{normalizePropertyName(e,n){return pc(e)}normalizeStyleValue(e,n,r,i){let s="",o=r.toString().trim();if($E.has(n)&&r!==0&&r!=="0")if(typeof r=="number")s="px";else{let a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&i.push(iE(e,r))}return o+s}};var Ps="*";function jE(t,e){let n=[];return typeof t=="string"?t.split(/\s*,\s*/).forEach(r=>zE(r,n,e)):n.push(t),n}function zE(t,e,n){if(t[0]==":"){let c=WE(t,n);if(typeof c=="function"){e.push(c);return}t=c}let r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(r==null||r.length<4)return n.push(gE(t)),e;let i=r[1],s=r[2],o=r[3];e.push(Lf(i,o));let a=i==Ps&&o==Ps;s[0]=="<"&&!a&&e.push(Lf(o,i))}function WE(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,r)=>parseFloat(r)>parseFloat(n);case":decrement":return(n,r)=>parseFloat(r)<parseFloat(n);default:return e.push(_E(t)),"* => *"}}var Ts=new Set(["true","1"]),Is=new Set(["false","0"]);function Lf(t,e){let n=Ts.has(t)||Is.has(t),r=Ts.has(e)||Is.has(e);return(i,s)=>{let o=t==Ps||t==i,a=e==Ps||e==s;return!o&&n&&typeof i=="boolean"&&(o=i?Ts.has(t):Is.has(t)),!a&&r&&typeof s=="boolean"&&(a=s?Ts.has(e):Is.has(e)),o&&a}}var Xf=":self",GE=new RegExp(`s*${Xf}s*,?`,"g");function Zf(t,e,n,r){return new Xa(t).build(e,n,r)}var Ff="",Xa=class{constructor(e){this._driver=e}build(e,n,r){let i=new Za(n);return this._resetContextStyleTimingState(i),Fe(this,Mr(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector=Ff,e.collectedStyles=new Map,e.collectedStyles.set(Ff,new Map),e.currentTime=0}visitTrigger(e,n){let r=n.queryCount=0,i=n.depCount=0,s=[],o=[];return e.name.charAt(0)=="@"&&n.errors.push(sE()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),a.type==N.State){let c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,s.push(this.visitState(c,n))}),c.name=l}else if(a.type==N.Transition){let c=this.visitTransition(a,n);r+=c.queryCount,i+=c.depCount,o.push(c)}else n.errors.push(oE())}),{type:N.Trigger,name:e.name,states:s,transitions:o,queryCount:r,depCount:i,options:null}}visitState(e,n){let r=this.visitStyle(e.styles,n),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){let s=new Set,o=i||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{Jf(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&n.errors.push(aE(e.name,[...s.values()]))}return{type:N.State,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,n){n.queryCount=0,n.depCount=0;let r=Fe(this,Mr(e.animation),n),i=jE(e.expr,n.errors);return{type:N.Transition,matchers:i,animation:r,queryCount:n.queryCount,depCount:n.depCount,options:vn(e.options)}}visitSequence(e,n){return{type:N.Sequence,steps:e.steps.map(r=>Fe(this,r,n)),options:vn(e.options)}}visitGroup(e,n){let r=n.currentTime,i=0,s=e.steps.map(o=>{n.currentTime=r;let a=Fe(this,o,n);return i=Math.max(i,n.currentTime),a});return n.currentTime=i,{type:N.Group,steps:s,options:vn(e.options)}}visitAnimate(e,n){let r=YE(e.timings,n.errors);n.currentAnimateTimings=r;let i,s=e.styles?e.styles:qa({});if(s.type==N.Keyframes)i=this.visitKeyframes(s,n);else{let o=e.styles,a=!1;if(!o){a=!0;let l={};r.easing&&(l.easing=r.easing),o=qa(l)}n.currentTime+=r.duration+r.delay;let c=this.visitStyle(o,n);c.isEmptyStep=a,i=c}return n.currentAnimateTimings=null,{type:N.Animate,timings:r,style:i,options:null}}visitStyle(e,n){let r=this._makeStyleAst(e,n);return this._validateStyleAst(r,n),r}_makeStyleAst(e,n){let r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)typeof a=="string"?a===at?r.push(a):n.errors.push(cE(a)):r.push(new Map(Object.entries(a)));let s=!1,o=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s)){for(let c of a.values())if(c.toString().indexOf(Qf)>=0){s=!0;break}}}),{type:N.Style,styles:r,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,n){let r=n.currentAnimateTimings,i=n.currentTime,s=n.currentTime;r&&s>0&&(s-=r.duration+r.delay),e.styles.forEach(o=>{typeof o!="string"&&o.forEach((a,c)=>{let l=n.collectedStyles.get(n.currentQuerySelector),u=l.get(c),h=!0;u&&(s!=i&&s>=u.startTime&&i<=u.endTime&&(n.errors.push(lE(c,u.startTime,u.endTime,s,i)),h=!1),s=u.startTime),h&&l.set(c,{startTime:s,endTime:i}),n.options&&VE(a,n.options,n.errors)})})}visitKeyframes(e,n){let r={type:N.Keyframes,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(uE()),r;let i=1,s=0,o=[],a=!1,c=!1,l=0,u=e.steps.map(I=>{let P=this._makeStyleAst(I,n),D=P.offset!=null?P.offset:QE(P.styles),E=0;return D!=null&&(s++,E=P.offset=D),c=c||E<0||E>1,a=a||E<l,l=E,o.push(E),P});c&&n.errors.push(hE()),a&&n.errors.push(dE());let h=e.steps.length,d=0;s>0&&s<h?n.errors.push(fE()):s==0&&(d=i/(h-1));let p=h-1,f=n.currentTime,g=n.currentAnimateTimings,v=g.duration;return u.forEach((I,P)=>{let D=d>0?P==p?1:d*P:o[P],E=D*v;n.currentTime=f+g.delay+E,g.duration=E,this._validateStyleAst(I,n),I.offset=D,r.styles.push(I)}),r}visitReference(e,n){return{type:N.Reference,animation:Fe(this,Mr(e.animation),n),options:vn(e.options)}}visitAnimateChild(e,n){return n.depCount++,{type:N.AnimateChild,options:vn(e.options)}}visitAnimateRef(e,n){return{type:N.AnimateRef,animation:this.visitReference(e.animation,n),options:vn(e.options)}}visitQuery(e,n){let r=n.currentQuerySelector,i=e.options||{};n.queryCount++,n.currentQuery=e;let[s,o]=KE(e.selector);n.currentQuerySelector=r.length?r+" "+s:s,Ve(n.collectedStyles,n.currentQuerySelector,new Map);let a=Fe(this,Mr(e.animation),n);return n.currentQuery=null,n.currentQuerySelector=r,{type:N.Query,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:vn(e.options)}}visitStagger(e,n){n.currentQuery||n.errors.push(pE());let r=e.timings==="full"?{duration:0,delay:0,easing:"full"}:Cs(e.timings,n.errors,!0);return{type:N.Stagger,animation:Fe(this,Mr(e.animation),n),timings:r,options:null}}};function KE(t){let e=!!t.split(/\s*,\s*/).find(n=>n==Xf);return e&&(t=t.replace(GE,"")),t=t.replace(/@\*/g,bs).replace(/@\w+/g,n=>bs+"-"+n.slice(1)).replace(/:animating/g,Qa),[t,e]}function HE(t){return t?Q({},t):null}var Za=class{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function QE(t){if(typeof t=="string")return null;let e=null;if(Array.isArray(t))t.forEach(n=>{if(n instanceof Map&&n.has("offset")){let r=n;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){let n=t;e=parseFloat(n.get("offset")),n.delete("offset")}return e}function YE(t,e){if(t.hasOwnProperty("duration"))return t;if(typeof t=="number"){let s=Cs(t,e).duration;return ja(s,0,"")}let n=t;if(n.split(/\s+/).some(s=>s.charAt(0)=="{"&&s.charAt(1)=="{")){let s=ja(0,0,"");return s.dynamic=!0,s.strValue=n,s}let i=Cs(n,e);return ja(i.duration,i.delay,i.easing)}function vn(t){return t?(t=Q({},t),t.params&&(t.params=HE(t.params))):t={},t}function ja(t,e,n){return{duration:t,delay:e,easing:n}}function gc(t,e,n,r,i,s,o=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}var Vr=class{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,n){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...n)}has(e){return this._map.has(e)}clear(){this._map.clear()}},JE=1,XE=":enter",ZE=new RegExp(XE,"g"),ew=":leave",tw=new RegExp(ew,"g");function ep(t,e,n,r,i,s=new Map,o=new Map,a,c,l=[]){return new ec().buildKeyframes(t,e,n,r,i,s,o,a,c,l)}var ec=class{buildKeyframes(e,n,r,i,s,o,a,c,l,u=[]){l=l||new Vr;let h=new tc(e,n,l,i,s,u,[]);h.options=c;let d=c.delay?Rt(c.delay):0;h.currentTimeline.delayNextStep(d),h.currentTimeline.setStyles([o],null,h.errors,c),Fe(this,r,h);let p=h.timelines.filter(f=>f.containsAnimation());if(p.length&&a.size){let f;for(let g=p.length-1;g>=0;g--){let v=p[g];if(v.element===n){f=v;break}}f&&!f.allowOnlyTimelineStyles()&&f.setStyles([a],null,h.errors,c)}return p.length?p.map(f=>f.buildKeyframes()):[gc(n,[],[],[],0,d,"",!1)]}visitTrigger(e,n){}visitState(e,n){}visitTransition(e,n){}visitAnimateChild(e,n){let r=n.subInstructions.get(n.element);if(r){let i=n.createSubContext(e.options),s=n.currentTimeline.currentTime,o=this._visitSubInstructions(r,i,i.options);s!=o&&n.transformIntoNewTimeline(o)}n.previousNode=e}visitAnimateRef(e,n){let r=n.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],n,r),this.visitReference(e.animation,r),n.transformIntoNewTimeline(r.currentTimeline.currentTime),n.previousNode=e}_applyAnimationRefDelays(e,n,r){for(let i of e){let s=i?.delay;if(s){let o=typeof s=="number"?s:Rt(Fr(s,i?.params??{},n.errors));r.delayNextStep(o)}}}_visitSubInstructions(e,n,r){let s=n.currentTimeline.currentTime,o=r.duration!=null?Rt(r.duration):null,a=r.delay!=null?Rt(r.delay):null;return o!==0&&e.forEach(c=>{let l=n.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,n){n.updateOptions(e.options,!0),Fe(this,e.animation,n),n.previousNode=e}visitSequence(e,n){let r=n.subContextCount,i=n,s=e.options;if(s&&(s.params||s.delay)&&(i=n.createSubContext(s),i.transformIntoNewTimeline(),s.delay!=null)){i.previousNode.type==N.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=Ns);let o=Rt(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Fe(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),n.previousNode=e}visitGroup(e,n){let r=[],i=n.currentTimeline.currentTime,s=e.options&&e.options.delay?Rt(e.options.delay):0;e.steps.forEach(o=>{let a=n.createSubContext(e.options);s&&a.delayNextStep(s),Fe(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(o=>n.currentTimeline.mergeTimelineCollectedStyles(o)),n.transformIntoNewTimeline(i),n.previousNode=e}_visitTiming(e,n){if(e.dynamic){let r=e.strValue,i=n.params?Fr(r,n.params,n.errors):r;return Cs(i,n.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,n){let r=n.currentAnimateTimings=this._visitTiming(e.timings,n),i=n.currentTimeline;r.delay&&(n.incrementTime(r.delay),i.snapshotCurrentStyles());let s=e.style;s.type==N.Keyframes?this.visitKeyframes(s,n):(n.incrementTime(r.duration),this.visitStyle(s,n),i.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=e}visitStyle(e,n){let r=n.currentTimeline,i=n.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();let s=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(s):r.setStyles(e.styles,s,n.errors,n.options),n.previousNode=e}visitKeyframes(e,n){let r=n.currentAnimateTimings,i=n.currentTimeline.duration,s=r.duration,a=n.createSubContext().currentTimeline;a.easing=r.easing,e.styles.forEach(c=>{let l=c.offset||0;a.forwardTime(l*s),a.setStyles(c.styles,c.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(i+s),n.previousNode=e}visitQuery(e,n){let r=n.currentTimeline.currentTime,i=e.options||{},s=i.delay?Rt(i.delay):0;s&&(n.previousNode.type===N.Style||r==0&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=Ns);let o=r,a=n.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,n.errors);n.currentQueryTotal=a.length;let c=null;a.forEach((l,u)=>{n.currentQueryIndex=u;let h=n.createSubContext(e.options,l);s&&h.delayNextStep(s),l===n.element&&(c=h.currentTimeline),Fe(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe();let d=h.currentTimeline.currentTime;o=Math.max(o,d)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(o),c&&(n.currentTimeline.mergeTimelineCollectedStyles(c),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=e}visitStagger(e,n){let r=n.parentContext,i=n.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(n.currentQueryTotal-1),c=o*n.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=r.currentStaggerTime;break}let u=n.currentTimeline;c&&u.delayNextStep(c);let h=u.currentTime;Fe(this,e.animation,n),n.previousNode=e,r.currentStaggerTime=i.currentTime-h+(i.startTime-r.currentTimeline.startTime)}},Ns={},tc=class t{constructor(e,n,r,i,s,o,a,c){this._driver=e,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Ns,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new ks(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,n){if(!e)return;let r=e,i=this.options;r.duration!=null&&(i.duration=Rt(r.duration)),r.delay!=null&&(i.delay=Rt(r.delay));let s=r.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!n||!o.hasOwnProperty(a))&&(o[a]=Fr(s[a],o,this.errors))})}}_copyOptions(){let e={};if(this.options){let n=this.options.params;if(n){let r=e.params={};Object.keys(n).forEach(i=>{r[i]=n[i]})}}return e}createSubContext(e=null,n,r){let i=n||this.element,s=new t(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Ns,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,n,r){let i={duration:n??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},s=new nc(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,n,r,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=e.replace(ZE,"."+this._enterClassName),e=e.replace(tw,"."+this._leaveClassName);let c=r!=1,l=this._driver.query(this.element,e,c);r!==0&&(l=r<0?l.slice(l.length+r,l.length):l.slice(0,r)),a.push(...l)}return!s&&a.length==0&&o.push(mE(n)),a}},ks=class t{constructor(e,n,r,i){this._driver=e,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let n=this._keyframes.size===1&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+e),n&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,n){return this.applyStylesToKeyframe(),new t(this._driver,e,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=JE,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,n){this._localTimelineStyles.set(e,n),this._globalTimelineStyles.set(e,n),this._styleSummary.set(e,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[n,r]of this._globalTimelineStyles)this._backFill.set(n,r||at),this._currentKeyframe.set(n,at);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,n,r,i){n&&this._previousKeyframe.set("easing",n);let s=i&&i.params||{},o=nw(e,this._globalTimelineStyles);for(let[a,c]of o){let l=Fr(c,s,r);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??at),this._updateStyle(a,l)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,n)=>{this._currentKeyframe.set(n,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,e)}))}snapshotCurrentStyles(){for(let[e,n]of this._localTimelineStyles)this._pendingStyles.set(e,n),this._updateStyle(e,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let n in this._currentKeyframe)e.push(n);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((n,r)=>{let i=this._styleSummary.get(r);(!i||n.time>i.time)&&this._updateStyle(r,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,n=new Set,r=this._keyframes.size===1&&this.duration===0,i=[];this._keyframes.forEach((a,c)=>{let l=new Map([...this._backFill,...a]);l.forEach((u,h)=>{u===Es?e.add(h):u===at&&n.add(h)}),r||l.set("offset",c/this.duration),i.push(l)});let s=[...e.values()],o=[...n.values()];if(r){let a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return gc(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}},nc=class extends ks{constructor(e,n,r,i,s,o,a=!1){super(e,n,o.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:n,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&n){let s=[],o=r+n,a=n/o,c=new Map(e[0]);c.set("offset",0),s.push(c);let l=new Map(e[0]);l.set("offset",Vf(a)),s.push(l);let u=e.length-1;for(let h=1;h<=u;h++){let d=new Map(e[h]),p=d.get("offset"),f=n+p*r;d.set("offset",Vf(f/o)),s.push(d)}r=o,n=0,i="",e=s}return gc(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}};function Vf(t,e=3){let n=Math.pow(10,e-1);return Math.round(t*n)/n}function nw(t,e){let n=new Map,r;return t.forEach(i=>{if(i==="*"){r??=e.keys();for(let s of r)n.set(s,at)}else for(let[s,o]of i)n.set(s,o)}),n}function Uf(t,e,n,r,i,s,o,a,c,l,u,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:h,errors:d}}var za={},Ds=class{constructor(e,n,r){this._triggerName=e,this.ast=n,this._stateStyles=r}match(e,n,r,i){return rw(this.ast.matchers,e,n,r,i)}buildStyles(e,n,r){let i=this._stateStyles.get("*");return e!==void 0&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(n,r):new Map}build(e,n,r,i,s,o,a,c,l,u){let h=[],d=this.ast.options&&this.ast.options.params||za,p=a&&a.params||za,f=this.buildStyles(r,p,h),g=c&&c.params||za,v=this.buildStyles(i,g,h),I=new Set,P=new Map,D=new Map,E=i==="void",M={params:tp(g,d),delay:this.ast.options?.delay},A=u?[]:ep(e,n,this.ast.animation,s,o,f,v,M,l,h),$=0;return A.forEach(B=>{$=Math.max(B.duration+B.delay,$)}),h.length?Uf(n,this._triggerName,r,i,E,f,v,[],[],P,D,$,h):(A.forEach(B=>{let Se=B.element,zt=Ve(P,Se,new Set);B.preStyleProps.forEach(gn=>zt.add(gn));let Md=Ve(D,Se,new Set);B.postStyleProps.forEach(gn=>Md.add(gn)),Se!==n&&I.add(Se)}),Uf(n,this._triggerName,r,i,E,f,v,A,[...I.values()],P,D,$))}};function rw(t,e,n,r,i){return t.some(s=>s(e,n,r,i))}function tp(t,e){let n=Q({},e);return Object.entries(t).forEach(([r,i])=>{i!=null&&(n[r]=i)}),n}var rc=class{constructor(e,n,r){this.styles=e,this.defaultParams=n,this.normalizer=r}buildStyles(e,n){let r=new Map,i=tp(e,this.defaultParams);return this.styles.styles.forEach(s=>{typeof s!="string"&&s.forEach((o,a)=>{o&&(o=Fr(o,i,n));let c=this.normalizer.normalizePropertyName(a,n);o=this.normalizer.normalizeStyleValue(a,c,o,n),r.set(a,o)})}),r}};function iw(t,e,n){return new ic(t,e,n)}var ic=class{constructor(e,n,r){this.name=e,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states=new Map,n.states.forEach(i=>{let s=i.options&&i.options.params||{};this.states.set(i.name,new rc(i.style,s,r))}),Bf(this.states,"true","1"),Bf(this.states,"false","0"),n.transitions.forEach(i=>{this.transitionFactories.push(new Ds(e,i,this.states))}),this.fallbackTransition=sw(e,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,n,r,i){return this.transitionFactories.find(o=>o.match(e,n,r,i))||null}matchStyles(e,n,r){return this.fallbackTransition.buildStyles(e,n,r)}};function sw(t,e,n){let r=[(o,a)=>!0],i={type:N.Sequence,steps:[],options:null},s={type:N.Transition,animation:i,matchers:r,options:null,queryCount:0,depCount:0};return new Ds(t,s,e)}function Bf(t,e,n){t.has(e)?t.has(n)||t.set(n,t.get(e)):t.has(n)&&t.set(e,t.get(n))}var ow=new Vr,sc=class{constructor(e,n,r){this.bodyNode=e,this._driver=n,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,n){let r=[],i=[],s=Zf(this._driver,n,r,i);if(r.length)throw EE(r);i.length&&void 0,this._animations.set(e,s)}_buildPlayer(e,n,r){let i=e.element,s=Gf(this._normalizer,e.keyframes,n,r);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,n,r={}){let i=[],s=this._animations.get(e),o,a=new Map;if(s?(o=ep(this._driver,n,s,Yf,Ha,new Map,new Map,r,ow,i),o.forEach(u=>{let h=Ve(a,u.element,new Map);u.postStyleProps.forEach(d=>h.set(d,null))})):(i.push(wE()),o=[]),i.length)throw TE(i);a.forEach((u,h)=>{u.forEach((d,p)=>{u.set(p,this._driver.computeStyle(h,p,at))})});let c=o.map(u=>{let h=a.get(u.element);return this._buildPlayer(u,new Map,h)}),l=Xt(c);return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){let n=this._getPlayer(e);n.destroy(),this._playersById.delete(e);let r=this.players.indexOf(n);r>=0&&this.players.splice(r,1)}_getPlayer(e){let n=this._playersById.get(e);if(!n)throw IE(e);return n}listen(e,n,r,i){let s=hc(n,"","","");return uc(this._getPlayer(e),r,s,i),()=>{}}command(e,n,r,i){if(r=="register"){this.register(e,i[0]);return}if(r=="create"){let o=i[0]||{};this.create(e,n,o);return}let s=this._getPlayer(e);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e);break}}},qf="ng-animate-queued",aw=".ng-animate-queued",Wa="ng-animate-disabled",cw=".ng-animate-disabled",lw="ng-star-inserted",uw=".ng-star-inserted",hw=[],np={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},dw={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ye="__ng_removed",Ur=class{get params(){return this.options.params}constructor(e,n=""){this.namespaceId=n;let r=e&&e.hasOwnProperty("value"),i=r?e.value:e;if(this.value=pw(i),r){let s=e,{value:o}=s,a=Ud(s,["value"]);this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let n=e.params;if(n){let r=this.options.params;Object.keys(n).forEach(i=>{r[i]==null&&(r[i]=n[i])})}}},Lr="void",Ga=new Ur(Lr),oc=class{constructor(e,n,r){this.id=e,this.hostElement=n,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,ze(n,this._hostClassName)}listen(e,n,r,i){if(!this._triggers.has(n))throw SE(r,n);if(r==null||r.length==0)throw AE(n);if(!mw(r))throw bE(r,n);let s=Ve(this._elementListeners,e,[]),o={name:n,phase:r,callback:i};s.push(o);let a=Ve(this._engine.statesByElement,e,new Map);return a.has(n)||(ze(e,ws),ze(e,ws+"-"+n),a.set(n,Ga)),()=>{this._engine.afterFlush(()=>{let c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(n)||a.delete(n)})}}register(e,n){return this._triggers.has(e)?!1:(this._triggers.set(e,n),!0)}_getTrigger(e){let n=this._triggers.get(e);if(!n)throw CE(e);return n}trigger(e,n,r,i=!0){let s=this._getTrigger(n),o=new Br(this.id,n,e),a=this._engine.statesByElement.get(e);a||(ze(e,ws),ze(e,ws+"-"+n),this._engine.statesByElement.set(e,a=new Map));let c=a.get(n),l=new Ur(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(n,l),c||(c=Ga),!(l.value===Lr)&&c.value===l.value){if(!yw(c.params,l.params)){let g=[],v=s.matchStyles(c.value,c.params,g),I=s.matchStyles(l.value,l.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(()=>{En(e,v),ct(e,I)})}return}let d=Ve(this._engine.playersByElement,e,[]);d.forEach(g=>{g.namespaceId==this.id&&g.triggerName==n&&g.queued&&g.destroy()});let p=s.matchTransition(c.value,l.value,e,l.params),f=!1;if(!p){if(!i)return;p=s.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:n,transition:p,fromState:c,toState:l,player:o,isFallbackTransition:f}),f||(ze(e,qf),o.onStart(()=>{Qn(e,qf)})),o.onDone(()=>{let g=this.players.indexOf(o);g>=0&&this.players.splice(g,1);let v=this._engine.playersByElement.get(e);if(v){let I=v.indexOf(o);I>=0&&v.splice(I,1)}}),this.players.push(o),d.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(n=>n.delete(e)),this._elementListeners.forEach((n,r)=>{this._elementListeners.set(r,n.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let n=this._engine.playersByElement.get(e);n&&(n.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,n){let r=this._engine.driver.query(e,bs,!0);r.forEach(i=>{if(i[Ye])return;let s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,n,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,n,r,i){let s=this._engine.statesByElement.get(e),o=new Map;if(s){let a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){let u=this.trigger(e,l,Lr,i);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,n,o),r&&Xt(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){let i=new Set;n.forEach(s=>{let o=s.name;if(i.has(o))return;i.add(o);let c=this._triggers.get(o).fallbackTransition,l=r.get(o)||Ga,u=new Ur(Lr),h=new Br(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(e,n){let r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,n),this.triggerLeaveAnimation(e,n,!0))return;let i=!1;if(r.totalAnimations){let s=r.players.length?r.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,n);else{let s=e[Ye];(!s||s===np)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,n))}}insertNode(e,n){ze(e,this._hostClassName)}drainQueuedTransitions(e){let n=[];return this._queue.forEach(r=>{let i=r.player;if(i.destroyed)return;let s=r.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==r.triggerName){let c=hc(s,r.triggerName,r.fromState.value,r.toState.value);c._data=e,uc(r.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):n.push(r)}),this._queue=[],n.sort((r,i)=>{let s=r.transition.ast.depCount,o=i.transition.ast.depCount;return s==0||o==0?s-o:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},ac=class{_onRemovalComplete(e,n){this.onRemovalComplete(e,n)}constructor(e,n,r,i){this.bodyNode=e,this.driver=n,this._normalizer=r,this.scheduler=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,o)=>{}}get queuedPlayers(){let e=[];return this._namespaceList.forEach(n=>{n.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,n){let r=new oc(e,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(r,n):(this.newHostElements.set(n,r),this.collectEnterElement(n)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,n){let r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,a=this.driver.getParentElement(n);for(;a;){let c=i.get(a);if(c){let l=r.indexOf(c);r.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||r.unshift(e)}else r.push(e);return i.set(n,e),e}register(e,n){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,n)),r}registerTrigger(e,n,r){let i=this._namespaceLookup[e];i&&i.register(n,r)&&this.totalAnimations++}destroy(e,n){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);let i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(n),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let n=new Set,r=this.statesByElement.get(e);if(r){for(let i of r.values())if(i.namespaceId){let s=this._fetchNamespace(i.namespaceId);s&&n.add(s)}}return n}trigger(e,n,r,i){if(Ss(n)){let s=this._fetchNamespace(e);if(s)return s.trigger(n,r,i),!0}return!1}insertNode(e,n,r,i){if(!Ss(n))return;let s=n[Ye];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;let o=this.collectedLeaveElements.indexOf(n);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){let o=this._fetchNamespace(e);o&&o.insertNode(n,r)}i&&this.collectEnterElement(n)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,n){n?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ze(e,Wa)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Qn(e,Wa))}removeNode(e,n,r){if(Ss(n)){this.scheduler?.notify();let i=e?this._fetchNamespace(e):null;i?i.removeNode(n,r):this.markElementAsRemoved(e,n,!1,r);let s=this.namespacesByHostElement.get(n);s&&s.id!==e&&s.removeNode(n,r)}else this._onRemovalComplete(n,r)}markElementAsRemoved(e,n,r,i,s){this.collectedLeaveElements.push(n),n[Ye]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,n,r,i,s){return Ss(n)?this._fetchNamespace(e).listen(n,r,i,s):()=>{}}_buildInstruction(e,n,r,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,n,s)}destroyInnerAnimations(e){let n=this.driver.query(e,bs,!0);n.forEach(r=>this.destroyActiveAnimationsForElement(r)),this.playersByQueriedElement.size!=0&&(n=this.driver.query(e,Qa,!0),n.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){let n=this.playersByElement.get(e);n&&n.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){let n=this.playersByQueriedElement.get(e);n&&n.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Xt(this.players).onDone(()=>e());e()})}processLeaveNode(e){let n=e[Ye];if(n&&n.setForRemoval){if(e[Ye]=np,n.namespaceId){this.destroyInnerAnimations(e);let r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}e.classList?.contains(Wa)&&this.markElementAsDisabled(e,!1),this.driver.query(e,cw,!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++){let i=this.collectedEnterElements[r];ze(i,lw)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let r=[];try{n=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++){let i=this.collectedLeaveElements[r];this.processLeaveNode(i)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){let r=this._whenQuietFns;this._whenQuietFns=[],n.length?Xt(n).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw RE(e)}_flushAnimations(e,n){let r=new Vr,i=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(w=>{u.add(w);let T=this.driver.query(w,aw,!0);for(let S=0;S<T.length;S++)u.add(T[S])});let h=this.bodyNode,d=Array.from(this.statesByElement.keys()),p=zf(d,this.collectedEnterElements),f=new Map,g=0;p.forEach((w,T)=>{let S=Yf+g++;f.set(T,S),w.forEach(F=>ze(F,S))});let v=[],I=new Set,P=new Set;for(let w=0;w<this.collectedLeaveElements.length;w++){let T=this.collectedLeaveElements[w],S=T[Ye];S&&S.setForRemoval&&(v.push(T),I.add(T),S.hasAnimation?this.driver.query(T,uw,!0).forEach(F=>I.add(F)):P.add(T))}let D=new Map,E=zf(d,Array.from(I));E.forEach((w,T)=>{let S=Ha+g++;D.set(T,S),w.forEach(F=>ze(F,S))}),e.push(()=>{p.forEach((w,T)=>{let S=f.get(T);w.forEach(F=>Qn(F,S))}),E.forEach((w,T)=>{let S=D.get(T);w.forEach(F=>Qn(F,S))}),v.forEach(w=>{this.processLeaveNode(w)})});let M=[],A=[];for(let w=this._namespaceList.length-1;w>=0;w--)this._namespaceList[w].drainQueuedTransitions(n).forEach(S=>{let F=S.player,ae=S.element;if(M.push(F),this.collectedEnterElements.length){let ye=ae[Ye];if(ye&&ye.setForMove){if(ye.previousTriggersValues&&ye.previousTriggersValues.has(S.triggerName)){let _n=ye.previousTriggersValues.get(S.triggerName),$e=this.statesByElement.get(S.element);if($e&&$e.has(S.triggerName)){let rs=$e.get(S.triggerName);rs.value=_n,$e.set(S.triggerName,rs)}}F.destroy();return}}let it=!h||!this.driver.containsElement(h,ae),xe=D.get(ae),Wt=f.get(ae),X=this._buildInstruction(S,r,Wt,xe,it);if(X.errors&&X.errors.length){A.push(X);return}if(it){F.onStart(()=>En(ae,X.fromStyles)),F.onDestroy(()=>ct(ae,X.toStyles)),i.push(F);return}if(S.isFallbackTransition){F.onStart(()=>En(ae,X.fromStyles)),F.onDestroy(()=>ct(ae,X.toStyles)),i.push(F);return}let Vd=[];X.timelines.forEach(ye=>{ye.stretchStartingKeyframe=!0,this.disabledNodes.has(ye.element)||Vd.push(ye)}),X.timelines=Vd,r.append(ae,X.timelines);let Xv={instruction:X,player:F,element:ae};o.push(Xv),X.queriedElements.forEach(ye=>Ve(a,ye,[]).push(F)),X.preStyleProps.forEach((ye,_n)=>{if(ye.size){let $e=c.get(_n);$e||c.set(_n,$e=new Set),ye.forEach((rs,Na)=>$e.add(Na))}}),X.postStyleProps.forEach((ye,_n)=>{let $e=l.get(_n);$e||l.set(_n,$e=new Set),ye.forEach((rs,Na)=>$e.add(Na))})});if(A.length){let w=[];A.forEach(T=>{w.push(PE(T.triggerName,T.errors))}),M.forEach(T=>T.destroy()),this.reportError(w)}let $=new Map,B=new Map;o.forEach(w=>{let T=w.element;r.has(T)&&(B.set(T,T),this._beforeAnimationBuild(w.player.namespaceId,w.instruction,$))}),i.forEach(w=>{let T=w.element;this._getPreviousPlayers(T,!1,w.namespaceId,w.triggerName,null).forEach(F=>{Ve($,T,[]).push(F),F.destroy()})});let Se=v.filter(w=>Wf(w,c,l)),zt=new Map;jf(zt,this.driver,P,l,at).forEach(w=>{Wf(w,c,l)&&Se.push(w)});let gn=new Map;p.forEach((w,T)=>{jf(gn,this.driver,new Set(w),c,Es)}),Se.forEach(w=>{let T=zt.get(w),S=gn.get(w);zt.set(w,new Map([...T?.entries()??[],...S?.entries()??[]]))});let Pa=[],Ld=[],Fd={};o.forEach(w=>{let{element:T,player:S,instruction:F}=w;if(r.has(T)){if(u.has(T)){S.onDestroy(()=>ct(T,F.toStyles)),S.disabled=!0,S.overrideTotalTime(F.totalTime),i.push(S);return}let ae=Fd;if(B.size>1){let xe=T,Wt=[];for(;xe=xe.parentNode;){let X=B.get(xe);if(X){ae=X;break}Wt.push(xe)}Wt.forEach(X=>B.set(X,ae))}let it=this._buildAnimation(S.namespaceId,F,$,s,gn,zt);if(S.setRealPlayer(it),ae===Fd)Pa.push(S);else{let xe=this.playersByElement.get(ae);xe&&xe.length&&(S.parentPlayer=Xt(xe)),i.push(S)}}else En(T,F.fromStyles),S.onDestroy(()=>ct(T,F.toStyles)),Ld.push(S),u.has(T)&&i.push(S)}),Ld.forEach(w=>{let T=s.get(w.element);if(T&&T.length){let S=Xt(T);w.setRealPlayer(S)}}),i.forEach(w=>{w.parentPlayer?w.syncPlayerEvents(w.parentPlayer):w.destroy()});for(let w=0;w<v.length;w++){let T=v[w],S=T[Ye];if(Qn(T,Ha),S&&S.hasAnimation)continue;let F=[];if(a.size){let it=a.get(T);it&&it.length&&F.push(...it);let xe=this.driver.query(T,Qa,!0);for(let Wt=0;Wt<xe.length;Wt++){let X=a.get(xe[Wt]);X&&X.length&&F.push(...X)}}let ae=F.filter(it=>!it.destroyed);ae.length?gw(this,T,ae):this.processLeaveNode(T)}return v.length=0,Pa.forEach(w=>{this.players.push(w),w.onDone(()=>{w.destroy();let T=this.players.indexOf(w);this.players.splice(T,1)}),w.play()}),Pa}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,n,r,i,s){let o=[];if(n){let a=this.playersByQueriedElement.get(e);a&&(o=a)}else{let a=this.playersByElement.get(e);if(a){let c=!s||s==Lr;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||o.push(l)})}}return(r||i)&&(o=o.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,n,r){let i=n.triggerName,s=n.element,o=n.isRemovalTransition?void 0:e,a=n.isRemovalTransition?void 0:i;for(let c of n.timelines){let l=c.element,u=l!==s,h=Ve(r,l,[]);this._getPreviousPlayers(l,u,o,a,n.toState).forEach(p=>{let f=p.getRealPlayer();f.beforeDestroy&&f.beforeDestroy(),p.destroy(),h.push(p)})}En(s,n.fromStyles)}_buildAnimation(e,n,r,i,s,o){let a=n.triggerName,c=n.element,l=[],u=new Set,h=new Set,d=n.timelines.map(f=>{let g=f.element;u.add(g);let v=g[Ye];if(v&&v.removedBeforeQueried)return new Jt(f.duration,f.delay);let I=g!==c,P=_w((r.get(g)||hw).map($=>$.getRealPlayer())).filter($=>{let B=$;return B.element?B.element===g:!1}),D=s.get(g),E=o.get(g),M=Gf(this._normalizer,f.keyframes,D,E),A=this._buildPlayer(f,M,P);if(f.subTimeline&&i&&h.add(g),I){let $=new Br(e,a,g);$.setRealPlayer(A),l.push($)}return A});l.forEach(f=>{Ve(this.playersByQueriedElement,f.element,[]).push(f),f.onDone(()=>fw(this.playersByQueriedElement,f.element,f))}),u.forEach(f=>ze(f,Mf));let p=Xt(d);return p.onDestroy(()=>{u.forEach(f=>Qn(f,Mf)),ct(c,n.toStyles)}),h.forEach(f=>{Ve(i,f,[]).push(p)}),p}_buildPlayer(e,n,r){return n.length>0?this.driver.animate(e.element,n,e.duration,e.delay,e.easing,r):new Jt(e.duration,e.delay)}},Br=class{constructor(e,n,r){this.namespaceId=e,this.triggerName=n,this.element=r,this._player=new Jt,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((n,r)=>{n.forEach(i=>uc(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let n=this._player;n.triggerCallback&&e.onStart(()=>n.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,n){Ve(this._queuedCallbacks,e,[]).push(n)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let n=this._player;n.triggerCallback&&n.triggerCallback(e)}};function fw(t,e,n){let r=t.get(e);if(r){if(r.length){let i=r.indexOf(n);r.splice(i,1)}r.length==0&&t.delete(e)}return r}function pw(t){return t??null}function Ss(t){return t&&t.nodeType===1}function mw(t){return t=="start"||t=="done"}function $f(t,e){let n=t.style.display;return t.style.display=e??"none",n}function jf(t,e,n,r,i){let s=[];n.forEach(c=>s.push($f(c)));let o=[];r.forEach((c,l)=>{let u=new Map;c.forEach(h=>{let d=e.computeStyle(l,h,i);u.set(h,d),(!d||d.length==0)&&(l[Ye]=dw,o.push(l))}),t.set(l,u)});let a=0;return n.forEach(c=>$f(c,s[a++])),o}function zf(t,e){let n=new Map;if(t.forEach(a=>n.set(a,[])),e.length==0)return n;let r=1,i=new Set(e),s=new Map;function o(a){if(!a)return r;let c=s.get(a);if(c)return c;let l=a.parentNode;return n.has(l)?c=l:i.has(l)?c=r:c=o(l),s.set(a,c),c}return e.forEach(a=>{let c=o(a);c!==r&&n.get(c).push(a)}),n}function ze(t,e){t.classList?.add(e)}function Qn(t,e){t.classList?.remove(e)}function gw(t,e,n){Xt(n).onDone(()=>t.processLeaveNode(e))}function _w(t){let e=[];return rp(t,e),e}function rp(t,e){for(let n=0;n<t.length;n++){let r=t[n];r instanceof xr?rp(r.players,e):e.push(r)}}function yw(t,e){let n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){let s=n[i];if(!e.hasOwnProperty(s)||t[s]!==e[s])return!1}return!0}function Wf(t,e,n){let r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(s=>i.add(s)):e.set(t,r),n.delete(t),!0}var Jn=class{constructor(e,n,r,i){this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,o)=>{},this._transitionEngine=new ac(e.body,n,r,i),this._timelineEngine=new sc(e.body,n,r),this._transitionEngine.onRemovalComplete=(s,o)=>this.onRemovalComplete(s,o)}registerTrigger(e,n,r,i,s){let o=e+"-"+i,a=this._triggerCache[o];if(!a){let c=[],l=[],u=Zf(this._driver,s,c,l);if(c.length)throw yE(i,c);l.length&&void 0,a=iw(i,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(n,i,a)}register(e,n){this._transitionEngine.register(e,n)}destroy(e,n){this._transitionEngine.destroy(e,n)}onInsert(e,n,r,i){this._transitionEngine.insertNode(e,n,r,i)}onRemove(e,n,r){this._transitionEngine.removeNode(e,n,r)}disableAnimations(e,n){this._transitionEngine.markElementAsDisabled(e,n)}process(e,n,r,i){if(r.charAt(0)=="@"){let[s,o]=Of(r),a=i;this._timelineEngine.command(s,n,o,a)}else this._transitionEngine.trigger(e,n,r,i)}listen(e,n,r,i,s){if(r.charAt(0)=="@"){let[o,a]=Of(r);return this._timelineEngine.listen(o,n,a,s)}return this._transitionEngine.listen(e,n,r,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function vw(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=Ka(e[0]),e.length>1&&(r=Ka(e[e.length-1]))):e instanceof Map&&(n=Ka(e)),n||r?new cc(t,n,r):null}var Yn=class Yn{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=Yn.initialStylesByElement.get(e);i||Yn.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&ct(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ct(this._element,this._initialStyles),this._endStyles&&(ct(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(Yn.initialStylesByElement.delete(this._element),this._startStyles&&(En(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(En(this._element,this._endStyles),this._endStyles=null),ct(this._element,this._initialStyles),this._state=3)}};Yn.initialStylesByElement=new WeakMap;var cc=Yn;function Ka(t){let e=null;return t.forEach((n,r)=>{Ew(r)&&(e=e||new Map,e.set(r,n))}),e}function Ew(t){return t==="display"||t==="position"}var Os=class{constructor(e,n,r,i){this.element=e,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let n=()=>this._onFinish();this.domPlayer.addEventListener("finish",n),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",n)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let n=[];return e.forEach(r=>{n.push(Object.fromEntries(r))}),n}_triggerWebAnimation(e,n,r){return e.animate(this._convertKeyframesToObject(n),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{i!=="offset"&&e.set(i,this._finished?r:mc(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){let n=e==="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},xs=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,n){return!1}containsElement(e,n){return Kf(e,n)}getParentElement(e){return dc(e)}query(e,n,r){return Hf(e,n,r)}computeStyle(e,n,r){return mc(e,n)}animate(e,n,r,i,s,o=[]){let a=i==0?"both":"forwards",c={duration:r,delay:i,fill:a};s&&(c.easing=s);let l=new Map,u=o.filter(p=>p instanceof Os);BE(r,i)&&u.forEach(p=>{p.currentSnapshot.forEach((f,g)=>l.set(g,f))});let h=FE(n).map(p=>new Map(p));h=qE(e,h,l);let d=vw(e,h);return new Os(e,h,c,d)}};var As="@",ip="@.disabled",Ms=class{constructor(e,n,r,i){this.namespaceId=e,this.delegate=n,this.engine=r,this._onDestroy=i,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,n){this.delegate.appendChild(e,n),this.engine.onInsert(this.namespaceId,n,e,!1)}insertBefore(e,n,r,i=!0){this.delegate.insertBefore(e,n,r),this.engine.onInsert(this.namespaceId,n,e,i)}removeChild(e,n,r){this.engine.onRemove(this.namespaceId,n,this.delegate)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,r,i){this.delegate.setAttribute(e,n,r,i)}removeAttribute(e,n,r){this.delegate.removeAttribute(e,n,r)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,r,i){this.delegate.setStyle(e,n,r,i)}removeStyle(e,n,r){this.delegate.removeStyle(e,n,r)}setProperty(e,n,r){n.charAt(0)==As&&n==ip?this.disableAnimations(e,!!r):this.delegate.setProperty(e,n,r)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,r){return this.delegate.listen(e,n,r)}disableAnimations(e,n){this.engine.disableAnimations(e,n)}},lc=class extends Ms{constructor(e,n,r,i,s){super(n,r,i,s),this.factory=e,this.namespaceId=n}setProperty(e,n,r){n.charAt(0)==As?n.charAt(1)=="."&&n==ip?(r=r===void 0?!0:!!r,this.disableAnimations(e,r)):this.engine.process(this.namespaceId,e,n.slice(1),r):this.delegate.setProperty(e,n,r)}listen(e,n,r){if(n.charAt(0)==As){let i=ww(e),s=n.slice(1),o="";return s.charAt(0)!=As&&([s,o]=Tw(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{let c=a._data||-1;this.factory.scheduleListenerCallback(c,r,a)})}return this.delegate.listen(e,n,r)}};function ww(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}function Tw(t){let e=t.indexOf("."),n=t.substring(0,e),r=t.slice(e+1);return[n,r]}var Ls=class{constructor(e,n,r){this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,n.onRemovalComplete=(i,s)=>{let o=s?.parentNode(i);o&&s.removeChild(o,i)}}createRenderer(e,n){let r="",i=this.delegate.createRenderer(e,n);if(!e||!n?.data?.animation){let l=this._rendererCache,u=l.get(i);if(!u){let h=()=>l.delete(i);u=new Ms(r,i,this.engine,h),l.set(i,u)}return u}let s=n.id,o=n.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);let a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(s,o,e,l.name,l)};return n.data.animation.forEach(a),new lc(this,o,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,r){if(e>=0&&e<this._microtaskId){this._zone.run(()=>n(r));return}let i=this._animationCallbacksBuffer;i.length==0&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(s=>{let[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),i.push([n,r])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var Sw=(()=>{let e=class e extends Jn{constructor(r,i,s){super(r,i,s,K(nf,{optional:!0}))}ngOnDestroy(){this.flush()}};e.\u0275fac=function(i){return new(i||e)(G(ff),G(wn),G(Tn))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})();function Aw(){return new Rs}function bw(t,e,n){return new Ls(t,e,n)}var sp=[{provide:Tn,useFactory:Aw},{provide:Jn,useClass:Sw},{provide:rf,useFactory:bw,deps:[pf,Jn,ve]}],Cw=[{provide:wn,useFactory:()=>new xs},{provide:La,useValue:"BrowserAnimations"},...sp],hN=[{provide:wn,useClass:fc},{provide:La,useValue:"NoopAnimations"},...sp];function op(){return sf("NgEagerAnimations"),[...Cw]}var vc={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var _=function(t,e){if(!t)throw In(e)},In=function(t){return new Error("Firebase Database ("+vc.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var cp=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Rw=function(t){let e=[],n=0,r=0;for(;n<t.length;){let i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Vs={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){let s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4,d=(a&15)<<2|l>>6,p=l&63;c||(p=64,o||(d=64)),r.push(n[u],n[h],n[d],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Rw(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){let s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;let l=i<t.length?n[t.charAt(i)]:64;++i;let h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new Ec;let d=s<<2|a>>4;if(r.push(d),l!==64){let p=a<<4&240|l>>2;if(r.push(p),h!==64){let f=l<<6&192|h;r.push(f)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Ec=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Tc=function(t){let e=cp(t);return Vs.encodeByteArray(e,!0)},qr=function(t){return Tc(t).replace(/\./g,"")},$r=function(t){try{return Vs.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function lp(t){return up(void 0,t)}function up(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!Pw(n)||(t[n]=up(t[n],e[n]));return t}function Pw(t){return t!=="__proto__"}function Nw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var kw=()=>Nw().__FIREBASE_DEFAULTS__,Dw=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ow=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&$r(t[1]);return e&&JSON.parse(e)},Ic=()=>{try{return kw()||Dw()||Ow()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Sc=t=>{var e,n;return(n=(e=Ic())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Zn=t=>{let e=Sc(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Ac=()=>{var t;return(t=Ic())===null||t===void 0?void 0:t.config},bc=t=>{var e;return(e=Ic())===null||e===void 0?void 0:e[`_${t}`]};var Zt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function er(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[qr(JSON.stringify(n)),qr(JSON.stringify(o)),""].join(".")}function le(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jr(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(le())}function hp(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Us(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dp(){let t=le();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function lt(){return vc.NODE_CLIENT===!0||vc.NODE_ADMIN===!0}function Cc(){try{return typeof indexedDB=="object"}catch{return!1}}function fp(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var xw="FirebaseError",be=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=xw,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pt.prototype.create)}},Pt=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?Mw(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new be(i,a,r)}};function Mw(t,e){return t.replace(Lw,(n,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Lw=/\{\$([^}]+)}/g;function Xn(t){return JSON.parse(t)}function re(t){return JSON.stringify(t)}var pp=function(t){let e={},n={},r={},i="";try{let s=t.split(".");e=Xn($r(s[0])||""),n=Xn($r(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}};var mp=function(t){let e=pp(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},gp=function(t){let e=pp(t).claims;return typeof e=="object"&&e.admin===!0};function ut(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Sn(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function zr(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wr(t,e,n){let r={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function An(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let i of n){if(!r.includes(i))return!1;let s=t[i],o=e[i];if(ap(s)&&ap(o)){if(!An(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!n.includes(i))return!1;return!0}function ap(t){return t!==null&&typeof t=="object"}function bn(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}var Fs=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){let d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),u=1518500249):(l=s^o^a,u=1859775393):h<60?(l=s&o|a&(s|o),u=2400959708):(l=s^o^a,u=3395469782);let d=(i<<5|i>>>27)+l+c+u+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let r=n-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function _p(t,e){let n=new wc(t,e);return n.subscribe.bind(n)}var wc=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Fw(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=yc),i.error===void 0&&(i.error=yc),i.complete===void 0&&(i.complete=yc);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Fw(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function yc(){}function Bs(t,e){return`${t} failed: ${e} argument `}var yp=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,_(r<t.length,"Surrogate pair missing trail surrogate.");let o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Gr=function(t){let e=0;for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};var fN=4*60*60*1e3;function pe(t){return t&&t._delegate?t._delegate:t}var Ee=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Cn="[DEFAULT]";var qs=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new Zt;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Uw(e))try{this.getOrInitializeService({instanceIdentifier:Cn})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Cn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return m(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Cn){return this.instances.has(e)}getOptions(e=Cn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;let i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Vw(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Cn){return this.component?this.component.multipleInstances?e:Cn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Vw(t){return t===Cn?void 0:t}function Uw(t){return t.instantiationMode==="EAGER"}var Kr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new qs(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var Bw=[],U=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(U||{}),qw={debug:U.DEBUG,verbose:U.VERBOSE,info:U.INFO,warn:U.WARN,error:U.ERROR,silent:U.SILENT},$w=U.INFO,jw={[U.DEBUG]:"log",[U.VERBOSE]:"log",[U.INFO]:"info",[U.WARN]:"warn",[U.ERROR]:"error"},zw=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),i=jw[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ht=class{constructor(e){this.name=e,this._logLevel=$w,this._logHandler=zw,this._userLogHandler=null,Bw.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in U))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,U.DEBUG,...e),this._logHandler(this,U.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,U.VERBOSE,...e),this._logHandler(this,U.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,U.INFO,...e),this._logHandler(this,U.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,U.WARN,...e),this._logHandler(this,U.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,U.ERROR,...e),this._logHandler(this,U.ERROR,...e)}};var Ww=(t,e)=>e.some(n=>t instanceof n),vp,Ep;function Gw(){return vp||(vp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Kw(){return Ep||(Ep=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var wp=new WeakMap,Pc=new WeakMap,Tp=new WeakMap,Rc=new WeakMap,kc=new WeakMap;function Hw(t){let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(dt(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&wp.set(n,t)}).catch(()=>{}),kc.set(e,t),e}function Qw(t){if(Pc.has(t))return;let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Pc.set(t,e)}var Nc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Pc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Tp.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return dt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ip(t){Nc=t(Nc)}function Yw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call($s(this),e,...n);return Tp.set(r,e.sort?e.sort():[e]),dt(r)}:Kw().includes(t)?function(...e){return t.apply($s(this),e),dt(wp.get(this))}:function(...e){return dt(t.apply($s(this),e))}}function Jw(t){return typeof t=="function"?Yw(t):(t instanceof IDBTransaction&&Qw(t),Ww(t,Gw())?new Proxy(t,Nc):t)}function dt(t){if(t instanceof IDBRequest)return Hw(t);if(Rc.has(t))return Rc.get(t);let e=Jw(t);return e!==t&&(Rc.set(t,e),kc.set(e,t)),e}var $s=t=>kc.get(t);function Ap(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(t,e),a=dt(o);return r&&o.addEventListener("upgradeneeded",c=>{r(dt(o.result),c.oldVersion,c.newVersion,dt(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var Xw=["get","getKey","getAll","getAllKeys","count"],Zw=["put","add","delete","clear"],Dc=new Map;function Sp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Dc.get(e))return Dc.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,i=Zw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Xw.includes(n)))return;let s=function(o,...a){return m(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[n](...a),i&&c.done]))[0]})};return Dc.set(e,s),s}Ip(t=>ce(Q({},t),{get:(e,n,r)=>Sp(e,n)||t.get(e,n,r),has:(e,n)=>!!Sp(e,n)||t.has(e,n)}));var xc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(eT(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function eT(t){let e=t.getComponent();return e?.type==="VERSION"}var Mc="@firebase/app",bp="0.10.2";var Rn=new ht("@firebase/app"),tT="@firebase/app-compat",nT="@firebase/analytics-compat",rT="@firebase/analytics",iT="@firebase/app-check-compat",sT="@firebase/app-check",oT="@firebase/auth",aT="@firebase/auth-compat",cT="@firebase/database",lT="@firebase/database-compat",uT="@firebase/functions",hT="@firebase/functions-compat",dT="@firebase/installations",fT="@firebase/installations-compat",pT="@firebase/messaging",mT="@firebase/messaging-compat",gT="@firebase/performance",_T="@firebase/performance-compat",yT="@firebase/remote-config",vT="@firebase/remote-config-compat",ET="@firebase/storage",wT="@firebase/storage-compat",TT="@firebase/firestore",IT="@firebase/firestore-compat",ST="firebase",AT="10.11.1";var Lc="[DEFAULT]",bT={[Mc]:"fire-core",[tT]:"fire-core-compat",[rT]:"fire-analytics",[nT]:"fire-analytics-compat",[sT]:"fire-app-check",[iT]:"fire-app-check-compat",[oT]:"fire-auth",[aT]:"fire-auth-compat",[cT]:"fire-rtdb",[lT]:"fire-rtdb-compat",[uT]:"fire-fn",[hT]:"fire-fn-compat",[dT]:"fire-iid",[fT]:"fire-iid-compat",[pT]:"fire-fcm",[mT]:"fire-fcm-compat",[gT]:"fire-perf",[_T]:"fire-perf-compat",[yT]:"fire-rc",[vT]:"fire-rc-compat",[ET]:"fire-gcs",[wT]:"fire-gcs-compat",[TT]:"fire-fst",[IT]:"fire-fst-compat","fire-js":"fire-js",[ST]:"fire-js-all"};var Hr=new Map,CT=new Map,Fc=new Map;function Cp(t,e){try{t.container.addComponent(e)}catch(n){Rn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function We(t){let e=t.name;if(Fc.has(e))return Rn.debug(`There were multiple attempts to register component ${e}.`),!1;Fc.set(e,t);for(let n of Hr.values())Cp(n,t);for(let n of CT.values())Cp(n,t);return!0}function Nt(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function kt(t){return t.settings!==void 0}var RT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},en=new Pt("app","Firebase",RT);var Vc=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ee("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw en.create("app-deleted",{appName:this._name})}};var Ge=AT;function qc(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Lc,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw en.create("bad-app-name",{appName:String(i)});if(n||(n=Ac()),!n)throw en.create("no-options");let s=Hr.get(i);if(s){if(An(n,s.options)&&An(r,s.config))return s;throw en.create("duplicate-app",{appName:i})}let o=new Kr(i);for(let c of Fc.values())o.addComponent(c);let a=new Vc(n,r,o);return Hr.set(i,a),a}function ft(t=Lc){let e=Hr.get(t);if(!e&&t===Lc&&Ac())return qc();if(!e)throw en.create("no-app",{appName:t});return e}function js(){return Array.from(Hr.values())}function j(t,e,n){var r;let i=(r=bT[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Rn.warn(a.join(" "));return}We(new Ee(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var PT="firebase-heartbeat-database",NT=1,Qr="firebase-heartbeat-store",Oc=null;function kp(){return Oc||(Oc=Ap(PT,NT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qr)}catch(n){console.warn(n)}}}}).catch(t=>{throw en.create("idb-open",{originalErrorMessage:t.message})})),Oc}function kT(t){return m(this,null,function*(){try{let n=(yield kp()).transaction(Qr),r=yield n.objectStore(Qr).get(Dp(t));return yield n.done,r}catch(e){if(e instanceof be)Rn.warn(e.message);else{let n=en.create("idb-get",{originalErrorMessage:e?.message});Rn.warn(n.message)}}})}function Rp(t,e){return m(this,null,function*(){try{let r=(yield kp()).transaction(Qr,"readwrite");yield r.objectStore(Qr).put(e,Dp(t)),yield r.done}catch(n){if(n instanceof be)Rn.warn(n.message);else{let r=en.create("idb-set",{originalErrorMessage:n?.message});Rn.warn(r.message)}}})}function Dp(t){return`${t.name}!${t.options.appId}`}var DT=1024,OT=30*24*60*60*1e3,Uc=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new Bc(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return m(this,null,function*(){var e,n;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Pp();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=OT}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return m(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=Pp(),{heartbeatsToSend:r,unsentEntries:i}=xT(this._heartbeatsCache.heartbeats),s=qr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function Pp(){return new Date().toISOString().substring(0,10)}function xT(t,e=DT){let n=[],r=t.slice();for(let i of t){let s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Np(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Np(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var Bc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return m(this,null,function*(){return Cc()?fp().then(()=>!0).catch(()=>!1):!1})}read(){return m(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield kT(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return m(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Rp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return m(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Rp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Np(t){return qr(JSON.stringify({version:2,heartbeats:t})).length}function MT(t){We(new Ee("platform-logger",e=>new xc(e),"PRIVATE")),We(new Ee("heartbeat",e=>new Uc(e),"PRIVATE")),j(Mc,bp,t),j(Mc,bp,"esm2017"),j("fire-js","")}MT("");var LT="firebase",FT="10.11.1";j(LT,FT,"app");var Je=new uf("ANGULARFIRE2_VERSION");function tn(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var Dt=(t,e)=>{let n=e?[e]:js(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},pt=class{constructor(){return Dt(VT)}},VT="app-check";function tr(){}var zs=class{zone;delegate;constructor(e,n=is){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},$c=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",tr,{},tr,tr)),n.pipe(Ma({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},mt=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new zs(Zone.current)),this.insideAngular=n.run(()=>new zs(Zone.current,$d)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(G(ve))};static \u0275prov=J({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ws(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function UT(t){return Ws().ngZone.runOutsideAngular(()=>t())}function Pn(t){return Ws().ngZone.run(()=>t())}function BT(t){return qT(Ws())(t)}function qT(t){return function(n){return n=n.lift(new $c(t.ngZone)),n.pipe(Da(t.outsideAngular),Dr(t.insideAngular))}}var $T=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Pn(()=>t.apply(void 0,r))},Pe=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=Pn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",tr,{},tr,tr))),r[s]=$T(r[s],n));let i=UT(()=>t.apply(this,r));if(!e)if(i instanceof Kt){let s=Ws();return i.pipe(Da(s.outsideAngular),Dr(s.insideAngular))}else return Pn(()=>i);return i instanceof Kt?i.pipe(BT):i instanceof Promise?Pn(()=>new Promise((s,o)=>i.then(a=>Pn(()=>s(a)),a=>Pn(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:Pn(()=>i)};var Ue=class{constructor(e){return e}},Xe=class{constructor(){return js()}};function jT(t){return t&&t.length===1?t[0]:new Ue(ft())}var jc=new Z("angularfire2._apps"),zT={provide:Ue,useFactory:jT,deps:[[new ee,jc]]},WT={provide:Xe,deps:[[new ee,jc]]};function GT(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Ue(r)}}var KT=(()=>{class t{constructor(n){j("angularfire",Je.full,"core"),j("angularfire",Je.full,"app"),j("angular",hf.full,n.toString())}static \u0275fac=function(r){return new(r||t)(G(tf))};static \u0275mod=Le({type:t});static \u0275inj=Me({providers:[zT,WT]})}return t})();function Op(t,...e){return{ngModule:KT,providers:[{provide:jc,useFactory:GT(t),multi:!0,deps:[ve,ot,mt,...e]}]}}var xp=Pe(qc,!0);var Mp={firebaseConfig:{apiKey:"AIzaSyBGVGYRAZFP5Q5pTrBmcqufoAUpIw27SlM",authDomain:"pil-addc9.firebaseapp.com",projectId:"pil-addc9",storageBucket:"pil-addc9.appspot.com",databaseURL:"https://pil-addc9-default-rtdb.europe-west1.firebasedatabase.app",messagingSenderId:"801219582636",appId:"1:801219582636:web:145dbe3d8a4b8da461dd09",measurementId:"G-XEW4C6GCCK"}};function Yp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Jp=Yp,Xp=new Pt("auth","Firebase",Yp());var Js=new ht("@firebase/auth");function HT(t,...e){Js.logLevel<=U.WARN&&Js.warn(`Auth (${Ge}): ${t}`,...e)}function Ks(t,...e){Js.logLevel<=U.ERROR&&Js.error(`Auth (${Ge}): ${t}`,...e)}function rn(t,...e){throw ll(t,...e)}function kn(t,...e){return ll(t,...e)}function Zp(t,e,n){let r=Object.assign(Object.assign({},Jp()),{[e]:n});return new Pt("auth","Firebase",r).create(e,{appName:t.name})}function Nn(t){return Zp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ll(t,...e){if(typeof t!="string"){let n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Xp.create(t,...e)}function b(t,e,...n){if(!t)throw ll(e,...n)}function Ot(t){let e="INTERNAL ASSERTION FAILED: "+t;throw Ks(e),new Error(e)}function sn(t,e){t||Ot(e)}function Kc(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function QT(){return Lp()==="http:"||Lp()==="https:"}function Lp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function YT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(QT()||hp()||"connection"in navigator)?navigator.onLine:!0}function JT(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var Dn=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,sn(n>e,"Short delay should be less than long delay!"),this.isMobile=jr()||Us()}get(){return YT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function ul(t,e){sn(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var Xs=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ot("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ot("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ot("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var XT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var ZT=new Dn(3e4,6e4);function hl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function rr(s,o,a,c){return m(this,arguments,function*(t,e,n,r,i={}){return em(t,i,()=>m(this,null,function*(){let l={},u={};r&&(e==="GET"?u=r:l={body:JSON.stringify(r)});let h=bn(Object.assign({key:t.config.apiKey},u)).slice(1),d=yield t._getAdditionalHeaders();return d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode),Xs.fetch()(tm(t,t.config.apiHost,n,h),Object.assign({method:e,headers:d,referrerPolicy:"no-referrer"},l))}))})}function em(t,e,n){return m(this,null,function*(){t._canInitEmulator=!1;let r=Object.assign(Object.assign({},XT),e);try{let i=new Hc(t),s=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Gs(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gs(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Gs(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Gs(t,"user-disabled",o);let u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Zp(t,u,l);rn(t,u)}}catch(i){if(i instanceof be)throw i;rn(t,"network-request-failed",{message:String(i)})}})}function eI(s,o,a,c){return m(this,arguments,function*(t,e,n,r,i={}){let l=yield rr(t,e,n,r,i);return"mfaPendingCredential"in l&&rn(t,"multi-factor-auth-required",{_serverResponse:l}),l})}function tm(t,e,n,r){let i=`${e}${n}?${r}`;return t.config.emulator?ul(t.config,i):`${t.config.apiScheme}://${i}`}var Hc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(kn(this.auth,"network-request-failed")),ZT.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Gs(t,e,n){let r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=kn(t,e,r);return i.customData._tokenResponse=n,i}function tI(t,e){return m(this,null,function*(){return rr(t,"POST","/v1/accounts:delete",e)})}function nm(t,e){return m(this,null,function*(){return rr(t,"POST","/v1/accounts:lookup",e)})}function Yr(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function dl(t,e=!1){return m(this,null,function*(){let n=pe(t),r=yield n.getIdToken(e),i=fl(r);b(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Yr(zc(i.auth_time)),issuedAtTime:Yr(zc(i.iat)),expirationTime:Yr(zc(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function zc(t){return Number(t)*1e3}function fl(t){let[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ks("JWT malformed, contained fewer than 3 sections"),null;try{let i=$r(n);return i?JSON.parse(i):(Ks("Failed to decode base64 JWT payload"),null)}catch(i){return Ks("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Fp(t){let e=fl(t);return b(e,"internal-error"),b(typeof e.exp<"u","internal-error"),b(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Xr(t,e,n=!1){return m(this,null,function*(){if(n)return e;try{return yield e}catch(r){throw r instanceof be&&nI(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})}function nI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var Qc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>m(this,null,function*(){yield this.iteration()}),n)}iteration(){return m(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Zr=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yr(this.lastLoginAt),this.creationTime=Yr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Zs(t){return m(this,null,function*(){var e;let n=t.auth,r=yield t.getIdToken(),i=yield Xr(t,nm(n,{idToken:r}));b(i?.users.length,n,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?rm(s.providerUserInfo):[],a=rI(t.providerData,o),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!a?.length,u=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Zr(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,h)})}function pl(t){return m(this,null,function*(){let e=pe(t);yield Zs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function rI(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function rm(t){return t.map(e=>{var{providerId:n}=e,r=ka(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function iI(t,e){return m(this,null,function*(){let n=yield em(t,{},()=>m(this,null,function*(){let r=bn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=tm(t,i,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Xs.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function sI(t,e){return m(this,null,function*(){return rr(t,"POST","/v2/accounts:revokeToken",hl(t,e))})}var Jr=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){b(e.idToken,"internal-error"),b(typeof e.idToken<"u","internal-error"),b(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Fp(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){b(e.length!==0,"internal-error");let n=Fp(e);this.updateTokensAndExpiration(e,null,n)}getToken(e,n=!1){return m(this,null,function*(){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(b(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return m(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield iI(e,n);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){let{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new t;return r&&(b(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(b(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(b(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return Ot("not implemented")}};function nn(t,e){b(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var nr=class t{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=ka(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Qc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zr(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return m(this,null,function*(){let n=yield Xr(this,this.stsTokenManager.getToken(this.auth,e));return b(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return dl(this,e)}reload(){return pl(this)}_assign(e){this!==e&&(b(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){b(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return m(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&(yield Zs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return m(this,null,function*(){if(kt(this.auth.app))return Promise.reject(Nn(this.auth));let e=yield this.getIdToken();return yield Xr(this,tI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,c,l,u;let h=(r=n.displayName)!==null&&r!==void 0?r:void 0,d=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,f=(o=n.photoURL)!==null&&o!==void 0?o:void 0,g=(a=n.tenantId)!==null&&a!==void 0?a:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,I=(l=n.createdAt)!==null&&l!==void 0?l:void 0,P=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:D,emailVerified:E,isAnonymous:M,providerData:A,stsTokenManager:$}=n;b(D&&$,e,"internal-error");let B=Jr.fromJSON(this.name,$);b(typeof D=="string",e,"internal-error"),nn(h,e.name),nn(d,e.name),b(typeof E=="boolean",e,"internal-error"),b(typeof M=="boolean",e,"internal-error"),nn(p,e.name),nn(f,e.name),nn(g,e.name),nn(v,e.name),nn(I,e.name),nn(P,e.name);let Se=new t({uid:D,auth:e,email:d,emailVerified:E,displayName:h,isAnonymous:M,photoURL:f,phoneNumber:p,tenantId:g,stsTokenManager:B,createdAt:I,lastLoginAt:P});return A&&Array.isArray(A)&&(Se.providerData=A.map(zt=>Object.assign({},zt))),v&&(Se._redirectEventId=v),Se}static _fromIdTokenResponse(e,n,r=!1){return m(this,null,function*(){let i=new Jr;i.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Zs(s),s})}static _fromGetAccountInfoResponse(e,n,r){return m(this,null,function*(){let i=n.users[0];b(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?rm(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Jr;a.updateFromIdToken(r);let c=new t({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Zr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var Vp=new Map;function xt(t){sn(t instanceof Function,"Expected a class definition");let e=Vp.get(t);return e?(sn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Vp.set(t,e),e)}var oI=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return m(this,null,function*(){return!0})}_set(n,r){return m(this,null,function*(){this.storage[n]=r})}_get(n){return m(this,null,function*(){let r=this.storage[n];return r===void 0?null:r})}_remove(n){return m(this,null,function*(){delete this.storage[n]})}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})(),Yc=oI;function Hs(t,e,n){return`firebase:${t}:${e}:${n}`}var eo=class t{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Hs(this.userKey,i.apiKey,s),this.fullPersistenceKey=Hs("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return m(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?nr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return m(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return m(this,null,function*(){if(!n.length)return new t(xt(Yc),e,r);let i=(yield Promise.all(n.map(l=>m(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||xt(Yc),o=Hs(r,e.config.apiKey,e.name),a=null;for(let l of n)try{let u=yield l._get(o);if(u){let h=nr._fromJSON(e,u);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(l=>m(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new t(s,e,r))})}};function Up(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(om(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(im(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cm(e))return"Blackberry";if(lm(e))return"Webos";if(ml(e))return"Safari";if((e.includes("chrome/")||sm(e))&&!e.includes("edge/"))return"Chrome";if(am(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function im(t=le()){return/firefox\//i.test(t)}function ml(t=le()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sm(t=le()){return/crios\//i.test(t)}function om(t=le()){return/iemobile/i.test(t)}function am(t=le()){return/android/i.test(t)}function cm(t=le()){return/blackberry/i.test(t)}function lm(t=le()){return/webos/i.test(t)}function co(t=le()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aI(t=le()){var e;return co(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function cI(){return dp()&&document.documentMode===10}function um(t=le()){return co(t)||am(t)||lm(t)||cm(t)||/windows phone/i.test(t)||om(t)}function lI(){try{return!!(window&&window!==window.top)}catch{return!1}}function hm(t,e=[]){let n;switch(t){case"Browser":n=Up(le());break;case"Worker":n=`${Up(le())}-${t}`;break;default:n=t}let r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ge}/${r}`}var Jc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return m(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let r of this.queue)yield r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(let i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function uI(n){return m(this,arguments,function*(t,e={}){return rr(t,"GET","/v2/passwordPolicy",hl(t,e))})}var hI=6,Xc=class{constructor(e){var n,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:hI,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Zc=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new to(this),this.idTokenSubscription=new to(this),this.beforeStateQueue=new Jc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=xt(n)),this._initializationPromise=this.queue(()=>m(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield eo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return m(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return m(this,null,function*(){try{let n=yield nm(this,{idToken:e}),r=yield nr._fromGetAccountInfoResponse(this,n,e);yield this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return m(this,null,function*(){var n;if(kt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return b(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return m(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return m(this,null,function*(){try{yield Zs(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=JT()}_delete(){return m(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return m(this,null,function*(){if(kt(this.app))return Promise.reject(Nn(this));let n=e?pe(e):null;return n&&b(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return m(this,null,function*(){if(!this._deleted)return e&&b(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>m(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return m(this,null,function*(){return kt(this.app)?Promise.reject(Nn(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return kt(this.app)?Promise.reject(Nn(this)):this.queue(()=>m(this,null,function*(){yield this.assertedPersistence.setPersistence(xt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return m(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return m(this,null,function*(){let e=yield uI(this),n=new Xc(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pt("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){return m(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),yield sI(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return m(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return m(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&xt(e)||this._popupRedirectResolver;b(n,this,"argument-error"),this.redirectPersistenceManager=yield eo.create(this,[xt(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return m(this,null,function*(){var n,r;return this._isInitialized&&(yield this.queue(()=>m(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return m(this,null,function*(){if(e===this.currentUser)return this.queue(()=>m(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(b(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(n);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return m(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return b(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return m(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(n["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n})}_getAppCheckToken(){return m(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&HT(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function gl(t){return pe(t)}var to=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=_p(n=>this.observer=n)}get next(){return b(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var _l={loadJS(){return m(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dI(t){_l=t}function fI(t){return _l.loadJS(t)}function pI(){return _l.gapiScript}function dm(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function yl(t,e){let n=Nt(t,"auth");if(n.isInitialized()){let i=n.getImmediate(),s=n.getOptions();if(An(s,e??{}))return i;rn(i,"already-initialized")}return n.initialize({options:e})}function mI(t,e){let n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(xt);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function vl(t,e,n){let r=gl(t);b(r._canInitEmulator,r,"emulator-config-failed"),b(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!n?.disableWarnings,s=fm(e),{host:o,port:a}=gI(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||_I()}function fm(t){let e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function gI(t){let e=fm(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};let r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Bp(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Bp(o)}}}function Bp(t){if(!t)return null;let e=Number(t);return isNaN(e)?null:e}function _I(){function t(){let e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}var no=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ot("not implemented")}_getIdTokenResponse(e){return Ot("not implemented")}_linkToIdToken(e,n){return Ot("not implemented")}_getReauthenticationResolver(e){return Ot("not implemented")}};function Wc(t,e){return m(this,null,function*(){return eI(t,"POST","/v1/accounts:signInWithIdp",hl(t,e))})}var ro=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var el=class extends ro{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var ei=class t{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,n,r,i=!1){return m(this,null,function*(){let s=yield nr._fromIdTokenResponse(e,r,i),o=qp(r);return new t({user:s,providerId:o,_tokenResponse:r,operationType:n})})}static _forOperation(e,n,r){return m(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=qp(r);return new t({user:e,providerId:i,_tokenResponse:r,operationType:n})})}};function qp(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}var tl=class t extends be{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,t.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new t(e,n,r,i)}};function pm(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?tl._fromErrorAndOperation(t,s,e,r):s})}function yI(t,e,n=!1){return m(this,null,function*(){let r=yield Xr(t,e._linkToIdToken(t.auth,yield t.getIdToken()),n);return ei._forOperation(t,"link",r)})}function vI(t,e,n=!1){return m(this,null,function*(){let{auth:r}=t;if(kt(r.app))return Promise.reject(Nn(r));let i="reauthenticate";try{let s=yield Xr(t,pm(r,i,e,t),n);b(s.idToken,r,"internal-error");let o=fl(s.idToken);b(o,r,"internal-error");let{sub:a}=o;return b(t.uid===a,r,"user-mismatch"),ei._forOperation(t,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&rn(r,"user-mismatch"),s}})}function EI(t,e,n=!1){return m(this,null,function*(){if(kt(t.app))return Promise.reject(Nn(t));let r="signIn",i=yield pm(t,r,e),s=yield ei._fromIdTokenResponse(t,r,i);return n||(yield t._updateCurrentUser(s.user)),s})}function El(t,e,n,r){return pe(t).onIdTokenChanged(e,n,r)}function wl(t,e,n){return pe(t).beforeAuthStateChanged(e,n)}var io="__sak";var so=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(io,"1"),this.storage.removeItem(io),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){let n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function wI(){let t=le();return ml(t)||co(t)}var TI=1e3,II=10,SI=(()=>{class t extends so{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,r)=>this.onStorageEvent(n,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=wI()&&lI(),this.fallbackToPolling=um(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&n(r,s,i)}}onStorageEvent(n,r=!1){if(!n.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=n.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(n.newValue!==a)n.newValue!==null?this.storage.setItem(i,n.newValue):this.storage.removeItem(i);else if(this.localCache[i]===n.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);cI()&&o!==n.newValue&&n.newValue!==n.oldValue?setTimeout(s,II):s()}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:r,newValue:i}),!0)})},TI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(n,r){return m(this,null,function*(){yield Gt(t.prototype,this,"_set").call(this,n,r),this.localCache[n]=JSON.stringify(r)})}_get(n){return m(this,null,function*(){let r=yield Gt(t.prototype,this,"_get").call(this,n);return this.localCache[n]=JSON.stringify(r),r})}_remove(n){return m(this,null,function*(){yield Gt(t.prototype,this,"_remove").call(this,n),delete this.localCache[n]})}}return t.type="LOCAL",t})(),mm=SI;var AI=(()=>{class t extends so{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,r){}_removeListener(n,r){}}return t.type="SESSION",t})(),Tl=AI;function bI(t){return Promise.all(t.map(e=>m(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(n){return{fulfilled:!1,reason:n}}})))}var CI=(()=>{class t{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){let r=this.receivers.find(s=>s.isListeningto(n));if(r)return r;let i=new t(n);return this.receivers.push(i),i}isListeningto(n){return this.eventTarget===n}handleEvent(n){return m(this,null,function*(){let r=n,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(u=>m(this,null,function*(){return u(r.origin,o)})),l=yield bI(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(n,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(r)}_unsubscribe(n,r){this.handlersMap[n]&&r&&this.handlersMap[n].delete(r),(!r||this.handlersMap[n].size===0)&&delete this.handlersMap[n],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}t.receivers=[];return t})();function gm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}var nl=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,n,r=50){return m(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=gm("",20);i.port1.start();let u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function gt(){return window}function RI(t){gt().location.href=t}function _m(){return typeof gt().WorkerGlobalScope<"u"&&typeof gt().importScripts=="function"}function PI(){return m(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function NI(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function kI(){return _m()?self:null}var ym="firebaseLocalStorageDb",DI=1,oo="firebaseLocalStorage",vm="fbase_key",On=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function lo(t,e){return t.transaction([oo],e?"readwrite":"readonly").objectStore(oo)}function OI(){let t=indexedDB.deleteDatabase(ym);return new On(t).toPromise()}function rl(){let t=indexedDB.open(ym,DI);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{let r=t.result;try{r.createObjectStore(oo,{keyPath:vm})}catch(i){n(i)}}),t.addEventListener("success",()=>m(this,null,function*(){let r=t.result;r.objectStoreNames.contains(oo)?e(r):(r.close(),yield OI(),e(yield rl()))}))})}function $p(t,e,n){return m(this,null,function*(){let r=lo(t,!0).put({[vm]:e,value:n});return new On(r).toPromise()})}function xI(t,e){return m(this,null,function*(){let n=lo(t,!1).get(e),r=yield new On(n).toPromise();return r===void 0?null:r.value})}function jp(t,e){let n=lo(t,!0).delete(e);return new On(n).toPromise()}var MI=800,LI=3,FI=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return m(this,null,function*(){return this.db?this.db:(this.db=yield rl(),this.db)})}_withRetries(n){return m(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield n(i)}catch(i){if(r++>LI)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return m(this,null,function*(){return _m()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return m(this,null,function*(){this.receiver=CI._getInstance(kI()),this.receiver._subscribe("keyChanged",(n,r)=>m(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(n,r)=>m(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return m(this,null,function*(){var n,r;if(this.activeServiceWorker=yield PI(),!this.activeServiceWorker)return;this.sender=new nl(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((n=i[0])===null||n===void 0)&&n.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(n){return m(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||NI()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:n},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return m(this,null,function*(){try{if(!indexedDB)return!1;let n=yield rl();return yield $p(n,io,"1"),yield jp(n,io),!0}catch{}return!1})}_withPendingWrite(n){return m(this,null,function*(){this.pendingWrites++;try{yield n()}finally{this.pendingWrites--}})}_set(n,r){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(i=>$p(i,n,r)),this.localCache[n]=r,this.notifyServiceWorker(n)}))})}_get(n){return m(this,null,function*(){let r=yield this._withRetries(i=>xI(i,n));return this.localCache[n]=r,r})}_remove(n){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(r=>jp(r,n)),delete this.localCache[n],this.notifyServiceWorker(n)}))})}_poll(){return m(this,null,function*(){let n=yield this._withRetries(s=>{let o=lo(s,!1).getAll();return new On(o).toPromise()});if(!n)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(n.length!==0)for(let{fbase_key:s,value:o}of n)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>m(this,null,function*(){return this._poll()}),MI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return t.type="LOCAL",t})(),Em=FI;var ak=dm("rcb"),ck=new Dn(3e4,6e4);function VI(t,e){return e?xt(e):(b(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var ti=class extends no{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Wc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Wc(e,this._buildIdpRequest())}_buildIdpRequest(e){let n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function UI(t){return EI(t.auth,new ti(t),t.bypassAuthState)}function BI(t){let{auth:e,user:n}=t;return b(n,e,"internal-error"),vI(n,new ti(t),t.bypassAuthState)}function qI(t){return m(this,null,function*(){let{auth:e,user:n}=t;return b(n,e,"internal-error"),yI(n,new ti(t),t.bypassAuthState)})}var il=class{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise((e,n)=>m(this,null,function*(){this.pendingPromise={resolve:e,reject:n};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return m(this,null,function*(){let{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UI;case"linkViaPopup":case"linkViaRedirect":return qI;case"reauthViaPopup":case"reauthViaRedirect":return BI;default:rn(this.auth,"internal-error")}}resolve(e){sn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){sn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var lk=new Dn(2e3,1e4);var $I="pendingRedirect",Qs=new Map,sl=class t extends il{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}execute(){return m(this,null,function*(){let e=Qs.get(this.auth._key());if(!e){try{let r=(yield jI(this.resolver,this.auth))?yield Gt(t.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Qs.set(this.auth._key(),e)}return this.bypassAuthState||Qs.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return m(this,null,function*(){if(e.type==="signInViaRedirect")return Gt(t.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let n=yield this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,Gt(t.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return m(this,null,function*(){})}cleanUp(){}};function jI(t,e){return m(this,null,function*(){let n=GI(e),r=WI(t);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(n))==="true";return yield r._remove(n),i})}function zI(t,e){Qs.set(t._key(),e)}function WI(t){return xt(t._redirectPersistence)}function GI(t){return Hs($I,t.config.apiKey,t.name)}function KI(t,e,n=!1){return m(this,null,function*(){if(kt(t.app))return Promise.reject(Nn(t));let r=gl(t),i=VI(r,e),o=yield new sl(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var HI=10*60*1e3,ol=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!QI(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!wm(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(kn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){let r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=HI&&this.cachedEventUids.clear(),this.cachedEventUids.has(zp(e))}saveEventToCache(e){this.cachedEventUids.add(zp(e)),this.lastProcessedEventTime=Date.now()}};function zp(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function wm({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function QI(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wm(t);default:return!1}}function YI(n){return m(this,arguments,function*(t,e={}){return rr(t,"GET","/v1/projects",e)})}var JI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XI=/^https?/;function ZI(t){return m(this,null,function*(){if(t.config.emulator)return;let{authorizedDomains:e}=yield YI(t);for(let n of e)try{if(eS(n))return}catch{}rn(t,"unauthorized-domain")})}function eS(t){let e=Kc(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){let o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!XI.test(n))return!1;if(JI.test(t))return r===t;let i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var tS=new Dn(3e4,6e4);function Wp(){let t=gt().___jsl;if(t?.H){for(let e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function nS(t){return new Promise((e,n)=>{var r,i,s;function o(){Wp(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Wp(),n(kn(t,"network-request-failed"))},timeout:tS.get()})}if(!((i=(r=gt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=gt().gapi)===null||s===void 0)&&s.load)o();else{let a=dm("iframefcb");return gt()[a]=()=>{gapi.load?o():n(kn(t,"network-request-failed"))},fI(`${pI()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Ys=null,e})}var Ys=null;function rS(t){return Ys=Ys||nS(t),Ys}var iS=new Dn(5e3,15e3),sS="__/auth/iframe",oS="emulator/auth/iframe",aS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lS(t){let e=t.config;b(e.authDomain,t,"auth-domain-config-required");let n=e.emulator?ul(e,oS):`https://${t.config.authDomain}/${sS}`,r={apiKey:e.apiKey,appName:t.name,v:Ge},i=cS.get(t.config.apiHost);i&&(r.eid=i);let s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${bn(r).slice(1)}`}function uS(t){return m(this,null,function*(){let e=yield rS(t),n=gt().gapi;return b(n,t,"internal-error"),e.open({where:document.body,url:lS(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aS,dontclear:!0},r=>new Promise((i,s)=>m(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=kn(t,"network-request-failed"),a=gt().setTimeout(()=>{s(o)},iS.get());function c(){gt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var hS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dS=500,fS=600,pS="_blank",mS="http://localhost",ao=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function gS(t,e,n,r=dS,i=fS){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},hS),{width:r.toString(),height:i.toString(),top:s,left:o}),l=le().toLowerCase();n&&(a=sm(l)?pS:n),im(l)&&(e=e||mS,c.scrollbars="yes");let u=Object.entries(c).reduce((d,[p,f])=>`${d}${p}=${f},`,"");if(aI(l)&&a!=="_self")return _S(e||"",a),new ao(null);let h=window.open(e||"",a,u);b(h,t,"popup-blocked");try{h.focus()}catch{}return new ao(h)}function _S(t,e){let n=document.createElement("a");n.href=t,n.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var yS="__/auth/handler",vS="emulator/auth/handler",ES=encodeURIComponent("fac");function Gp(t,e,n,r,i,s){return m(this,null,function*(){b(t.config.authDomain,t,"auth-domain-config-required"),b(t.config.apiKey,t,"invalid-api-key");let o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ge,eventId:i};if(e instanceof ro){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",zr(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[u,h]of Object.entries(s||{}))o[u]=h}if(e instanceof el){let u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);let a=o;for(let u of Object.keys(a))a[u]===void 0&&delete a[u];let c=yield t._getAppCheckToken(),l=c?`#${ES}=${encodeURIComponent(c)}`:"";return`${wS(t)}?${bn(a).slice(1)}${l}`})}function wS({config:t}){return t.emulator?ul(t,vS):`https://${t.authDomain}/${yS}`}var Gc="webStorageSupport",al=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tl,this._completeRedirectFn=KI,this._overrideRedirectResult=zI}_openPopup(e,n,r,i){return m(this,null,function*(){var s;sn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield Gp(e,n,r,Kc(),i);return gS(e,o,gm())})}_openRedirect(e,n,r,i){return m(this,null,function*(){yield this._originValidation(e);let s=yield Gp(e,n,r,Kc(),i);return RI(s),new Promise(()=>{})})}_initialize(e){let n=e._key();if(this.eventManagers[n]){let{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(sn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}initAndGetManager(e){return m(this,null,function*(){let n=yield uS(e),r=new ol(e);return n.register("authEvent",i=>(b(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r})}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Gc,{type:Gc},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[Gc];o!==void 0&&n(!!o),rn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=ZI(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return um()||ml()||co()}},Tm=al;var Kp="@firebase/auth",Hp="1.7.2";var cl=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return m(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){b(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function TS(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function IS(t){We(new Ee("auth",(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;b(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hm(t)},l=new Zc(r,i,s,c);return mI(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),We(new Ee("auth-internal",e=>{let n=gl(e.getProvider("auth").getImmediate());return(r=>new cl(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),j(Kp,Hp,TS(t)),j(Kp,Hp,"esm2017")}var SS=5*60,AS=bc("authIdTokenMaxAge")||SS,Qp=null,bS=t=>e=>m(void 0,null,function*(){let n=e&&(yield e.getIdTokenResult()),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>AS)return;let i=n?.token;Qp!==i&&(Qp=i,yield fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Il(t=ft()){let e=Nt(t,"auth");if(e.isInitialized())return e.getImmediate();let n=yl(t,{popupRedirectResolver:Tm,persistence:[Em,mm,Tl]}),r=bc("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=bS(s.toString());wl(n,o,()=>o(n.currentUser)),El(n,a=>o(a))}}let i=Sc("auth");return i&&vl(n,`http://${i}`),n}function CS(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}dI({loadJS(t){return new Promise((e,n)=>{let r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{let s=kn("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",CS().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});IS("Browser");var Im="auth",ni=class{constructor(e){return e}},Mt=class{constructor(){return Dt(Im)}};var Sl=new Z("angularfire2.auth-instances");function wA(t,e){let n=tn(Im,t,e);return n&&new ni(n)}function TA(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new ni(r)}}var IA={provide:Mt,deps:[[new ee,Sl]]},SA={provide:ni,useFactory:wA,deps:[[new ee,Sl],Ue]},AA=(()=>{class t{constructor(){j("angularfire",Je.full,"auth")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Le({type:t});static \u0275inj=Me({providers:[SA,IA]})}return t})();function Sm(t,...e){return{ngModule:AA,providers:[{provide:Sl,useFactory:TA(t),multi:!0,deps:[ve,ot,mt,Xe,[new ee,pt],...e]}]}}var Am=Pe(Il,!0);var bA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},et={},y,Gl=Gl||{},C=bA||self;function So(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function gi(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function CA(t){return Object.prototype.hasOwnProperty.call(t,Al)&&t[Al]||(t[Al]=++RA)}var Al="closure_uid_"+(1e9*Math.random()>>>0),RA=0;function PA(t,e,n){return t.call.apply(t.bind,arguments)}function NA(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function we(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?we=PA:we=NA,we.apply(null,arguments)}function uo(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function he(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function on(){this.s=this.s,this.o=this.o}var kA=0;on.prototype.s=!1;on.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),kA!=0)&&CA(this)};on.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Vm=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Kl(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function bm(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(So(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Te(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Te.prototype.h=function(){this.defaultPrevented=!0};var DA=function(){if(!C.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};C.addEventListener("test",n,e),C.removeEventListener("test",n,e)}catch{}return t}();function ci(t){return/^[\s\xa0]*$/.test(t)}function Ao(){var t=C.navigator;return t&&(t=t.userAgent)?t:""}function _t(t){return Ao().indexOf(t)!=-1}function Hl(t){return Hl[" "](t),t}Hl[" "]=function(){};function OA(t,e){var n=wb;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var xA=_t("Opera"),ar=_t("Trident")||_t("MSIE"),Um=_t("Edge"),Nl=Um||ar,Bm=_t("Gecko")&&!(Ao().toLowerCase().indexOf("webkit")!=-1&&!_t("Edge"))&&!(_t("Trident")||_t("MSIE"))&&!_t("Edge"),MA=Ao().toLowerCase().indexOf("webkit")!=-1&&!_t("Edge");function qm(){var t=C.document;return t?t.documentMode:void 0}var kl;e:{if(ho="",fo=function(){var t=Ao();if(Bm)return/rv:([^\);]+)(\)|;)/.exec(t);if(Um)return/Edge\/([\d\.]+)/.exec(t);if(ar)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(MA)return/WebKit\/(\S+)/.exec(t);if(xA)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),fo&&(ho=fo?fo[1]:""),ar&&(po=qm(),po!=null&&po>parseFloat(ho))){kl=String(po);break e}kl=ho}var ho,fo,po,Dl;C.document&&ar?(bl=qm(),Dl=bl||parseInt(kl,10)||void 0):Dl=void 0;var bl,LA=Dl;function li(t,e){if(Te.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Bm){e:{try{Hl(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:FA[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&li.$.h.call(this)}}he(li,Te);var FA={2:"touch",3:"pen",4:"mouse"};li.prototype.h=function(){li.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var _i="closure_listenable_"+(1e6*Math.random()|0),VA=0;function UA(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++VA,this.fa=this.ia=!1}function bo(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Ql(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function BA(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function $m(t){let e={};for(let n in t)e[n]=t[n];return e}var Cm="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function jm(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<Cm.length;s++)n=Cm[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Co(t){this.src=t,this.g={},this.h=0}Co.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=xl(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new UA(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Ol(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=Vm(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(bo(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function xl(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var Yl="closure_lm_"+(1e6*Math.random()|0),Cl={};function zm(t,e,n,r,i){if(r&&r.once)return Gm(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)zm(t,e[s],n,r,i);return null}return n=Zl(n),t&&t[_i]?t.O(e,n,gi(r)?!!r.capture:!!r,i):Wm(t,e,n,!1,r,i)}function Wm(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=gi(i)?!!i.capture:!!i,a=Xl(t);if(a||(t[Yl]=a=new Co(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=qA(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)DA||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Hm(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function qA(){function t(n){return e.call(t.src,t.listener,n)}let e=$A;return t}function Gm(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Gm(t,e[s],n,r,i);return null}return n=Zl(n),t&&t[_i]?t.P(e,n,gi(r)?!!r.capture:!!r,i):Wm(t,e,n,!0,r,i)}function Km(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Km(t,e[s],n,r,i);else r=gi(r)?!!r.capture:!!r,n=Zl(n),t&&t[_i]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=xl(s,n,r,i),-1<n&&(bo(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Xl(t))&&(e=t.g[e.toString()],t=-1,e&&(t=xl(e,n,r,i)),(n=-1<t?e[t]:null)&&Jl(n))}function Jl(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[_i])Ol(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Hm(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Xl(e))?(Ol(n,t),n.h==0&&(n.src=null,e[Yl]=null)):bo(t)}}}function Hm(t){return t in Cl?Cl[t]:Cl[t]="on"+t}function $A(t,e){if(t.fa)t=!0;else{e=new li(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Jl(t),t=n.call(r,e)}return t}function Xl(t){return t=t[Yl],t instanceof Co?t:null}var Rl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zl(t){return typeof t=="function"?t:(t[Rl]||(t[Rl]=function(e){return t.handleEvent(e)}),t[Rl])}function ue(){on.call(this),this.i=new Co(this),this.S=this,this.J=null}he(ue,on);ue.prototype[_i]=!0;ue.prototype.removeEventListener=function(t,e,n,r){Km(this,t,e,n,r)};function ge(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Te(e,t);else if(e instanceof Te)e.target=e.target||t;else{var i=e;e=new Te(r,t),jm(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=mo(o,r,!0,e)&&i}if(o=e.g=t,i=mo(o,r,!0,e)&&i,i=mo(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=mo(o,r,!1,e)&&i}ue.prototype.N=function(){if(ue.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)bo(n[r]);delete t.g[e],t.h--}}this.J=null};ue.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};ue.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function mo(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Ol(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var eu=C.JSON.stringify,Ml=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function jA(){var t=tu;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Ll=class{constructor(){this.h=this.g=null}add(e,n){let r=Qm.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},Qm=new Ml(()=>new Fl,t=>t.reset()),Fl=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function zA(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function WA(t){C.setTimeout(()=>{throw t},0)}var ui,hi=!1,tu=new Ll,Ym=()=>{let t=C.Promise.resolve(void 0);ui=()=>{t.then(GA)}},GA=()=>{for(var t;t=jA();){try{t.h.call(t.g)}catch(n){WA(n)}var e=Qm;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}hi=!1};function Ro(t,e){ue.call(this),this.h=t||1,this.g=e||C,this.j=we(this.qb,this),this.l=Date.now()}he(Ro,ue);y=Ro.prototype;y.ga=!1;y.T=null;y.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ge(this,"tick"),this.ga&&(nu(this),this.start()))}};y.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function nu(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}y.N=function(){Ro.$.N.call(this),nu(this),delete this.g};function ru(t,e,n){if(typeof t=="function")n&&(t=we(t,n));else if(t&&typeof t.handleEvent=="function")t=we(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:C.setTimeout(t,e||0)}function Jm(t){t.g=ru(()=>{t.g=null,t.i&&(t.i=!1,Jm(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Vl=class extends on{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Jm(this)}N(){super.N(),this.g&&(C.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function di(t){on.call(this),this.h=t,this.g={}}he(di,on);var Rm=[];function Xm(t,e,n,r){Array.isArray(n)||(n&&(Rm[0]=n.toString()),n=Rm);for(var i=0;i<n.length;i++){var s=zm(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Zm(t){Ql(t.g,function(e,n){this.g.hasOwnProperty(n)&&Jl(e)},t),t.g={}}di.prototype.N=function(){di.$.N.call(this),Zm(this)};di.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Po(){this.g=!0}Po.prototype.Ea=function(){this.g=!1};function KA(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function HA(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function sr(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+YA(t,n)+(r?" "+r:"")})}function QA(t,e){t.info(function(){return"TIMEOUT: "+e})}Po.prototype.info=function(){};function YA(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return eu(n)}catch{return e}}var Fn={},Pm=null;function No(){return Pm=Pm||new ue}Fn.Ta="serverreachability";function eg(t){Te.call(this,Fn.Ta,t)}he(eg,Te);function fi(t){let e=No();ge(e,new eg(e))}Fn.STAT_EVENT="statevent";function tg(t,e){Te.call(this,Fn.STAT_EVENT,t),this.stat=e}he(tg,Te);function Ce(t){let e=No();ge(e,new tg(e,t))}Fn.Ua="timingevent";function ng(t,e){Te.call(this,Fn.Ua,t),this.size=e}he(ng,Te);function yi(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return C.setTimeout(function(){t()},e)}var ko={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},rg={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function iu(){}iu.prototype.h=null;function Nm(t){return t.h||(t.h=t.i())}function ig(){}var vi={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function su(){Te.call(this,"d")}he(su,Te);function ou(){Te.call(this,"c")}he(ou,Te);var Ul;function Do(){}he(Do,iu);Do.prototype.g=function(){return new XMLHttpRequest};Do.prototype.i=function(){return{}};Ul=new Do;function Ei(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new di(this),this.P=JA,t=Nl?125:void 0,this.V=new Ro(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new sg}function sg(){this.i=null,this.g="",this.h=!1}var JA=45e3,og={},Bl={};y=Ei.prototype;y.setTimeout=function(t){this.P=t};function ql(t,e,n){t.L=1,t.A=xo(Ft(e)),t.u=n,t.S=!0,ag(t,null)}function ag(t,e){t.G=Date.now(),wi(t),t.B=Ft(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),mg(n.i,"t",r),t.o=0,n=t.l.J,t.h=new sg,t.g=Lg(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Vl(we(t.Pa,t,t.g),t.O)),Xm(t.U,t.g,"readystatechange",t.nb),e=t.I?$m(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),fi(),KA(t.j,t.v,t.B,t.m,t.W,t.u)}y.nb=function(t){t=t.target;let e=this.M;e&&yt(t)==3?e.l():this.Pa(t)};y.Pa=function(t){try{if(t==this.g)e:{let u=yt(this.g);var e=this.g.Ia();let h=this.g.da();if(!(3>u)&&(u!=3||Nl||this.g&&(this.h.h||this.g.ja()||xm(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?fi(3):fi(2)),Oo(this);var n=this.g.da();this.ca=n;t:if(cg(this)){var r=xm(this.g);t="";var i=r.length,s=yt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xn(this),ai(this);var o="";break t}this.h.i=new C.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,HA(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ci(a)){var l=a;break t}}l=null}if(n=l)sr(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$l(this,n);else{this.i=!1,this.s=3,Ce(12),xn(this),ai(this);break e}}this.S?(lg(this,u,o),Nl&&this.i&&u==3&&(Xm(this.U,this.V,"tick",this.mb),this.V.start())):(sr(this.j,this.m,o,null),$l(this,o)),u==4&&xn(this),this.i&&!this.J&&(u==4?Dg(this.l,this):(this.i=!1,wi(this)))}else yb(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),xn(this),ai(this)}}}catch{}finally{}};function cg(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function lg(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=XA(t,n),i==Bl){e==4&&(t.s=4,Ce(14),r=!1),sr(t.j,t.m,null,"[Incomplete Response]");break}else if(i==og){t.s=4,Ce(15),sr(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else sr(t.j,t.m,i,null),$l(t,i);cg(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Ce(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),du(e),e.M=!0,Ce(11))):(sr(t.j,t.m,n,"[Invalid Chunked Response]"),xn(t),ai(t))}y.mb=function(){if(this.g){var t=yt(this.g),e=this.g.ja();this.o<e.length&&(Oo(this),lg(this,t,e),this.i&&t!=4&&wi(this))}};function XA(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Bl:(n=Number(e.substring(n,r)),isNaN(n)?og:(r+=1,r+n>e.length?Bl:(e=e.slice(r,r+n),t.o=r+n,e)))}y.cancel=function(){this.J=!0,xn(this)};function wi(t){t.Y=Date.now()+t.P,ug(t,t.P)}function ug(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=yi(we(t.lb,t),e)}function Oo(t){t.C&&(C.clearTimeout(t.C),t.C=null)}y.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(QA(this.j,this.B),this.L!=2&&(fi(),Ce(17)),xn(this),this.s=2,ai(this)):ug(this,this.Y-t)};function ai(t){t.l.H==0||t.J||Dg(t.l,t)}function xn(t){Oo(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,nu(t.V),Zm(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function $l(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||jl(n.i,t))){if(!t.K&&jl(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Eo(n),Fo(n);else break e;hu(n),Ce(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=yi(we(n.ib,n),6e3));if(1>=yg(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Mn(n,11)}else if((t.K||n.g==t)&&Eo(n),!ci(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];let u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));let h=l[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));let d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let p=t.g;if(p){let f=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(f){var s=r.i;s.g||f.indexOf("spdy")==-1&&f.indexOf("quic")==-1&&f.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(au(s,s.h),s.h=null))}if(r.F){let g=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Y(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=Mg(r,r.J?r.pa:null,r.Y),o.K){vg(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Oo(a),wi(a)),r.g=o}else Ng(r);0<n.j.length&&Vo(n)}else l[0]!="stop"&&l[0]!="close"||Mn(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Mn(n,7):uu(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}fi(4)}catch{}}function ZA(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(So(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function eb(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(So(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function hg(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(So(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=eb(t),r=ZA(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var dg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tb(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ln(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ln){this.h=t.h,yo(this,t.j),this.s=t.s,this.g=t.g,vo(this,t.m),this.l=t.l;var e=t.i,n=new pi;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),km(this,n),this.o=t.o}else t&&(e=String(t).match(dg))?(this.h=!1,yo(this,e[1]||"",!0),this.s=si(e[2]||""),this.g=si(e[3]||"",!0),vo(this,e[4]),this.l=si(e[5]||"",!0),km(this,e[6]||"",!0),this.o=si(e[7]||"")):(this.h=!1,this.i=new pi(null,this.h))}Ln.prototype.toString=function(){var t=[],e=this.j;e&&t.push(oi(e,Dm,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(oi(e,Dm,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(oi(n,n.charAt(0)=="/"?ib:rb,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",oi(n,ob)),t.join("")};function Ft(t){return new Ln(t)}function yo(t,e,n){t.j=n?si(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function vo(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function km(t,e,n){e instanceof pi?(t.i=e,ab(t.i,t.h)):(n||(e=oi(e,sb)),t.i=new pi(e,t.h))}function Y(t,e,n){t.i.set(e,n)}function xo(t){return Y(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function si(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function oi(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,nb),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nb(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Dm=/[#\/\?@]/g,rb=/[#\?:]/g,ib=/[#\?]/g,sb=/[#\?@]/g,ob=/#/g;function pi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function an(t){t.g||(t.g=new Map,t.h=0,t.i&&tb(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}y=pi.prototype;y.add=function(t,e){an(this),this.i=null,t=cr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function fg(t,e){an(t),e=cr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function pg(t,e){return an(t),e=cr(t,e),t.g.has(e)}y.forEach=function(t,e){an(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};y.ta=function(){an(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};y.Z=function(t){an(this);let e=[];if(typeof t=="string")pg(this,t)&&(e=e.concat(this.g.get(cr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};y.set=function(t,e){return an(this),this.i=null,t=cr(this,t),pg(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};y.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function mg(t,e,n){fg(t,e),0<n.length&&(t.i=null,t.g.set(cr(t,e),Kl(n)),t.h+=n.length)}y.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function cr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function ab(t,e){e&&!t.j&&(an(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(fg(this,r),mg(this,i,n))},t)),t.j=e}var cb=class{constructor(t,e){this.g=t,this.map=e}};function gg(t){this.l=t||lb,C.PerformanceNavigationTiming?(t=C.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(C.g&&C.g.Ka&&C.g.Ka()&&C.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var lb=10;function _g(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function yg(t){return t.h?1:t.g?t.g.size:0}function jl(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function au(t,e){t.g?t.g.add(e):t.h=e}function vg(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}gg.prototype.cancel=function(){if(this.i=Eg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function Eg(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return Kl(t.i)}var ub=class{stringify(t){return C.JSON.stringify(t,void 0)}parse(t){return C.JSON.parse(t,void 0)}};function hb(){this.g=new ub}function db(t,e,n){let r=n||"";try{hg(t,function(i,s){let o=i;gi(i)&&(o=eu(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function fb(t,e){let n=new Po;if(C.Image){let r=new Image;r.onload=uo(go,n,r,"TestLoadImage: loaded",!0,e),r.onerror=uo(go,n,r,"TestLoadImage: error",!1,e),r.onabort=uo(go,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=uo(go,n,r,"TestLoadImage: timeout",!1,e),C.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function go(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Ti(t){this.l=t.ec||null,this.j=t.ob||!1}he(Ti,iu);Ti.prototype.g=function(){return new Mo(this.l,this.j)};Ti.prototype.i=function(t){return function(){return t}}({});function Mo(t,e){ue.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=cu,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}he(Mo,ue);var cu=0;y=Mo.prototype;y.open=function(t,e){if(this.readyState!=cu)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,mi(this)};y.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||C).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};y.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=cu};y.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,mi(this)),this.g&&(this.readyState=3,mi(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof C.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;wg(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function wg(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}y.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ii(this):mi(this),this.readyState==3&&wg(this)}};y.Za=function(t){this.g&&(this.response=this.responseText=t,Ii(this))};y.Ya=function(t){this.g&&(this.response=t,Ii(this))};y.ka=function(){this.g&&Ii(this)};function Ii(t){t.readyState=4,t.l=null,t.j=null,t.A=null,mi(t)}y.setRequestHeader=function(t,e){this.v.append(t,e)};y.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};y.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function mi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Mo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var pb=C.JSON.parse;function te(t){ue.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Tg,this.L=this.M=!1}he(te,ue);var Tg="",mb=/^https?$/i,gb=["POST","PUT"];y=te.prototype;y.Oa=function(t){this.M=t};y.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ul.g(),this.C=this.u?Nm(this.u):Nm(Ul),this.g.onreadystatechange=we(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Om(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=C.FormData&&t instanceof C.FormData,!(0<=Vm(gb,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ag(this),0<this.B&&((this.L=_b(this.g))?(this.g.timeout=this.B,this.g.ontimeout=we(this.ua,this)):this.A=ru(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Om(this,s)}};function _b(t){return ar&&typeof t.timeout=="number"&&t.ontimeout!==void 0}y.ua=function(){typeof Gl<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ge(this,"timeout"),this.abort(8))};function Om(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ig(t),Lo(t)}function Ig(t){t.F||(t.F=!0,ge(t,"complete"),ge(t,"error"))}y.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ge(this,"complete"),ge(this,"abort"),Lo(this))};y.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Lo(this,!0)),te.$.N.call(this)};y.La=function(){this.s||(this.G||this.v||this.l?Sg(this):this.kb())};y.kb=function(){Sg(this)};function Sg(t){if(t.h&&typeof Gl<"u"&&(!t.C[1]||yt(t)!=4||t.da()!=2)){if(t.v&&yt(t)==4)ru(t.La,0,t);else if(ge(t,"readystatechange"),yt(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(dg)[1]||null;!i&&C.self&&C.self.location&&(i=C.self.location.protocol.slice(0,-1)),r=!mb.test(i?i.toLowerCase():"")}n=r}if(n)ge(t,"complete"),ge(t,"success");else{t.m=6;try{var s=2<yt(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",Ig(t)}}finally{Lo(t)}}}}function Lo(t,e){if(t.g){Ag(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||ge(t,"ready");try{n.onreadystatechange=r}catch{}}}function Ag(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(C.clearTimeout(t.A),t.A=null)}y.isActive=function(){return!!this.g};function yt(t){return t.g?t.g.readyState:0}y.da=function(){try{return 2<yt(this)?this.g.status:-1}catch{return-1}};y.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};y.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),pb(e)}};function xm(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Tg:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function yb(t){let e={};t=(t.g&&2<=yt(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(ci(t[r]))continue;var n=zA(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}BA(e,function(r){return r.join(", ")})}y.Ia=function(){return this.m};y.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function bg(t){let e="";return Ql(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function lu(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=bg(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Y(t,e,n))}function ri(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Cg(t){this.Ga=0,this.j=[],this.l=new Po,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ri("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ri("baseRetryDelayMs",5e3,t),this.hb=ri("retryDelaySeedMs",1e4,t),this.eb=ri("forwardChannelMaxRetries",2,t),this.xa=ri("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new gg(t&&t.concurrentRequestLimit),this.Ja=new hb,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}y=Cg.prototype;y.ra=8;y.H=1;function uu(t){if(Rg(t),t.H==3){var e=t.W++,n=Ft(t.I);if(Y(n,"SID",t.K),Y(n,"RID",e),Y(n,"TYPE","terminate"),Si(t,n),e=new Ei(t,t.l,e),e.L=2,e.A=xo(Ft(n)),n=!1,C.navigator&&C.navigator.sendBeacon)try{n=C.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&C.Image&&(new Image().src=e.A,n=!0),n||(e.g=Lg(e.l,null),e.g.ha(e.A)),e.G=Date.now(),wi(e)}xg(t)}function Fo(t){t.g&&(du(t),t.g.cancel(),t.g=null)}function Rg(t){Fo(t),t.u&&(C.clearTimeout(t.u),t.u=null),Eo(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&C.clearTimeout(t.m),t.m=null)}function Vo(t){if(!_g(t.i)&&!t.m){t.m=!0;var e=t.Na;ui||Ym(),hi||(ui(),hi=!0),tu.add(e,t),t.C=0}}function vb(t,e){return yg(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=yi(we(t.Na,t,e),Og(t,t.C)),t.C++,!0)}y.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Ei(this,this.l,t),s=this.s;if(this.U&&(s?(s=$m(s),jm(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Pg(this,i,e),n=Ft(this.I),Y(n,"RID",t),Y(n,"CVER",22),this.F&&Y(n,"X-HTTP-Session-Id",this.F),Si(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(bg(s)))+"&"+e:this.o&&lu(n,this.o,s)),au(this.i,i),this.bb&&Y(n,"TYPE","init"),this.P?(Y(n,"$req",e),Y(n,"SID","null"),i.aa=!0,ql(i,n,null)):ql(i,n,e),this.H=2}}else this.H==3&&(t?Mm(this,t):this.j.length==0||_g(this.i)||Mm(this))};function Mm(t,e){var n;e?n=e.m:n=t.W++;let r=Ft(t.I);Y(r,"SID",t.K),Y(r,"RID",n),Y(r,"AID",t.V),Si(t,r),t.o&&t.s&&lu(r,t.o,t.s),n=new Ei(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Pg(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),au(t.i,n),ql(n,r,e)}function Si(t,e){t.na&&Ql(t.na,function(n,r){Y(e,r,n)}),t.h&&hg({},function(n,r){Y(e,r,n)})}function Pg(t,e,n){n=Math.min(t.j.length,n);var r=t.h?we(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let l=i[c].g,u=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{db(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function Ng(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;ui||Ym(),hi||(ui(),hi=!0),tu.add(e,t),t.A=0}}function hu(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=yi(we(t.Ma,t),Og(t,t.A)),t.A++,!0)}y.Ma=function(){if(this.u=null,kg(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=yi(we(this.jb,this),t)}};y.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ce(10),Fo(this),kg(this))};function du(t){t.B!=null&&(C.clearTimeout(t.B),t.B=null)}function kg(t){t.g=new Ei(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ft(t.wa);Y(e,"RID","rpc"),Y(e,"SID",t.K),Y(e,"AID",t.V),Y(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Y(e,"TO",t.qa),Y(e,"TYPE","xmlhttp"),Si(t,e),t.o&&t.s&&lu(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=xo(Ft(e)),n.u=null,n.S=!0,ag(n,t)}y.ib=function(){this.v!=null&&(this.v=null,Fo(this),hu(this),Ce(19))};function Eo(t){t.v!=null&&(C.clearTimeout(t.v),t.v=null)}function Dg(t,e){var n=null;if(t.g==e){Eo(t),du(t),t.g=null;var r=2}else if(jl(t.i,e))n=e.F,vg(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=No(),ge(r,new ng(r,n)),Vo(t)}else Ng(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&vb(t,e)||r==2&&hu(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Mn(t,5);break;case 4:Mn(t,10);break;case 3:Mn(t,6);break;default:Mn(t,2)}}}function Og(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Mn(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=we(t.pb,t);n||(n=new Ln("//www.google.com/images/cleardot.gif"),C.location&&C.location.protocol=="http"||yo(n,"https"),xo(n)),fb(n.toString(),r)}else Ce(2);t.H=0,t.h&&t.h.za(e),xg(t),Rg(t)}y.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Ce(2)):(this.l.info("Failed to ping google.com"),Ce(1))};function xg(t){if(t.H=0,t.ma=[],t.h){let e=Eg(t.i);(e.length!=0||t.j.length!=0)&&(bm(t.ma,e),bm(t.ma,t.j),t.i.i.length=0,Kl(t.j),t.j.length=0),t.h.ya()}}function Mg(t,e,n){var r=n instanceof Ln?Ft(n):new Ln(n);if(r.g!="")e&&(r.g=e+"."+r.g),vo(r,r.m);else{var i=C.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ln(null);r&&yo(s,r),e&&(s.g=e),i&&vo(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Y(r,n,e),Y(r,"VER",t.ra),Si(t,r),r}function Lg(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new te(new Ti({ob:n})):new te(t.va),e.Oa(t.J),e}y.isActive=function(){return!!this.h&&this.h.isActive(this)};function Fg(){}y=Fg.prototype;y.Ba=function(){};y.Aa=function(){};y.za=function(){};y.ya=function(){};y.isActive=function(){return!0};y.Va=function(){};function wo(){if(ar&&!(10<=Number(LA)))throw Error("Environmental error: no available transport.")}wo.prototype.g=function(t,e){return new Be(t,e)};function Be(t,e){ue.call(this),this.g=new Cg(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ci(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ci(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new lr(this)}he(Be,ue);Be.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Ce(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Mg(t,null,t.Y),Vo(t)};Be.prototype.close=function(){uu(this.g)};Be.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=eu(t),t=n);e.j.push(new cb(e.fb++,t)),e.H==3&&Vo(e)};Be.prototype.N=function(){this.g.h=null,delete this.j,uu(this.g),delete this.g,Be.$.N.call(this)};function Vg(t){su.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}he(Vg,su);function Ug(){ou.call(this),this.status=1}he(Ug,ou);function lr(t){this.g=t}he(lr,Fg);lr.prototype.Ba=function(){ge(this.g,"a")};lr.prototype.Aa=function(t){ge(this.g,new Vg(t))};lr.prototype.za=function(t){ge(this.g,new Ug)};lr.prototype.ya=function(){ge(this.g,"b")};function Eb(){this.blockSize=-1}function Ze(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}he(Ze,Eb);Ze.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Pl(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Ze.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Pl(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Pl(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Pl(this,r),i=0;break}}this.h=i,this.i+=e};Ze.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function z(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var wb={};function fu(t){return-128<=t&&128>t?OA(t,function(e){return new z([e|0],0>e?-1:0)}):new z([t|0],0>t?-1:0)}function vt(t){if(isNaN(t)||!isFinite(t))return or;if(0>t)return me(vt(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=zl;return new z(e,0)}function Bg(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return me(Bg(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=vt(Math.pow(e,8)),r=or,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=vt(Math.pow(e,s)),r=r.R(s).add(vt(o))):(r=r.R(n),r=r.add(vt(o)))}return r}var zl=4294967296,or=fu(0),Wl=fu(1),Lm=fu(16777216);y=z.prototype;y.ea=function(){if(Ke(this))return-me(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:zl+r)*e,e*=zl}return t};y.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Lt(this))return"0";if(Ke(this))return"-"+me(this).toString(t);for(var e=vt(Math.pow(t,6)),n=this,r="";;){var i=Io(n,e).g;n=To(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Lt(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};y.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Lt(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Ke(t){return t.h==-1}y.X=function(t){return t=To(this,t),Ke(t)?-1:Lt(t)?0:1};function me(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new z(n,~t.h).add(Wl)}y.abs=function(){return Ke(this)?me(this):this};y.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new z(n,n[n.length-1]&-2147483648?-1:0)};function To(t,e){return t.add(me(e))}y.R=function(t){if(Lt(this)||Lt(t))return or;if(Ke(this))return Ke(t)?me(this).R(me(t)):me(me(this).R(t));if(Ke(t))return me(this.R(me(t)));if(0>this.X(Lm)&&0>t.X(Lm))return vt(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,_o(n,2*r+2*i),n[2*r+2*i+1]+=s*c,_o(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,_o(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,_o(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new z(n,0)};function _o(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function ii(t,e){this.g=t,this.h=e}function Io(t,e){if(Lt(e))throw Error("division by zero");if(Lt(t))return new ii(or,or);if(Ke(t))return e=Io(me(t),e),new ii(me(e.g),me(e.h));if(Ke(e))return e=Io(t,me(e)),new ii(me(e.g),e.h);if(30<t.g.length){if(Ke(t)||Ke(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Wl,r=e;0>=r.X(t);)n=Fm(n),r=Fm(r);var i=ir(n,1),s=ir(r,1);for(r=ir(r,2),n=ir(n,2);!Lt(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=ir(r,1),n=ir(n,1)}return e=To(t,i.R(e)),new ii(i,e)}for(i=or;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=vt(n),o=s.R(e);Ke(o)||0<o.X(t);)n-=r,s=vt(n),o=s.R(e);Lt(s)&&(s=Wl),i=i.add(s),t=To(t,o)}return new ii(i,t)}y.gb=function(t){return Io(this,t).h};y.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new z(n,this.h&t.h)};y.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new z(n,this.h|t.h)};y.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new z(n,this.h^t.h)};function Fm(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new z(n,t.h)}function ir(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new z(i,t.h)}wo.prototype.createWebChannel=wo.prototype.g;Be.prototype.send=Be.prototype.u;Be.prototype.open=Be.prototype.m;Be.prototype.close=Be.prototype.close;ko.NO_ERROR=0;ko.TIMEOUT=8;ko.HTTP_ERROR=6;rg.COMPLETE="complete";ig.EventType=vi;vi.OPEN="a";vi.CLOSE="b";vi.ERROR="c";vi.MESSAGE="d";ue.prototype.listen=ue.prototype.O;te.prototype.listenOnce=te.prototype.P;te.prototype.getLastError=te.prototype.Sa;te.prototype.getLastErrorCode=te.prototype.Ia;te.prototype.getStatus=te.prototype.da;te.prototype.getResponseJson=te.prototype.Wa;te.prototype.getResponseText=te.prototype.ja;te.prototype.send=te.prototype.ha;te.prototype.setWithCredentials=te.prototype.Oa;Ze.prototype.digest=Ze.prototype.l;Ze.prototype.reset=Ze.prototype.reset;Ze.prototype.update=Ze.prototype.j;z.prototype.add=z.prototype.add;z.prototype.multiply=z.prototype.R;z.prototype.modulo=z.prototype.gb;z.prototype.compare=z.prototype.X;z.prototype.toNumber=z.prototype.ea;z.prototype.toString=z.prototype.toString;z.prototype.getBits=z.prototype.D;z.fromNumber=vt;z.fromString=Bg;var Tb=et.createWebChannelTransport=function(){return new wo},Ib=et.getStatEventTarget=function(){return No()},Sb=et.ErrorCode=ko,Ab=et.EventType=rg,bb=et.Event=Fn,Cb=et.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Rb=et.FetchXmlHttpFactory=Ti,Pb=et.WebChannel=ig,Nb=et.XhrIo=te,kb=et.Md5=Ze,qg=et.Integer=z;var $g="@firebase/firestore";var de=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};de.UNAUTHENTICATED=new de(null),de.GOOGLE_CREDENTIALS=new de("google-credentials-uid"),de.FIRST_PARTY=new de("first-party-uid"),de.MOCK_USER=new de("mock-user");var bi="10.11.1";var hr=new ht("@firebase/firestore");function qe(t,...e){if(hr.logLevel<=U.DEBUG){let n=e.map(xu);hr.debug(`Firestore (${bi}): ${t}`,...n)}}function Ou(t,...e){if(hr.logLevel<=U.ERROR){let n=e.map(xu);hr.error(`Firestore (${bi}): ${t}`,...n)}}function Db(t,...e){if(hr.logLevel<=U.WARN){let n=e.map(xu);hr.warn(`Firestore (${bi}): ${t}`,...n)}}function xu(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function Ne(t="Unexpected state"){let e=`FIRESTORE (${bi}) INTERNAL ASSERTION FAILED: `+t;throw Ou(e),new Error(e)}function Ai(t,e){t||Ne()}var _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},se=class extends be{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ln=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Uo=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},mu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(de.UNAUTHENTICATED))}shutdown(){}},gu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},_u=class{constructor(e){this.t=e,this.currentUser=de.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new ln;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ln,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>m(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ln)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ai(typeof r.accessToken=="string"),new Uo(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Ai(e===null||typeof e=="string"),new de(e)}},yu=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=de.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},vu=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new yu(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(de.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Eu=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},wu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ai(typeof n.token=="string"),this.R=n.token,new Eu(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Ob(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Tu=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Ob(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function Kg(t,e){return t<e?-1:t>e?1:0}var Iu=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ne(),r===void 0?r=e.length-n:r>e.length-n&&Ne(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},cn=class t extends Iu{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new se(_e.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}};var Vn=class t{constructor(e){this.path=e}static fromPath(e){return new t(cn.fromString(e))}static fromName(e){return new t(cn.fromString(e).popFirst(5))}static empty(){return new t(cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&cn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return cn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new cn(e.slice()))}};var Su=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};Su.UNKNOWN_ID=-1;function Hg(t){return t.name==="IndexedDbTransactionError"}function xb(t){return t===0&&1/t==-1/0}var Mb=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],aD=[...Mb,"documentOverlays"],Lb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Fb=Lb,cD=[...Fb,"indexConfiguration","indexState","indexEntries"];var dr=class t{constructor(e,n){this.comparator=e,this.root=n||wt.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,wt.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ur(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ur(this.root,e,this.comparator,!1)}getReverseIterator(){return new ur(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ur(this.root,e,this.comparator,!0)}},ur=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},wt=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ne();let e=this.left.check();if(e!==this.right.check())throw Ne();return e+(this.isRed()?0:1)}};wt.EMPTY=null,wt.RED=!0,wt.BLACK=!1;wt.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne()}get value(){throw Ne()}get color(){throw Ne()}get left(){throw Ne()}get right(){throw Ne()}copy(e,n,r,i,s){return this}insert(e,n,r){return new wt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Bo=class t{constructor(e){this.comparator=e,this.data=new dr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new qo(this.data.getIterator())}getIteratorFrom(e){return new qo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},qo=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Au=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var fr=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Au("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Kg(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};fr.EMPTY_BYTE_STRING=new fr("");var Vb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ub(t){if(Ai(!!t),typeof t=="string"){let e=0,n=Vb.exec(t);if(Ai(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$o(t.seconds),nanos:$o(t.nanos)}}function $o(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Bb(t){return typeof t=="string"?fr.fromBase64String(t):fr.fromUint8Array(t)}var bu=class{constructor(e,n,r,i,s,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Cu=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};function qb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var uD=new dr(Vn.comparator);var hD=new dr(Vn.comparator);var dD=new dr(Vn.comparator),fD=new Bo(Vn.comparator);var pD=new Bo(Kg);var jg,L;(L=jg||(jg={}))[L.OK=0]="OK",L[L.CANCELLED=1]="CANCELLED",L[L.UNKNOWN=2]="UNKNOWN",L[L.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",L[L.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",L[L.NOT_FOUND=5]="NOT_FOUND",L[L.ALREADY_EXISTS=6]="ALREADY_EXISTS",L[L.PERMISSION_DENIED=7]="PERMISSION_DENIED",L[L.UNAUTHENTICATED=16]="UNAUTHENTICATED",L[L.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",L[L.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",L[L.ABORTED=10]="ABORTED",L[L.OUT_OF_RANGE=11]="OUT_OF_RANGE",L[L.UNIMPLEMENTED=12]="UNIMPLEMENTED",L[L.INTERNAL=13]="INTERNAL",L[L.UNAVAILABLE=14]="UNAVAILABLE",L[L.DATA_LOSS=15]="DATA_LOSS";var mD=new qg([4294967295,4294967295],0);var jo=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et($o(e.integerValue));else if("doubleValue"in e){let r=$o(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),xb(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"&&(r=Ub(r)),n.dt(`${r.seconds||""}`),n.Et(r.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(Bb(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?qb(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):Ne()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),Vn.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};jo.St=new jo;var gD=new Uint8Array(0);var Et=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Et.DEFAULT_COLLECTION_PERCENTILE=10,Et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Et.DEFAULT=new Et(41943040,Et.DEFAULT_COLLECTION_PERCENTILE,Et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Et.DISABLED=new Et(-1,0,0);function pu(){return typeof document<"u"?document:null}var Ru=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Oo=r,this.No=i,this.Lo=s,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();let n=Math.floor(this.Bo+this.$o()),r=Math.max(0,Date.now()-this.qo),i=Math.max(0,n-r);i>0&&qe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Bo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){this.ko!==null&&(this.ko.skipDelay(),this.ko=null)}cancel(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}};var Pu=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ln,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function $b(t,e){if(Ou("AsyncQueue",`${e}: ${t}`),Hg(t))return new se(_e.UNAVAILABLE,`${e}: ${t}`);throw t}var zg,Wg;(Wg=zg||(zg={})).J_="default",Wg.Cache="cache";var Nu=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=de.UNAUTHENTICATED,this.clientId=Tu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>m(this,null,function*(){qe("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(qe("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new se(_e.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ln;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>m(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=$b(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Qg(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var Gg=new Map;function jb(t,e,n,r){if(e===!0&&r===!0)throw new se(_e.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function zb(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ne()}function Wb(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=zb(t);throw new se(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var zo=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new se(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new se(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Qg((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new se(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new se(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new se(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Wo=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new se(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new se(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new mu;switch(r.type){case"firstParty":return new vu(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=Gg.get(n);r&&(qe("ComponentProvider","Removing Datastore"),Gg.delete(n),r.terminate())}(this),Promise.resolve()}};function Yg(t,e,n,r={}){var i;let s=(t=Wb(t,Wo))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Db("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=de.MOCK_USER;else{a=er(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new se(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new de(l)}t._authCredentials=new gu(new Uo(a,c))}}var ku=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new Ru(this,"async_queue_retry"),this.hu=()=>{let n=pu();n&&qe("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Jo.Uo()};let e=pu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let n=pu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let n=new ln;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return m(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!Hg(e))throw e;qe("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko(()=>this.Tu())}})}Iu(e){let n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ou("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);let i=Pu.createAndSchedule(this,e,n,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&Ne()}verifyOperationInProgress(){}du(){return m(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let n=this._u.indexOf(e);this._u.splice(n,1)}};var Du=class extends Wo{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new ku}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Gb(this),this._firestoreClient.terminate()}};function Jg(t,e){let n=typeof t=="object"?t:ft(),r=typeof t=="string"?t:e||"(default)",i=Nt(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Zn("firestore");s&&Yg(i,...s)}return i}function Gb(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,l,u){return new bu(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Qg(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new Nu(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var _D=new RegExp("[~\\*/\\[\\]]");(function(e,n=!0){(function(i){bi=i})(Ge),We(new Ee("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Du(new _u(r.getProvider("auth-internal")),new wu(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new se(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cu(l.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),j($g,"4.6.1",e),j($g,"4.6.1","esm2017")})();var Vt=class{constructor(e){return e}},Xg="firestore",Mu=class{constructor(){return Dt(Xg)}};var Lu=new Z("angularfire2.firestore-instances");function Kb(t,e){let n=tn(Xg,t,e);return n&&new Vt(n)}function Hb(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Vt(r)}}var Qb={provide:Mu,deps:[[new ee,Lu]]},Yb={provide:Vt,useFactory:Kb,deps:[[new ee,Lu],Ue]},Jb=(()=>{class t{constructor(){j("angularfire",Je.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Le({type:t});static \u0275inj=Me({providers:[Yb,Qb]})}return t})();function Zg(t,...e){return{ngModule:Jb,providers:[{provide:Lu,useFactory:Hb(t),multi:!0,deps:[ve,ot,mt,Xe,[new ee,Mt],[new ee,pt],...e]}]}}var e_=Pe(Jg,!0);var o_="firebasestorage.googleapis.com",Xb="storageBucket",Zb=2*60*1e3,eC=10*60*1e3;var Tt=class t extends be{constructor(e,n,r=0){super(Fu(e),`Firebase Storage: ${n} (${Fu(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Fu(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Bt=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Bt||{});function Fu(t){return"storage/"+t}function tC(){let t="An unknown error occurred, please check the error payload for server response.";return new Tt(Bt.UNKNOWN,t)}function nC(){return new Tt(Bt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rC(){return new Tt(Bt.CANCELED,"User canceled the upload/download.")}function iC(t){return new Tt(Bt.INVALID_URL,"Invalid URL '"+t+"'.")}function sC(t){return new Tt(Bt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function t_(t){return new Tt(Bt.INVALID_ARGUMENT,t)}function a_(){return new Tt(Bt.APP_DELETED,"The Firebase app was deleted.")}function oC(t){return new Tt(Bt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Ut=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw sC(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(E){E.path_=decodeURIComponent(E.path)}let u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${i}/o${d}`,"i"),f={bucket:1,path:3},g=n===o_?"(?:storage.googleapis.com|storage.cloud.google.com)":n,v="([^?#]*)",I=new RegExp(`^https?://${g}/${i}/${v}`,"i"),D=[{regex:a,indices:c,postModify:s},{regex:p,indices:f,postModify:l},{regex:I,indices:{bucket:1,path:2},postModify:l}];for(let E=0;E<D.length;E++){let M=D[E],A=M.regex.exec(e);if(A){let $=A[M.indices.bucket],B=A[M.indices.path];B||(B=""),r=new t($,B),M.postModify(r);break}}if(r==null)throw iC(e);return r}},Vu=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function aC(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...v){l||(l=!0,e.apply(null,v))}function h(v){i=setTimeout(()=>{i=null,t(p,c())},v)}function d(){s&&clearTimeout(s)}function p(v,...I){if(l){d();return}if(v){d(),u.call(null,v,...I);return}if(c()||o){d(),u.call(null,v,...I);return}r<64&&(r*=2);let D;a===1?(a=2,D=0):D=(r+Math.random())*1e3,h(D)}let f=!1;function g(v){f||(f=!0,d(),!l&&(i!==null?(v||(a=2),clearTimeout(i),h(0)):v||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function cC(t){t(!1)}function lC(t){return t!==void 0}function n_(t,e,n,r){if(r<e)throw t_(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw t_(`Invalid value for '${t}'. Expected ${n} or less.`)}function uC(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Uu=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(Uu||{});function hC(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var Bu=class{constructor(e,n,r,i,s,o,a,c,l,u,h,d=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,f)=>{this.resolve_=p,this.reject_=f,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new pr(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Uu.NO_ERROR,c=s.getStatus();if(!a||hC(c,this.additionalRetryCodes_)&&this.retry){let u=s.getErrorCode()===Uu.ABORT;r(!1,new pr(!1,null,u));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new pr(l,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());lC(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=tC();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?a_():rC();o(c)}else{let c=nC();o(c)}};this.canceled_?n(!1,new pr(!1,null,!0)):this.backoffId_=aC(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&cC(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},pr=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function dC(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function fC(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function pC(t,e){e&&(t["X-Firebase-GMPID"]=e)}function mC(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function gC(t,e,n,r,i,s,o=!0){let a=uC(t.urlParams),c=t.url+a,l=Object.assign({},t.headers);return pC(l,e),dC(l,n),fC(l,s),mC(l,r),new Bu(c,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function _C(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function yC(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}var GO=256*1024;var qu=class t{constructor(e,n){this._service=e,n instanceof Ut?this._location=n:this._location=Ut.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new Ut(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yC(this._location.path)}get storage(){return this._service}get parent(){let e=_C(this._location.path);if(e===null)return null;let n=new Ut(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw oC(e)}};function r_(t,e){let n=e?.[Xb];return n==null?null:Ut.makeFromBucketSpec(n,t)}function vC(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:er(i,t.app.options.projectId))}var $u=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=o_,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Zb,this._maxUploadRetryTime=eC,this._requests=new Set,i!=null?this._bucket=Ut.makeFromBucketSpec(i,this._host):this._bucket=r_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ut.makeFromBucketSpec(this._url,e):this._bucket=r_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){n_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){n_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return m(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return m(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qu(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new Vu(a_());{let o=gC(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return m(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},i_="@firebase/storage",s_="0.12.4";var c_="storage";function l_(t=ft(),e){t=pe(t);let r=Nt(t,c_).getImmediate({identifier:e}),i=Zn("storage");return i&&u_(r,...i),r}function u_(t,e,n,r={}){vC(t,e,n,r)}function EC(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new $u(n,r,i,e,Ge)}function wC(){We(new Ee(c_,EC,"PUBLIC").setMultipleInstances(!0)),j(i_,s_,""),j(i_,s_,"esm2017")}wC();var Ci=class{constructor(e){return e}},h_="storage",ju=class{constructor(){return Dt(h_)}};var zu=new Z("angularfire2.storage-instances");function TC(t,e){let n=tn(h_,t,e);return n&&new Ci(n)}function IC(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Ci(r)}}var SC={provide:ju,deps:[[new ee,zu]]},AC={provide:Ci,useFactory:TC,deps:[[new ee,zu],Ue]},bC=(()=>{class t{constructor(){j("angularfire",Je.full,"gcs")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Le({type:t});static \u0275inj=Me({providers:[AC,SC]})}return t})();function d_(t,...e){return{ngModule:bC,providers:[{provide:zu,useFactory:IC(t),multi:!0,deps:[ve,ot,mt,Xe,[new ee,Mt],[new ee,pt],...e]}]}}var f_=Pe(l_,!0);var p_="@firebase/database",m_="1.0.4";var Kh="";function CC(t){Kh=t}var Xu=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),re(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Xn(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Zu=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return ut(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var G_=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Xu(e)}}catch{}return new Zu},Bn=G_("localStorage"),eh=G_("sessionStorage");var _r=new ht("@firebase/database"),RC=function(){let t=1;return function(){return t++}}(),K_=function(t){let e=yp(t),n=new Fs;n.update(e);let r=n.digest();return Vs.encodeByteArray(r)},Wi=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Wi.apply(null,r):typeof r=="object"?e+=re(r):e+=r,e+=" "}return e},$n=null,g_=!0,PC=function(t,e){_(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(_r.logLevel=U.VERBOSE,$n=_r.log.bind(_r),e&&eh.set("logging_enabled",!0)):typeof t=="function"?$n=t:($n=null,eh.remove("logging_enabled"))},Ie=function(...t){if(g_===!0&&(g_=!1,$n===null&&eh.get("logging_enabled")===!0&&PC(!0)),$n){let e=Wi.apply(null,t);$n(e)}},Gi=function(t){return function(...e){Ie(t,...e)}},th=function(...t){let e="FIREBASE INTERNAL ERROR: "+Wi(...t);_r.error(e)},qt=function(...t){let e=`FIREBASE FATAL ERROR: ${Wi(...t)}`;throw _r.error(e),new Error(e)},ke=function(...t){let e="FIREBASE WARNING: "+Wi(...t);_r.warn(e)},NC=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ke("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},H_=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},kC=function(t){if(lt()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},vr="[MIN_NAME]",jn="[MAX_NAME]",br=function(t,e){if(t===e)return 0;if(t===vr||e===jn)return-1;if(e===vr||t===jn)return 1;{let n=__(t),r=__(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},DC=function(t,e){return t===e?0:t<e?-1:1},Ri=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+re(e))},Hh=function(t){if(typeof t!="object"||t===null)return re(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=re(e[r]),n+=":",n+=Hh(t[e[r]]);return n+="}",n},Q_=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function De(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var Y_=function(t){_(!H_(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let u=l.join(""),h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},OC=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},xC=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function MC(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var LC=new RegExp("^-?(0*)\\d{1,10}$"),FC=-2147483648,VC=2147483647,__=function(t){if(LC.test(t)){let e=Number(t);if(e>=FC&&e<=VC)return e}return null},Cr=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw ke("Exception was thrown by user callback.",n),e},Math.floor(0))}},UC=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Oi=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var nh=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ke(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var rh=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ie("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ke(e)}},xi=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Ko="5",J_="v",X_="s",Z_="r",ey="f",ty=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ny="ls",ry="p",ih="ac",iy="websocket",sy="long_polling";var Ho=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Bn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Bn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function BC(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function oy(t,e,n){_(typeof e=="string","typeof type must == string"),_(typeof n=="object","typeof params must == object");let r;if(e===iy)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===sy)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);BC(t)&&(n.ns=t.namespace);let i=[];return De(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var sh=class{constructor(){this.counters_={}}incrementCounter(e,n=1){ut(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return lp(this.counters_)}};var Wu={},Gu={};function Qh(t){let e=t.toString();return Wu[e]||(Wu[e]=new sh),Wu[e]}function qC(t,e){let n=t.toString();return Gu[n]||(Gu[n]=e()),Gu[n]}var oh=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Cr(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var y_="start",$C="close",jC="pLPCommand",zC="pRTLPCB",ay="id",cy="pw",ly="ser",WC="cb",GC="seg",KC="ts",HC="d",QC="dframe",uy=1870,hy=30,YC=uy-hy,JC=25e3,XC=3e4,ah=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Gi(e),this.stats_=Qh(n),this.urlFn=c=>(this.appCheckToken&&(c[ih]=this.appCheckToken),oy(n,sy,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new oh(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(XC)),kC(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ch((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===y_)this.id=a,this.password=c;else if(o===$C)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[y_]="t",r[ly]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[WC]=this.scriptTagHolder.uniqueCallbackIdentifier),r[J_]=Ko,this.transportSessionId&&(r[X_]=this.transportSessionId),this.lastSessionId&&(r[ny]=this.lastSessionId),this.applicationId&&(r[ry]=this.applicationId),this.appCheckToken&&(r[ih]=this.appCheckToken),typeof location<"u"&&location.hostname&&ty.test(location.hostname)&&(r[Z_]=ey);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return lt()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!OC()&&!xC()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=re(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Tc(n),i=Q_(r,YC);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(lt())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[QC]="t",r[ay]=e,r[cy]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=re(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},ch=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,lt())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=RC(),window[jC+this.uniqueCallbackIdentifier]=e,window[zC+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ie("frame writing exception"),a.stack&&Ie(a.stack),Ie(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ie("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[ay]=this.myID,e[cy]=this.myPW,e[ly]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+hy+r.length<=uy;){let o=this.pendingSegs.shift();r=r+"&"+GC+i+"="+o.seg+"&"+KC+i+"="+o.ts+"&"+HC+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(JC)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){lt()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Ie("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var ZC=16384,eR=45e3,Qo=null;typeof MozWebSocket<"u"?Qo=MozWebSocket:typeof WebSocket<"u"&&(Qo=WebSocket);var Pi=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Gi(this.connId),this.stats_=Qh(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[J_]=Ko,!lt()&&typeof location<"u"&&location.hostname&&ty.test(location.hostname)&&(a[Z_]=ey),r&&(a[X_]=r),i&&(a[ny]=i),s&&(a[ih]=s),o&&(a[ry]=o),oy(n,iy,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Bn.set("previous_websocket_failure",!0);try{let i;if(lt()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Ko}/${Kh}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Qo(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Qo!==null&&!t.forceDisallow_}static previouslyFailed(){return Bn.isInMemoryStorage||Bn.get("previous_websocket_failure")===!0}markConnectionHealthy(){Bn.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Xn(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(_(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=re(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=Q_(r,ZC);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(eR))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),tR=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[ah,Pi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Pi&&Pi.isAvailable(),i=r&&!Pi.previouslyFailed();if(n.webSocketOnly&&(r||ke("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Pi];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),nR=6e4,rR=5e3,iR=10*1024,sR=100*1024,Ku="t",v_="d",oR="s",E_="r",aR="e",w_="o",T_="a",I_="n",S_="p",cR="h",lh=class{constructor(e,n,r,i,s,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Gi("c:"+this.id+":"),this.transportManager_=new tR(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Oi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>sR?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>iR?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ku in e){let n=e[Ku];n===T_?this.upgradeIfSecondaryHealthy_():n===E_?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===w_&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Ri("t",e),r=Ri("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:S_,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:T_,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:I_,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Ri("t",e),r=Ri("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Ri(Ku,e);if(v_ in e){let r=e[v_];if(n===cR){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===I_){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===oR?this.onConnectionShutdown_(r):n===E_?this.onReset_(r):n===aR?th("Server Error: "+r):n===w_?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):th("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Ko!==r&&ke("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Oi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(nR))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Oi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(rR))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:S_,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Bn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Yo=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Jo=class{constructor(e){this.allowedEvents_=e,this.listeners_={},_(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){_(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Xo=class t extends Jo{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!jr()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return _(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var A_=32,b_=768,W=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function q(){return new W("")}function x(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function dn(t){return t.pieces_.length-t.pieceNum_}function H(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new W(t.pieces_,e)}function dy(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function lR(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function fy(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function py(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new W(e,0)}function oe(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof W)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new W(n,0)}function O(t){return t.pieceNum_>=t.pieces_.length}function Re(t,e){let n=x(t),r=x(e);if(n===null)return e;if(n===r)return Re(H(t),H(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function my(t,e){if(dn(t)!==dn(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function nt(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(dn(t)>dn(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var uh=class{constructor(e,n){this.errorPrefix_=n,this.parts_=fy(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Gr(this.parts_[r]);gy(this)}};function uR(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Gr(e),gy(t)}function hR(t){let e=t.parts_.pop();t.byteLength_-=Gr(e),t.parts_.length>0&&(t.byteLength_-=1)}function gy(t){if(t.byteLength_>b_)throw new Error(t.errorPrefix_+"has a key path longer than "+b_+" bytes ("+t.byteLength_+").");if(t.parts_.length>A_)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+A_+") or object contains a cycle "+Un(t))}function Un(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var hh=class t extends Jo{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return _(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ni=1e3,dR=60*5*1e3,C_=30*1e3,fR=1.3,pR=3e4,mR="server_kill",R_=3,Yh=(()=>{class t extends Yo{constructor(n,r,i,s,o,a,c,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=Gi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ni,this.maxReconnectDelay_=dR,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!lt())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");hh.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Xo.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(re(o)),_(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new Zt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),_(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),_(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(u,l))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&ut(n,"w")){let i=Sn(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();ke(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||gp(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=C_)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=mp(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),_(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+re(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):th("Unrecognized action received from server: "+re(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){_(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ni,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Ni,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>pR&&(this.reconnectDelay_=Ni),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*fR)}this.onConnectStatus_(!1)}establishConnection_(){return m(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},u=function(d){_(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(d)};this.realtime_={close:l,sendRequest:u};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[d,p]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Ie("getToken() completed but was canceled"):(Ie("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,c=new lh(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,f=>{ke(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(mR)},o))}catch(d){this.log_("Failed to get token: "+d),a||(this.repoInfo_.nodeAdmin&&ke(d),l())}}})}interrupt(n){Ie("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Ie("Resuming connection for reason: "+n),delete this.interruptReasons_[n],zr(this.interruptReasons_)&&(this.reconnectDelay_=Ni,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>Hh(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new W(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Ie("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=R_&&(this.reconnectDelay_=C_,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Ie("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=R_&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";lt()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+Kh.replace(/\./g,"-")]=1,jr()?n["framework.cordova"]=1:Us()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Xo.getInstance().currentlyOnline();return zr(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),k=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Er=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new k(vr,e),i=new k(vr,n);return this.compare(r,i)!==0}minPost(){return k.MIN}};var Go,Zo=class extends Er{static get __EMPTY_NODE(){return Go}static set __EMPTY_NODE(e){Go=e}compare(e,n){return br(e.name,n.name)}isDefinedOn(e){throw In("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return k.MIN}maxPost(){return new k(jn,Go)}makePost(e,n){return _(typeof e=="string","KeyIndex indexValue must always be a string."),new k(e,Go)}toString(){return".key"}},yr=new Zo;var gr=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},tt=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??He.EMPTY_NODE,this.right=o??He.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return He.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return He.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),dh=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new tt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},He=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,tt.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,tt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new gr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new gr(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new gr(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new gr(this.root_,null,this.comparator_,!0,e)}};He.EMPTY_NODE=new dh;function gR(t,e){return br(t.name,e.name)}function Jh(t,e){return br(t,e)}var fh;function _R(t){fh=t}var _y=function(t){return typeof t=="number"?"number:"+Y_(t):"string:"+t},yy=function(t){if(t.isLeafNode()){let e=t.val();_(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ut(e,".sv"),"Priority must be a string or number.")}else _(t===fh||t.isEmpty(),"priority of unexpected type.");_(t===fh||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var P_,wr=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,_(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),yy(this.priorityNode_)}static set __childrenNodeConstructor(n){P_=n}static get __childrenNodeConstructor(){return P_}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return O(n)?this:x(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=x(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(_(i!==".priority"||dn(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(H(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+_y(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=Y_(this.value_):n+=this.value_,this.lazyHash_=K_(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(_(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return _(s>=0,"Unknown leaf type: "+r),_(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),vy,Ey;function yR(t){vy=t}function vR(t){Ey=t}var ph=class extends Er{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?br(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return k.MIN}maxPost(){return new k(jn,new wr("[PRIORITY-POST]",Ey))}makePost(e,n){let r=vy(e);return new k(n,new wr("[PRIORITY-POST]",r))}toString(){return".priority"}},ne=new ph;var ER=Math.log(2),mh=class{constructor(e){let n=s=>parseInt(Math.log(s)/ER,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ea=function(t,e,n,r){t.sort(e);let i=function(c,l){let u=l-c,h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new tt(d,h.node,tt.BLACK,null,null);{let p=parseInt(u/2,10)+c,f=i(c,p),g=i(p+1,l);return h=t[p],d=n?n(h):h,new tt(d,h.node,tt.BLACK,f,g)}},s=function(c){let l=null,u=null,h=t.length,d=function(f,g){let v=h-f,I=h;h-=f;let P=i(v+1,I),D=t[v],E=n?n(D):D;p(new tt(E,D.node,g,null,P))},p=function(f){l?(l.left=f,l=f):(u=f,l=f)};for(let f=0;f<c.count;++f){let g=c.nextBitIsOne(),v=Math.pow(2,c.count-(f+1));g?d(v,tt.BLACK):(d(v,tt.BLACK),d(v,tt.RED))}return u},o=new mh(t.length),a=s(o);return new He(r||e,a)};var Hu,mr={},Tr=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return _(mr&&ne,"ChildrenNode.ts has not been loaded"),Hu=Hu||new t({".priority":mr},{".priority":ne}),Hu}get(e){let n=Sn(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof He?n:null}hasIndex(e){return ut(this.indexSet_,e.toString())}addIndex(e,n){_(e!==yr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(k.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=ea(r,e.getCompare()):a=mr;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new t(u,l)}addToIndexes(e,n){let r=Wr(this.indexes_,(i,s)=>{let o=Sn(this.indexSet_,s);if(_(o,"Missing index implementation for "+s),i===mr)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(k.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),ea(a,o.getCompare())}else return mr;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new k(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Wr(this.indexes_,i=>{if(i===mr)return i;{let s=n.get(e.name);return s?i.remove(new k(e.name,s)):i}});return new t(r,this.indexSet_)}};var ki,R=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&yy(this.priorityNode_),this.children_.isEmpty()&&_(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ki||(ki=new t(new He(Jh),null,Tr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ki}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?ki:r}}getChild(n){let r=x(n);return r===null?this:this.getImmediateChild(r).getChild(H(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(_(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new k(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?ki:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=x(n);if(i===null)return r;{_(x(n)!==".priority"||dn(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(H(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(ne,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+_y(this.getPriority().val())+":"),this.forEachChild(ne,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":K_(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new k(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new k(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new k(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,k.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,k.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ki?-1:0}withIndex(n){if(n===yr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===yr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(ne),s=r.getIterator(ne),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===yr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),gh=class extends R{constructor(){super(new He(Jh),R.EMPTY_NODE,Tr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return R.EMPTY_NODE}isEmpty(){return!1}},Ki=new gh;Object.defineProperties(k,{MIN:{value:new k(vr,R.EMPTY_NODE)},MAX:{value:new k(jn,Ki)}});Zo.__EMPTY_NODE=R.EMPTY_NODE;wr.__childrenNodeConstructor=R;_R(Ki);vR(Ki);var wR=!0;function fe(t,e=null){if(t===null)return R.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),_(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new wr(n,fe(e))}if(!(t instanceof Array)&&wR){let n=[],r=!1;if(De(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=fe(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new k(o,c)))}}),n.length===0)return R.EMPTY_NODE;let s=ea(n,gR,o=>o.name,Jh);if(r){let o=ea(n,ne.getCompare());return new R(s,fe(e),new Tr({".priority":o},{".priority":ne}))}else return new R(s,fe(e),Tr.Default)}else{let n=R.EMPTY_NODE;return De(t,(r,i)=>{if(ut(t,r)&&r.substring(0,1)!=="."){let s=fe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(fe(e))}}yR(fe);var _h=class extends Er{constructor(e){super(),this.indexPath_=e,_(!O(e)&&x(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?br(e.name,n.name):s}makePost(e,n){let r=fe(e),i=R.EMPTY_NODE.updateChild(this.indexPath_,r);return new k(n,i)}maxPost(){let e=R.EMPTY_NODE.updateChild(this.indexPath_,Ki);return new k(jn,e)}toString(){return fy(this.indexPath_,0).join("/")}};var yh=class extends Er{compare(e,n){let r=e.node.compareTo(n.node);return r===0?br(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return k.MIN}maxPost(){return k.MAX}makePost(e,n){let r=fe(e);return new k(n,r)}toString(){return".value"}},TR=new yh;function wy(t){return{type:"value",snapshotNode:t}}function Ir(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Vi(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ui(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function IR(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Bi=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){_(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Vi(n,a)):_(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ir(n,r)):o.trackChildChange(Ui(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ne,(i,s)=>{n.hasChild(i)||r.trackChildChange(Vi(i,s))}),n.isLeafNode()||n.forEachChild(ne,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Ui(i,s,o))}else r.trackChildChange(Ir(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?R.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var ta=class t{constructor(e){this.indexedFilter_=new Bi(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new k(n,r))||(r=R.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=R.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(R.EMPTY_NODE);let s=this;return n.forEachChild(ne,(o,a)=>{s.matches(new k(o,a))||(i=i.updateImmediateChild(o,R.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var vh=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ta(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new k(n,r))||(r=R.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=R.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=R.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(R.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,R.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(d,p)=>h(p,d)}else o=this.index_.getCompare();let a=e;_(a.numChildren()===this.limit_,"");let c=new k(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){let h=a.getImmediateChild(n),d=i.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);let p=d==null?1:o(d,c);if(u&&!r.isEmpty()&&p>=0)return s?.trackChildChange(Ui(n,r,h)),a.updateImmediateChild(n,r);{s?.trackChildChange(Vi(n,h));let g=a.updateImmediateChild(n,R.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s?.trackChildChange(Ir(d.name,d.node)),g.updateImmediateChild(d.name,d.node)):g}}else return r.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Vi(l.name,l.node)),s.trackChildChange(Ir(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,R.EMPTY_NODE)):e}};var Eh=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ne}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return _(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return _(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:vr}hasEnd(){return this.endSet_}getIndexEndValue(){return _(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return _(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:jn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return _(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ne}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function SR(t){return t.loadsAllData()?new Bi(t.getIndex()):t.hasLimit()?new vh(t):new ta(t)}function N_(t){let e={};if(t.isDefault())return e;let n;if(t.index_===ne?n="$priority":t.index_===TR?n="$value":t.index_===yr?n="$key":(_(t.index_ instanceof _h,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=re(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=re(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+re(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=re(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+re(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function k_(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ne&&(e.i=t.index_.toString()),e}var wh=class t extends Yo{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Gi("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(_(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=N_(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Sn(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",i(d,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=N_(e._queryParams),r=e._path.toString(),i=new Zt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+bn(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Xn(a.responseText)}catch{ke("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&ke("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var Th=class{constructor(){this.rootNode_=R.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function na(){return{value:null,children:new Map}}function Ty(t,e,n){if(O(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=x(e);t.children.has(r)||t.children.set(r,na());let i=t.children.get(r);e=H(e),Ty(i,e,n)}}function Ih(t,e,n){t.value!==null?n(e,t.value):AR(t,(r,i)=>{let s=new W(e.toString()+"/"+r);Ih(i,s,n)})}function AR(t,e){t.children.forEach((n,r)=>{e(r,n)})}var Sh=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&De(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var D_=10*1e3,bR=30*1e3,CR=5*60*1e3,Ah=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Sh(e);let r=D_+(bR-D_)*Math.random();Oi(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;De(e,(i,s)=>{s>0&&ut(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Oi(this.reportStats_.bind(this),Math.floor(Math.random()*2*CR))}};var It=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(It||{});function Iy(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Xh(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Zh(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var bh=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=It.ACK_USER_WRITE,this.source=Iy()}operationForChild(e){if(O(this.path)){if(this.affectedTree.value!=null)return _(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new W(e));return new t(q(),n,this.revert)}}else return _(x(this.path)===e,"operationForChild called for unrelated child."),new t(H(this.path),this.affectedTree,this.revert)}};var ra=class t{constructor(e,n){this.source=e,this.path=n,this.type=It.LISTEN_COMPLETE}operationForChild(e){return O(this.path)?new t(this.source,q()):new t(this.source,H(this.path))}};var Sr=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=It.OVERWRITE}operationForChild(e){return O(this.path)?new t(this.source,q(),this.snap.getImmediateChild(e)):new t(this.source,H(this.path),this.snap)}};var ia=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=It.MERGE}operationForChild(e){if(O(this.path)){let n=this.children.subtree(new W(e));return n.isEmpty()?null:n.value?new Sr(this.source,q(),n.value):new t(this.source,q(),n)}else return _(x(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,H(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var St=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(O(e))return this.isFullyInitialized()&&!this.filtered_;let n=x(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Ch=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function RR(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(IR(o.childName,o.snapshotNode))}),Di(t,i,"child_removed",e,r,n),Di(t,i,"child_added",e,r,n),Di(t,i,"child_moved",s,r,n),Di(t,i,"child_changed",e,r,n),Di(t,i,"value",e,r,n),i}function Di(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>NR(t,a,c)),o.forEach(a=>{let c=PR(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function PR(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function NR(t,e,n){if(e.childName==null||n.childName==null)throw In("Should only compare child_ events.");let r=new k(e.childName,e.snapshotNode),i=new k(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function pa(t,e){return{eventCache:t,serverCache:e}}function Mi(t,e,n,r){return pa(new St(e,n,r),t.serverCache)}function Sy(t,e,n,r){return pa(t.eventCache,new St(e,n,r))}function sa(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function zn(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Qu,kR=()=>(Qu||(Qu=new He(DC)),Qu),Oe=class t{constructor(e,n=kR()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return De(e,(r,i)=>{n=n.set(new W(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:q(),value:this.value};if(O(e))return null;{let r=x(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(H(e),n);return s!=null?{path:oe(new W(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(O(e))return this;{let n=x(e),r=this.children.get(n);return r!==null?r.subtree(H(e)):new t(null)}}set(e,n){if(O(e))return new t(n,this.children);{let r=x(e),s=(this.children.get(r)||new t(null)).set(H(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(O(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=x(e),r=this.children.get(n);if(r){let i=r.remove(H(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(O(e))return this.value;{let n=x(e),r=this.children.get(n);return r?r.get(H(e)):null}}setTree(e,n){if(O(e))return n;{let r=x(e),s=(this.children.get(r)||new t(null)).setTree(H(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(q(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(oe(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,q(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(O(e))return null;{let s=x(e),o=this.children.get(s);return o?o.findOnPath_(H(e),oe(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,q(),n)}foreachOnPath_(e,n,r){if(O(e))return this;{this.value&&r(n,this.value);let i=x(e),s=this.children.get(i);return s?s.foreachOnPath_(H(e),oe(n,i),r):new t(null)}}foreach(e){this.foreach_(q(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(oe(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var rt=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Oe(null))}};function Li(t,e,n){if(O(e))return new rt(new Oe(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Re(i,e);return s=s.updateChild(o,n),new rt(t.writeTree_.set(i,s))}else{let i=new Oe(n),s=t.writeTree_.setTree(e,i);return new rt(s)}}}function O_(t,e,n){let r=t;return De(n,(i,s)=>{r=Li(r,oe(e,i),s)}),r}function x_(t,e){if(O(e))return rt.empty();{let n=t.writeTree_.setTree(e,new Oe(null));return new rt(n)}}function Rh(t,e){return Wn(t,e)!=null}function Wn(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Re(n.path,e)):null}function M_(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ne,(r,i)=>{e.push(new k(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new k(r,i.value))}),e}function un(t,e){if(O(e))return t;{let n=Wn(t,e);return n!=null?new rt(new Oe(n)):new rt(t.writeTree_.subtree(e))}}function Ph(t){return t.writeTree_.isEmpty()}function Ar(t,e){return Ay(q(),t.writeTree_,e)}function Ay(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(_(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=Ay(oe(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(oe(t,".priority"),r)),n}}function ma(t,e){return Py(e,t)}function DR(t,e,n,r,i){_(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Li(t.visibleWrites,e,n)),t.lastWriteId=r}function OR(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function xR(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);_(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&MR(a,r.path)?i=!1:nt(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return LR(t),!0;if(r.snap)t.visibleWrites=x_(t.visibleWrites,r.path);else{let a=r.children;De(a,c=>{t.visibleWrites=x_(t.visibleWrites,oe(r.path,c))})}return!0}else return!1}function MR(t,e){if(t.snap)return nt(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&nt(oe(t.path,n),e))return!0;return!1}function LR(t){t.visibleWrites=by(t.allWrites,FR,q()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function FR(t){return t.visible}function by(t,e,n){let r=rt.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)nt(n,o)?(a=Re(n,o),r=Li(r,a,s.snap)):nt(o,n)&&(a=Re(o,n),r=Li(r,q(),s.snap.getChild(a)));else if(s.children){if(nt(n,o))a=Re(n,o),r=O_(r,a,s.children);else if(nt(o,n))if(a=Re(o,n),O(a))r=O_(r,q(),s.children);else{let c=Sn(s.children,x(a));if(c){let l=c.getChild(H(a));r=Li(r,q(),l)}}}else throw In("WriteRecord should have .snap or .children")}}return r}function Cy(t,e,n,r,i){if(!r&&!i){let s=Wn(t.visibleWrites,e);if(s!=null)return s;{let o=un(t.visibleWrites,e);if(Ph(o))return n;if(n==null&&!Rh(o,q()))return null;{let a=n||R.EMPTY_NODE;return Ar(o,a)}}}else{let s=un(t.visibleWrites,e);if(!i&&Ph(s))return n;if(!i&&n==null&&!Rh(s,q()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(nt(l.path,e)||nt(e,l.path))},a=by(t.allWrites,o,e),c=n||R.EMPTY_NODE;return Ar(a,c)}}}function VR(t,e,n){let r=R.EMPTY_NODE,i=Wn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ne,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=un(t.visibleWrites,e);return n.forEachChild(ne,(o,a)=>{let c=Ar(un(s,new W(o)),a);r=r.updateImmediateChild(o,c)}),M_(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=un(t.visibleWrites,e);return M_(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function UR(t,e,n,r,i){_(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=oe(e,n);if(Rh(t.visibleWrites,s))return null;{let o=un(t.visibleWrites,s);return Ph(o)?i.getChild(n):Ar(o,i.getChild(n))}}function BR(t,e,n,r){let i=oe(e,n),s=Wn(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=un(t.visibleWrites,i);return Ar(o,r.getNode().getImmediateChild(n))}else return null}function qR(t,e){return Wn(t.visibleWrites,e)}function $R(t,e,n,r,i,s,o){let a,c=un(t.visibleWrites,e),l=Wn(c,q());if(l!=null)a=l;else if(n!=null)a=Ar(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),p=d.getNext();for(;p&&u.length<i;)h(p,r)!==0&&u.push(p),p=d.getNext();return u}else return[]}function jR(){return{visibleWrites:rt.empty(),allWrites:[],lastWriteId:-1}}function oa(t,e,n,r){return Cy(t.writeTree,t.treePath,e,n,r)}function ed(t,e){return VR(t.writeTree,t.treePath,e)}function L_(t,e,n,r){return UR(t.writeTree,t.treePath,e,n,r)}function aa(t,e){return qR(t.writeTree,oe(t.treePath,e))}function zR(t,e,n,r,i,s){return $R(t.writeTree,t.treePath,e,n,r,i,s)}function td(t,e,n){return BR(t.writeTree,t.treePath,e,n)}function Ry(t,e){return Py(oe(t.treePath,e),t.writeTree)}function Py(t,e){return{treePath:t,writeTree:e}}var Nh=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;_(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),_(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Ui(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Vi(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Ir(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Ui(r,e.snapshotNode,i.oldSnap));else throw In("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var kh=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},Ny=new kh,qi=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new St(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return td(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:zn(this.viewCache_),s=zR(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function WR(t){return{filter:t}}function GR(t,e){_(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),_(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function KR(t,e,n,r,i){let s=new Nh,o,a;if(n.type===It.OVERWRITE){let l=n;l.source.fromUser?o=Dh(t,e,l.path,l.snap,r,i,s):(_(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!O(l.path),o=ca(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===It.MERGE){let l=n;l.source.fromUser?o=QR(t,e,l.path,l.children,r,i,s):(_(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Oh(t,e,l.path,l.children,r,i,a,s))}else if(n.type===It.ACK_USER_WRITE){let l=n;l.revert?o=XR(t,e,l.path,r,i,s):o=YR(t,e,l.path,l.affectedTree,r,i,s)}else if(n.type===It.LISTEN_COMPLETE)o=JR(t,e,n.path,r,s);else throw In("Unknown operation type: "+n.type);let c=s.getChanges();return HR(e,o,c),{viewCache:o,changes:c}}function HR(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=sa(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(wy(sa(e)))}}function ky(t,e,n,r,i,s){let o=e.eventCache;if(aa(r,n)!=null)return e;{let a,c;if(O(n))if(_(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=zn(e),u=l instanceof R?l:R.EMPTY_NODE,h=ed(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=oa(r,zn(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=x(n);if(l===".priority"){_(dn(n)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let h=L_(r,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{let u=H(n),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let d=L_(r,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=td(r,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,i,s):a=o.getNode()}}return Mi(e,a,o.isFullyInitialized()||O(n),t.filter.filtersNodes())}}function ca(t,e,n,r,i,s,o,a){let c=e.serverCache,l,u=o?t.filter:t.filter.getIndexedFilter();if(O(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){let p=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),p,null)}else{let p=x(n);if(!c.isCompleteForPath(n)&&dn(n)>1)return e;let f=H(n),v=c.getNode().getImmediateChild(p).updateChild(f,r);p===".priority"?l=u.updatePriority(c.getNode(),v):l=u.updateChild(c.getNode(),p,v,f,Ny,null)}let h=Sy(e,l,c.isFullyInitialized()||O(n),u.filtersNodes()),d=new qi(i,h,s);return ky(t,h,n,i,d,a)}function Dh(t,e,n,r,i,s,o){let a=e.eventCache,c,l,u=new qi(i,e,s);if(O(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Mi(e,l,!0,t.filter.filtersNodes());else{let h=x(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=Mi(e,l,a.isFullyInitialized(),a.isFiltered());else{let d=H(n),p=a.getNode().getImmediateChild(h),f;if(O(d))f=r;else{let g=u.getCompleteChild(h);g!=null?dy(d)===".priority"&&g.getChild(py(d)).isEmpty()?f=g:f=g.updateChild(d,r):f=R.EMPTY_NODE}if(p.equals(f))c=e;else{let g=t.filter.updateChild(a.getNode(),h,f,d,u,o);c=Mi(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function F_(t,e){return t.eventCache.isCompleteForChild(e)}function QR(t,e,n,r,i,s,o){let a=e;return r.foreach((c,l)=>{let u=oe(n,c);F_(e,x(u))&&(a=Dh(t,a,u,l,i,s,o))}),r.foreach((c,l)=>{let u=oe(n,c);F_(e,x(u))||(a=Dh(t,a,u,l,i,s,o))}),a}function V_(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Oh(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;O(n)?l=r:l=new Oe(null).setTree(n,r);let u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){let p=e.serverCache.getNode().getImmediateChild(h),f=V_(t,p,d);c=ca(t,c,new W(h),f,i,s,o,a)}}),l.children.inorderTraversal((h,d)=>{let p=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!p){let f=e.serverCache.getNode().getImmediateChild(h),g=V_(t,f,d);c=ca(t,c,new W(h),g,i,s,o,a)}}),c}function YR(t,e,n,r,i,s,o){if(aa(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(O(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return ca(t,e,n,c.getNode().getChild(n),i,s,a,o);if(O(n)){let l=new Oe(null);return c.getNode().forEachChild(yr,(u,h)=>{l=l.set(new W(u),h)}),Oh(t,e,n,l,i,s,a,o)}else return e}else{let l=new Oe(null);return r.foreach((u,h)=>{let d=oe(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),Oh(t,e,n,l,i,s,a,o)}}function JR(t,e,n,r,i){let s=e.serverCache,o=Sy(e,s.getNode(),s.isFullyInitialized()||O(n),s.isFiltered());return ky(t,o,n,r,Ny,i)}function XR(t,e,n,r,i,s){let o;if(aa(r,n)!=null)return e;{let a=new qi(r,e,i),c=e.eventCache.getNode(),l;if(O(n)||x(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=oa(r,zn(e));else{let h=e.serverCache.getNode();_(h instanceof R,"serverChildren would be complete if leaf node"),u=ed(r,h)}u=u,l=t.filter.updateFullNode(c,u,s)}else{let u=x(n),h=td(r,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,H(n),a,s):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,R.EMPTY_NODE,H(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=oa(r,zn(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||aa(r,q())!=null,Mi(e,l,o,t.filter.filtersNodes())}}var xh=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Bi(r.getIndex()),s=SR(r);this.processor_=WR(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(R.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(R.EMPTY_NODE,a.getNode(),null),u=new St(c,o.isFullyInitialized(),i.filtersNodes()),h=new St(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=pa(h,u),this.eventGenerator_=new Ch(this.query_)}get query(){return this.query_}};function ZR(t){return t.viewCache_.serverCache.getNode()}function e0(t){return sa(t.viewCache_)}function t0(t,e){let n=zn(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!O(e)&&!n.getImmediateChild(x(e)).isEmpty())?n.getChild(e):null}function U_(t){return t.eventRegistrations_.length===0}function n0(t,e){t.eventRegistrations_.push(e)}function B_(t,e,n){let r=[];if(n){_(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function q_(t,e,n,r){e.type===It.MERGE&&e.source.queryId!==null&&(_(zn(t.viewCache_),"We should always have a full cache before handling merges"),_(sa(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=KR(t.processor_,i,e,n,r);return GR(t.processor_,s.viewCache),_(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Dy(t,s.changes,s.viewCache.eventCache.getNode(),null)}function r0(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ne,(s,o)=>{r.push(Ir(s,o))}),n.isFullyInitialized()&&r.push(wy(n.getNode())),Dy(t,r,n.getNode(),e)}function Dy(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return RR(t.eventGenerator_,e,n,i)}var la,ua=class{constructor(){this.views=new Map}};function i0(t){_(!la,"__referenceConstructor has already been defined"),la=t}function s0(){return _(la,"Reference.ts has not been loaded"),la}function o0(t){return t.views.size===0}function nd(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return _(s!=null,"SyncTree gave us an op for an invalid query."),q_(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(q_(o,e,n,r));return s}}function Oy(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=oa(n,i?r:null),c=!1;a?c=!0:r instanceof R?(a=ed(n,r),c=!1):(a=R.EMPTY_NODE,c=!1);let l=pa(new St(a,c,!1),new St(r,i,!1));return new xh(e,l)}return o}function a0(t,e,n,r,i,s){let o=Oy(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),n0(o,n),r0(o,n)}function c0(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=fn(t);if(i==="default")for(let[c,l]of t.views.entries())o=o.concat(B_(l,n,r)),U_(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=t.views.get(i);c&&(o=o.concat(B_(c,n,r)),U_(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!fn(t)&&s.push(new(s0())(e._repo,e._path)),{removed:s,events:o}}function xy(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function hn(t,e){let n=null;for(let r of t.views.values())n=n||t0(r,e);return n}function My(t,e){if(e._queryParams.loadsAllData())return ga(t);{let r=e._queryIdentifier;return t.views.get(r)}}function Ly(t,e){return My(t,e)!=null}function fn(t){return ga(t)!=null}function ga(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var ha;function l0(t){_(!ha,"__referenceConstructor has already been defined"),ha=t}function u0(){return _(ha,"Reference.ts has not been loaded"),ha}var h0=1,da=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Oe(null),this.pendingWriteTree_=jR(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Fy(t,e,n,r,i){return DR(t.pendingWriteTree_,e,n,r,i),i?Qi(t,new Sr(Iy(),e,n)):[]}function qn(t,e,n=!1){let r=OR(t.pendingWriteTree_,e);if(xR(t.pendingWriteTree_,e)){let s=new Oe(null);return r.snap!=null?s=s.set(q(),!0):De(r.children,o=>{s=s.set(new W(o),!0)}),Qi(t,new bh(r.path,s,n))}else return[]}function Hi(t,e,n){return Qi(t,new Sr(Xh(),e,n))}function d0(t,e,n){let r=Oe.fromObject(n);return Qi(t,new ia(Xh(),e,r))}function f0(t,e){return Qi(t,new ra(Xh(),e))}function p0(t,e,n){let r=id(t,n);if(r){let i=sd(r),s=i.path,o=i.queryId,a=Re(s,e),c=new ra(Zh(o),a);return od(t,s,c)}else return[]}function Vy(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||Ly(o,e))){let c=c0(o,e,n,r);o0(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let u=l.findIndex(d=>d._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(s,(d,p)=>fn(p));if(u&&!h){let d=t.syncPointTree_.subtree(s);if(!d.isEmpty()){let p=y0(d);for(let f=0;f<p.length;++f){let g=p[f],v=g.query,I=$y(t,g);t.listenProvider_.startListening(Fi(v),$i(t,v),I.hashFn,I.onComplete)}}}!h&&l.length>0&&!r&&(u?t.listenProvider_.stopListening(Fi(e),null):l.forEach(d=>{let p=t.queryToTagMap.get(_a(d));t.listenProvider_.stopListening(Fi(d),p)}))}v0(t,l)}return a}function Uy(t,e,n,r){let i=id(t,r);if(i!=null){let s=sd(i),o=s.path,a=s.queryId,c=Re(o,e),l=new Sr(Zh(a),c,n);return od(t,o,l)}else return[]}function m0(t,e,n,r){let i=id(t,r);if(i){let s=sd(i),o=s.path,a=s.queryId,c=Re(o,e),l=Oe.fromObject(n),u=new ia(Zh(a),c,l);return od(t,o,u)}else return[]}function g0(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,p)=>{let f=Re(d,i);s=s||hn(p,f),o=o||fn(p)});let a=t.syncPointTree_.get(i);a?(o=o||fn(a),s=s||hn(a,q())):(a=new ua,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=R.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((p,f)=>{let g=hn(f,q());g&&(s=s.updateImmediateChild(p,g))}));let l=Ly(a,e);if(!l&&!e._queryParams.loadsAllData()){let d=_a(e);_(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");let p=E0();t.queryToTagMap.set(d,p),t.tagToQueryMap.set(p,d)}let u=ma(t.pendingWriteTree_,i),h=a0(a,e,n,u,s,c);if(!l&&!o&&!r){let d=My(a,e);h=h.concat(w0(t,e,d))}return h}function rd(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=Re(o,e),l=hn(a,c);if(l)return l});return Cy(i,e,s,n,!0)}function _0(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{let h=Re(l,n);r=r||hn(u,h)});let i=t.syncPointTree_.get(n);i?r=r||hn(i,q()):(i=new ua,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new St(r,!0,!1):null,a=ma(t.pendingWriteTree_,e._path),c=Oy(i,e,a,s?o.getNode():R.EMPTY_NODE,s);return e0(c)}function Qi(t,e){return By(e,t.syncPointTree_,null,ma(t.pendingWriteTree_,q()))}function By(t,e,n,r){if(O(t.path))return qy(t,e,n,r);{let i=e.get(q());n==null&&i!=null&&(n=hn(i,q()));let s=[],o=x(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let l=n?n.getImmediateChild(o):null,u=Ry(r,o);s=s.concat(By(a,c,l,u))}return i&&(s=s.concat(nd(i,t,r,n))),s}}function qy(t,e,n,r){let i=e.get(q());n==null&&i!=null&&(n=hn(i,q()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,l=Ry(r,o),u=t.operationForChild(o);u&&(s=s.concat(qy(u,a,c,l)))}),i&&(s=s.concat(nd(i,t,r,n))),s}function $y(t,e){let n=e.query,r=$i(t,n);return{hashFn:()=>(ZR(e)||R.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?p0(t,n._path,r):f0(t,n._path);{let s=MC(i,n);return Vy(t,n,null,s)}}}}function $i(t,e){let n=_a(e);return t.queryToTagMap.get(n)}function _a(t){return t._path.toString()+"$"+t._queryIdentifier}function id(t,e){return t.tagToQueryMap.get(e)}function sd(t){let e=t.indexOf("$");return _(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new W(t.substr(0,e))}}function od(t,e,n){let r=t.syncPointTree_.get(e);_(r,"Missing sync point for query tag that we're tracking");let i=ma(t.pendingWriteTree_,e);return nd(r,n,i,null)}function y0(t){return t.fold((e,n,r)=>{if(n&&fn(n))return[ga(n)];{let i=[];return n&&(i=xy(n)),De(r,(s,o)=>{i=i.concat(o)}),i}})}function Fi(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(u0())(t._repo,t._path):t}function v0(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=_a(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function E0(){return h0++}function w0(t,e,n){let r=e._path,i=$i(t,e),s=$y(t,n),o=t.listenProvider_.startListening(Fi(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)_(!fn(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,h)=>{if(!O(l)&&u&&fn(u))return[ga(u).query];{let d=[];return u&&(d=d.concat(xy(u).map(p=>p.query))),De(h,(p,f)=>{d=d.concat(f)}),d}});for(let l=0;l<c.length;++l){let u=c[l];t.listenProvider_.stopListening(Fi(u),$i(t,u))}}return o}var Mh=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},Lh=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=oe(this.path_,e);return new t(this.syncTree_,n)}node(){return rd(this.syncTree_,this.path_)}},T0=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},$_=function(t,e,n){if(!t||typeof t!="object")return t;if(_(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return I0(t[".sv"],e,n);if(typeof t[".sv"]=="object")return S0(t[".sv"],e);_(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},I0=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:_(!1,"Unexpected server value: "+t)}},S0=function(t,e,n){t.hasOwnProperty("increment")||_(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&_(!1,"Unexpected increment value: "+r);let i=e.node();if(_(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},A0=function(t,e,n,r){return ad(e,new Lh(n,t),r)},jy=function(t,e,n){return ad(t,new Mh(e),n)};function ad(t,e,n){let r=t.getPriority().val(),i=$_(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=$_(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new wr(a,fe(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new wr(i))),o.forEachChild(ne,(a,c)=>{let l=ad(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var ji=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function cd(t,e){let n=e instanceof W?e:new W(e),r=t,i=x(n);for(;i!==null;){let s=Sn(r.node.children,i)||{children:{},childCount:0};r=new ji(i,r,s),n=H(n),i=x(n)}return r}function Rr(t){return t.node.value}function zy(t,e){t.node.value=e,Fh(t)}function Wy(t){return t.node.childCount>0}function b0(t){return Rr(t)===void 0&&!Wy(t)}function ya(t,e){De(t.node.children,(n,r)=>{e(new ji(n,t,r))})}function Gy(t,e,n,r){n&&!r&&e(t),ya(t,i=>{Gy(i,e,!0,r)}),n&&r&&e(t)}function C0(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Yi(t){return new W(t.parent===null?t.name:Yi(t.parent)+"/"+t.name)}function Fh(t){t.parent!==null&&R0(t.parent,t.name,t)}function R0(t,e,n){let r=b0(n),i=ut(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Fh(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,Fh(t))}var P0=/[\[\].#$\/\u0000-\u001F\u007F]/,N0=/[\[\].#$\u0000-\u001F\u007F]/,Yu=10*1024*1024,Ky=function(t){return typeof t=="string"&&t.length!==0&&!P0.test(t)},Hy=function(t){return typeof t=="string"&&t.length!==0&&!N0.test(t)},k0=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Hy(t)};var D0=function(t,e,n,r){r&&e===void 0||ld(Bs(t,"value"),e,n)},ld=function(t,e,n){let r=n instanceof W?new uh(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Un(r));if(typeof e=="function")throw new Error(t+"contains a function "+Un(r)+" with contents = "+e.toString());if(H_(e))throw new Error(t+"contains "+e.toString()+" "+Un(r));if(typeof e=="string"&&e.length>Yu/3&&Gr(e)>Yu)throw new Error(t+"contains a string greater than "+Yu+" utf8 bytes "+Un(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(De(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Ky(o)))throw new Error(t+" contains an invalid key ("+o+") "+Un(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);uR(r,o),ld(t,a,r),hR(r)}),i&&s)throw new Error(t+' contains ".value" child '+Un(r)+" in addition to actual children.")}};var Qy=function(t,e,n,r){if(!(r&&n===void 0)&&!Hy(n))throw new Error(Bs(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},O0=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Qy(t,e,n,r)},x0=function(t,e){if(x(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},M0=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ky(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!k0(n))throw new Error(Bs(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Vh=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Yy(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!my(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function At(t,e,n){Yy(t,n),L0(t,r=>nt(r,e)||nt(e,r))}function L0(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(F0(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function F0(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();$n&&Ie("event: "+n.toString()),Cr(r)}}}var V0="repo_interrupt",U0=25,Uh=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Vh,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=na(),this.transactionQueueTree_=new ji,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function B0(t,e,n){if(t.stats_=Qh(t.repoInfo_),t.forceRestClient_||UC())t.server_=new wh(t.repoInfo_,(r,i,s,o)=>{j_(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>z_(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{re(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Yh(t.repoInfo_,e,(r,i,s,o)=>{j_(t,r,i,s,o)},r=>{z_(t,r)},r=>{$0(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=qC(t.repoInfo_,()=>new Ah(t.stats_,t.server_)),t.infoData_=new Th,t.infoSyncTree_=new da({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Hi(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),hd(t,"connected",!1),t.serverSyncTree_=new da({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);At(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function q0(t){let n=t.infoData_.getNode(new W(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function ud(t){return T0({timestamp:q0(t)})}function j_(t,e,n,r,i){t.dataUpdateCount++;let s=new W(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=Wr(n,l=>fe(l));o=m0(t.serverSyncTree_,s,c,i)}else{let c=fe(n);o=Uy(t.serverSyncTree_,s,c,i)}else if(r){let c=Wr(n,l=>fe(l));o=d0(t.serverSyncTree_,s,c)}else{let c=fe(n);o=Hi(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Ea(t,s)),At(t.eventQueue_,a,o)}function z_(t,e){hd(t,"connected",e),e===!1&&W0(t)}function $0(t,e){De(e,(n,r)=>{hd(t,n,r)})}function hd(t,e,n){let r=new W("/.info/"+e),i=fe(n);t.infoData_.updateSnapshot(r,i);let s=Hi(t.infoSyncTree_,r,i);At(t.eventQueue_,r,s)}function Jy(t){return t.nextWriteId_++}function j0(t,e,n){let r=_0(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=fe(i).withIndex(e._queryParams.getIndex());g0(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Hi(t.serverSyncTree_,e._path,s);else{let a=$i(t.serverSyncTree_,e);o=Uy(t.serverSyncTree_,e._path,s,a)}return At(t.eventQueue_,e._path,o),Vy(t.serverSyncTree_,e,n,null,!0),s},i=>(va(t,"get for query "+re(e)+" failed: "+i),Promise.reject(new Error(i))))}function z0(t,e,n,r,i){va(t,"set",{path:e.toString(),value:n,priority:r});let s=ud(t),o=fe(n,r),a=rd(t.serverSyncTree_,e),c=jy(o,a,s),l=Jy(t),u=Fy(t.serverSyncTree_,e,c,l,!0);Yy(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,p)=>{let f=d==="ok";f||ke("set at "+e+" failed: "+d);let g=qn(t.serverSyncTree_,l,!f);At(t.eventQueue_,e,g),K0(t,i,d,p)});let h=nv(t,e);Ea(t,h),At(t.eventQueue_,h,[])}function W0(t){va(t,"onDisconnectEvents");let e=ud(t),n=na();Ih(t.onDisconnect_,q(),(i,s)=>{let o=A0(i,s,t.serverSyncTree_,e);Ty(n,i,o)});let r=[];Ih(n,q(),(i,s)=>{r=r.concat(Hi(t.serverSyncTree_,i,s));let o=nv(t,i);Ea(t,o)}),t.onDisconnect_=na(),At(t.eventQueue_,q(),r)}function G0(t){t.persistentConnection_&&t.persistentConnection_.interrupt(V0)}function va(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ie(n,...e)}function K0(t,e,n,r){e&&Cr(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function Xy(t,e,n){return rd(t.serverSyncTree_,e,n)||R.EMPTY_NODE}function dd(t,e=t.transactionQueueTree_){if(e||wa(t,e),Rr(e)){let n=ev(t,e);_(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&H0(t,Yi(e),n)}else Wy(e)&&ya(e,n=>{dd(t,n)})}function H0(t,e,n){let r=n.map(l=>l.currentWriteId),i=Xy(t,e,r),s=i,o=i.hash();for(let l=0;l<n.length;l++){let u=n[l];_(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let h=Re(e,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{va(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(qn(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();wa(t,cd(t.transactionQueueTree_,e)),dd(t,t.transactionQueueTree_),At(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Cr(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{ke("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}Ea(t,e)}},o)}function Ea(t,e){let n=Zy(t,e),r=Yi(n),i=ev(t,n);return Q0(t,i,r),r}function Q0(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=Re(n,c.path),u=!1,h;if(_(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,i=i.concat(qn(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=U0)u=!0,h="maxretry",i=i.concat(qn(t.serverSyncTree_,c.currentWriteId,!0));else{let d=Xy(t,c.path,o);c.currentInputSnapshot=d;let p=e[a].update(d.val());if(p!==void 0){ld("transaction failed: Data returned ",p,c.path);let f=fe(p);typeof p=="object"&&p!=null&&ut(p,".priority")||(f=f.updatePriority(d.getPriority()));let v=c.currentWriteId,I=ud(t),P=jy(f,d,I);c.currentOutputSnapshotRaw=f,c.currentOutputSnapshotResolved=P,c.currentWriteId=Jy(t),o.splice(o.indexOf(v),1),i=i.concat(Fy(t.serverSyncTree_,c.path,P,c.currentWriteId,c.applyLocally)),i=i.concat(qn(t.serverSyncTree_,v,!0))}else u=!0,h="nodata",i=i.concat(qn(t.serverSyncTree_,c.currentWriteId,!0))}At(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}wa(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Cr(r[a]);dd(t,t.transactionQueueTree_)}function Zy(t,e){let n,r=t.transactionQueueTree_;for(n=x(e);n!==null&&Rr(r)===void 0;)r=cd(r,n),e=H(e),n=x(e);return r}function ev(t,e){let n=[];return tv(t,e,n),n.sort((r,i)=>r.order-i.order),n}function tv(t,e,n){let r=Rr(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);ya(e,i=>{tv(t,i,n)})}function wa(t,e){let n=Rr(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,zy(e,n.length>0?n:void 0)}ya(e,r=>{wa(t,r)})}function nv(t,e){let n=Yi(Zy(t,e)),r=cd(t.transactionQueueTree_,e);return C0(r,i=>{Ju(t,i)}),Ju(t,r),Gy(r,i=>{Ju(t,i)}),n}function Ju(t,e){let n=Rr(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(_(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(_(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(qn(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?zy(e,void 0):n.length=s+1,At(t.eventQueue_,Yi(e),i);for(let o=0;o<r.length;o++)Cr(r[o])}}function Y0(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function J0(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ke(`Invalid query segment '${n}' in query '${t}'`)}return e}var W_=function(t,e){let n=X0(t),r=n.namespace;n.domain==="firebase.com"&&qt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&qt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||NC();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Ho(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new W(n.pathString)}},X0=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(i=Y0(t.substring(u,h)));let d=J0(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let p=e.slice(0,l);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{let f=e.indexOf(".");r=e.substring(0,f).toLowerCase(),n=e.substring(f+1),s=r}"ns"in d&&(s=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var Bh=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+re(this.snapshot.exportVal())}},qh=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var $h=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return _(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var jh=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return O(this._path)?null:dy(this._path)}get ref(){return new $t(this._repo,this._path)}get _queryIdentifier(){let e=k_(this._queryParams),n=Hh(e);return n==="{}"?"default":n}get _queryObject(){return k_(this._queryParams)}isEqual(e){if(e=pe(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=my(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+lR(this._path)}};var $t=class t extends jh{constructor(e,n){super(e,n,new Eh,!1)}get parent(){let e=py(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},fa=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new W(e),r=zi(this.ref,e);return new t(this._node.getChild(n),r,ne)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,zi(this.ref,r),ne)))}hasChild(e){let n=new W(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function rv(t,e){return t=pe(t),t._checkNotDeleted("ref"),e!==void 0?zi(t._root,e):t._root}function zi(t,e){return t=pe(t),x(t._path)===null?O0("child","path",e,!1):Qy("child","path",e,!1),new $t(t._repo,oe(t._path,e))}function iv(t,e){t=pe(t),x0("set",t._path),D0("set",e,t._path,!1);let n=new Zt;return z0(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function sv(t){t=pe(t);let e=new $h(()=>{}),n=new zh(e);return j0(t._repo,t,n).then(r=>new fa(r,new $t(t._repo,t._path),t._queryParams.getIndex()))}var zh=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Bh("value",this,new fa(e.snapshotNode,new $t(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new qh(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}};i0($t);l0($t);var Z0="FIREBASE_DATABASE_EMULATOR_HOST",Wh={},eP=!1;function tP(t,e,n,r){t.repoInfo_=new Ho(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function nP(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||qt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ie("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=W_(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[Z0]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=W_(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let u=i&&c?new xi(xi.OWNER):new rh(t.name,t.options,e);M0("Invalid Firebase Database URL",o),O(o.path)||qt("Database URL must point to the root of a Firebase Database (not including a child path).");let h=iP(a,t,u,new nh(t.name,n));return new Gh(h,t)}function rP(t,e){let n=Wh[e];(!n||n[t.key]!==t)&&qt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),G0(t),delete n[t.key]}function iP(t,e,n,r){let i=Wh[e.name];i||(i={},Wh[e.name]=i);let s=i[t.toURLString()];return s&&qt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Uh(t,eP,n,r),i[t.toURLString()]=s,s}var Gh=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(B0(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new $t(this._repo,q())),this._rootInternal}_delete(){return this._rootInternal!==null&&(rP(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&qt("Cannot call "+e+" on a deleted database.")}};function ov(t=ft(),e){let n=Nt(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){let r=Zn("database");r&&av(n,...r)}return n}function av(t,e,n,r={}){t=pe(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&qt("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&qt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new xi(xi.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:er(r.mockUserToken,t.app.options.projectId);s=new xi(o)}tP(i,e,n,s)}function sP(t){CC(Ge),We(new Ee("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return nP(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),j(p_,m_,t),j(p_,m_,"esm2017")}Yh.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Yh.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};sP();var Ji=class{constructor(e){return e}},cv="database",fd=class{constructor(){return Dt(cv)}};var pd=new Z("angularfire2.database-instances");function oP(t,e){let n=tn(cv,t,e);return n&&new Ji(n)}function aP(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Ji(r)}}var cP={provide:fd,deps:[[new ee,pd]]},lP={provide:Ji,useFactory:oP,deps:[[new ee,pd],Ue]},uP=(()=>{class t{constructor(){j("angularfire",Je.full,"rtdb")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Le({type:t});static \u0275inj=Me({providers:[lP,cP]})}return t})();function lv(t,...e){return{ngModule:uP,providers:[{provide:pd,useFactory:aP(t),multi:!0,deps:[ve,ot,mt,Xe,[new ee,Mt],[new ee,pt],...e]}]}}var Xi=Pe(zi,!0);var Zi=Pe(sv,!0),Pr=Pe(ov,!0);var jt=Pe(rv,!0);var es=Pe(iv,!0);var uv=Zd([Op(()=>xp(Mp.firebaseConfig)),Sm(()=>Am()),Zg(()=>e_()),d_(()=>f_()),lv(()=>Pr())]);var fP={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},Ta="__@ngrx/effects_create__";function pn(t,e={}){let n=e.functional?t:t(),r=Q(Q({},fP),e);return Object.defineProperty(n,Ta,{value:r}),n}function pP(t){return Object.getOwnPropertyNames(t).filter(r=>t[r]&&t[r].hasOwnProperty(Ta)?t[r][Ta].hasOwnProperty("dispatch"):!1).map(r=>{let i=t[r][Ta];return Q({propertyName:r},i)})}function mP(t){return pP(t)}function hv(t){return Object.getPrototypeOf(t)}function gP(t){return!!t.constructor&&t.constructor.name!=="Object"&&t.constructor.name!=="Function"}function dv(t){return typeof t=="function"}function _P(t){return t.filter(dv)}function yP(t,e,n){let r=hv(t),s=!!r&&r.constructor.name!=="Object"?r.constructor.name:null,o=mP(t).map(({propertyName:a,dispatch:c,useEffectsErrorHandler:l})=>{let u=typeof t[a]=="function"?t[a]():t[a],h=l?n(u,e):u;return c===!1?h.pipe(Wd()):h.pipe(Kd()).pipe(ie(p=>({effect:t[a],notification:p,propertyName:a,sourceName:s,sourceInstance:t})))});return Gn(...o)}var vP=10;function fv(t,e,n=vP){return t.pipe(Qe(r=>(e&&e.handleError(r),n<=1?t:fv(t,e,n-1))))}var Nr=(()=>{let e=class e extends Kt{constructor(r){super(),r&&(this.source=r)}lift(r){let i=new e;return i.source=this,i.operator=r,i}};e.\u0275fac=function(i){return new(i||e)(G(hs))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function mn(...t){return st(e=>t.some(n=>typeof n=="string"?n===e.type:n.type===e.type))}var OM=new Z("@ngrx/effects Internal Root Guard"),xM=new Z("@ngrx/effects User Provided Effects"),MM=new Z("@ngrx/effects Internal Root Effects"),LM=new Z("@ngrx/effects Internal Root Effects Instances"),FM=new Z("@ngrx/effects Internal Feature Effects"),VM=new Z("@ngrx/effects Internal Feature Effects Instance Groups"),EP=new Z("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>fv}),wP="@ngrx/effects/init",TP=wf(wP);function IP(t,e){if(t.notification.kind==="N"){let n=t.notification.value;!SP(n)&&e.handleError(new Error(`Effect ${AP(t)} dispatched an invalid action: ${bP(n)}`))}}function SP(t){return typeof t!="function"&&t&&t.type&&typeof t.type=="string"}function AP({propertyName:t,sourceInstance:e,sourceName:n}){let r=typeof e[t]=="function";return!!n?`"${n}.${String(t)}${r?"()":""}"`:`"${String(t)}()"`}function bP(t){try{return JSON.stringify(t)}catch{return t}}var CP="ngrxOnIdentifyEffects";function RP(t){return md(t,CP)}var PP="ngrxOnRunEffects";function NP(t){return md(t,PP)}var kP="ngrxOnInitEffects";function DP(t){return md(t,kP)}function md(t,e){return t&&e in t&&typeof t[e]=="function"}var pv=(()=>{let e=class e extends Bd{constructor(r,i){super(),this.errorHandler=r,this.effectsErrorHandler=i}addEffects(r){this.next(r)}toActions(){return this.pipe(xa(r=>gP(r)?hv(r):r),Oa(r=>r.pipe(xa(OP))),Oa(r=>{let i=r.pipe(Qt(o=>xP(this.errorHandler,this.effectsErrorHandler)(o)),ie(o=>(IP(o,this.errorHandler),o.notification)),st(o=>o.kind==="N"&&o.value!=null),Gd()),s=r.pipe(ss(1),st(DP),ie(o=>o.ngrxOnInitEffects()));return Gn(i,s)}))}};e.\u0275fac=function(i){return new(i||e)(G(ls),G(EP))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function OP(t){return RP(t)?t.ngrxOnIdentifyEffects():""}function xP(t,e){return n=>{let r=yP(n,t,e);return NP(n)?n.ngrxOnRunEffects(r):r}}var MP=(()=>{let e=class e{get isStarted(){return!!this.effectsSubscription}constructor(r,i){this.effectSources=r,this.store=i,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}};e.\u0275fac=function(i){return new(i||e)(G(pv),G(Yt))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function mv(...t){let e=t.flat(),n=_P(e);return cs([n,{provide:Jd,multi:!0,useValue:()=>{K(If),K(Sf,{optional:!0});let r=K(MP),i=K(pv),s=!r.isStarted;s&&r.start();for(let o of e){let a=dv(o)?K(o):o;i.addEffects(a)}s&&K(Yt).dispatch(TP())}}])}var ns="PERFORM_ACTION",LP="REFRESH",wv="RESET",Tv="ROLLBACK",Iv="COMMIT",Sv="SWEEP",Av="TOGGLE_ACTION",FP="SET_ACTIONS_ACTIVE",bv="JUMP_TO_STATE",Cv="JUMP_TO_ACTION",Rd="IMPORT_STATE",Rv="LOCK_CHANGES",Pv="PAUSE_RECORDING",kr=class{constructor(e,n){if(this.action=e,this.timestamp=n,this.type=ns,typeof e.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}},gd=class{constructor(){this.type=LP}},_d=class{constructor(e){this.timestamp=e,this.type=wv}},yd=class{constructor(e){this.timestamp=e,this.type=Tv}},vd=class{constructor(e){this.timestamp=e,this.type=Iv}},Ed=class{constructor(){this.type=Sv}},wd=class{constructor(e){this.id=e,this.type=Av}};var Td=class{constructor(e){this.index=e,this.type=bv}},Id=class{constructor(e){this.actionId=e,this.type=Cv}},Sd=class{constructor(e){this.nextLiftedState=e,this.type=Rd}},Ad=class{constructor(e){this.status=e,this.type=Rv}},bd=class{constructor(e){this.status=e,this.type=Pv}};var ba=new Z("@ngrx/store-devtools Options"),gv=new Z("@ngrx/store-devtools Initial Config");function Nv(){return null}var VP="NgRx Store DevTools";function UP(t){let e={maxAge:!1,monitor:Nv,actionSanitizer:void 0,stateSanitizer:void 0,name:VP,serialize:!1,logOnly:!1,autoPause:!1,trace:!1,traceLimit:75,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0},connectInZone:!1},n=typeof t=="function"?t():t,r=n.logOnly?{pause:!0,export:!0,test:!0}:!1,i=n.features||r||e.features;i.import===!0&&(i.import="custom");let s=Object.assign({},e,{features:i},n);if(s.maxAge&&s.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${s.maxAge}`);return s}function _v(t,e){return t.filter(n=>e.indexOf(n)<0)}function kv(t){let{computedStates:e,currentStateIndex:n}=t;if(n>=e.length){let{state:i}=e[e.length-1];return i}let{state:r}=e[n];return r}function ts(t){return new kr(t,+Date.now())}function BP(t,e){return Object.keys(e).reduce((n,r)=>{let i=Number(r);return n[i]=Dv(t,e[i],i),n},{})}function Dv(t,e,n){return ce(Q({},e),{action:t(e.action,n)})}function qP(t,e){return e.map((n,r)=>({state:Ov(t,n.state,r),error:n.error}))}function Ov(t,e,n){return t(e,n)}function xv(t){return t.predicate||t.actionsSafelist||t.actionsBlocklist}function $P(t,e,n,r){let i=[],s={},o=[];return t.stagedActionIds.forEach((a,c)=>{let l=t.actionsById[a];l&&(c&&Pd(t.computedStates[c],l,e,n,r)||(s[a]=l,i.push(a),o.push(t.computedStates[c])))}),ce(Q({},t),{stagedActionIds:i,actionsById:s,computedStates:o})}function Pd(t,e,n,r,i){let s=n&&!n(t,e.action),o=r&&!e.action.type.match(r.map(c=>yv(c)).join("|")),a=i&&e.action.type.match(i.map(c=>yv(c)).join("|"));return s||o||a}function yv(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Mv(t){return{ngZone:t?K(ve):null,connectInZone:t}}var Ca=(()=>{let e=class e extends us{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ef(e)))(s||e)}})(),e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})(),Ia={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},Cd=new Z("@ngrx/store-devtools Redux Devtools Extension"),Lv=(()=>{let e=class e{constructor(r,i,s){this.config=i,this.dispatcher=s,this.zoneConfig=Mv(this.config.connectInZone),this.devtoolsExtension=r,this.createActionStreams()}notify(r,i){if(this.devtoolsExtension)if(r.type===ns){if(i.isLocked||i.isPaused)return;let s=kv(i);if(xv(this.config)&&Pd(s,r,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;let o=this.config.stateSanitizer?Ov(this.config.stateSanitizer,s,i.currentStateIndex):s,a=this.config.actionSanitizer?Dv(this.config.actionSanitizer,r,i.nextActionId):r;this.sendToReduxDevtools(()=>this.extensionConnection.send(a,o))}else{let s=ce(Q({},i),{stagedActionIds:i.stagedActionIds,actionsById:this.config.actionSanitizer?BP(this.config.actionSanitizer,i.actionsById):i.actionsById,computedStates:this.config.stateSanitizer?qP(this.config.stateSanitizer,i.computedStates):i.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,s,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new Kt(r=>{let i=this.zoneConfig.connectInZone?this.zoneConfig.ngZone.runOutsideAngular(()=>this.devtoolsExtension.connect(this.getExtensionConfig(this.config))):this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=i,i.init(),i.subscribe(s=>r.next(s)),i.unsubscribe}):bt}createActionStreams(){let r=this.createChangesObservable().pipe(Qd()),i=r.pipe(st(u=>u.type===Ia.START)),s=r.pipe(st(u=>u.type===Ia.STOP)),o=r.pipe(st(u=>u.type===Ia.DISPATCH),ie(u=>this.unwrapAction(u.payload)),Or(u=>u.type===Rd?this.dispatcher.pipe(st(h=>h.type===Va),jd(1e3),zd(1e3),ie(()=>u),Qe(()=>Ht(u)),ss(1)):Ht(u))),c=r.pipe(st(u=>u.type===Ia.ACTION),ie(u=>this.unwrapAction(u.payload))).pipe(os(s)),l=o.pipe(os(s));this.start$=i.pipe(os(s)),this.actions$=this.start$.pipe(Kn(()=>c)),this.liftedActions$=this.start$.pipe(Kn(()=>l))}unwrapAction(r){return typeof r=="string"?(0,eval)(`(${r})`):r}getExtensionConfig(r){let i={name:r.name,features:r.features,serialize:r.serialize,autoPause:r.autoPause??!1,trace:r.trace??!1,traceLimit:r.traceLimit??75};return r.maxAge!==!1&&(i.maxAge=r.maxAge),i}sendToReduxDevtools(r){try{r()}catch(i){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",i)}}};e.\u0275fac=function(i){return new(i||e)(G(Cd),G(ba),G(Ca))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})(),Aa={type:Fa},jP="@ngrx/store-devtools/recompute",zP={type:jP};function Fv(t,e,n,r,i){if(r)return{state:n,error:"Interrupted by an error up the chain"};let s=n,o;try{s=t(n,e)}catch(a){o=a.toString(),i.handleError(a)}return{state:s,error:o}}function Sa(t,e,n,r,i,s,o,a,c){if(e>=t.length&&t.length===s.length)return t;let l=t.slice(0,e),u=s.length-(c?1:0);for(let h=e;h<u;h++){let d=s[h],p=i[d].action,f=l[h-1],g=f?f.state:r,v=f?f.error:void 0,P=o.indexOf(d)>-1?f:Fv(n,p,g,v,a);l.push(P)}return c&&l.push(t[t.length-1]),l}function WP(t,e){return{monitorState:e(void 0,{}),nextActionId:1,actionsById:{0:ts(Aa)},stagedActionIds:[0],skippedActionIds:[],committedState:t,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function GP(t,e,n,r,i={}){return s=>(o,a)=>{let{monitorState:c,actionsById:l,nextActionId:u,stagedActionIds:h,skippedActionIds:d,committedState:p,currentStateIndex:f,computedStates:g,isLocked:v,isPaused:I}=o||e;o||(l=Object.create(l));function P(M){let A=M,$=h.slice(1,A+1);for(let B=0;B<$.length;B++)if(g[B+1].error){A=B,$=h.slice(1,A+1);break}else delete l[$[B]];d=d.filter(B=>$.indexOf(B)===-1),h=[0,...h.slice(A+1)],p=g[A].state,g=g.slice(A),f=f>A?f-A:0}function D(){l={0:ts(Aa)},u=1,h=[0],d=[],p=g[f].state,f=0,g=[]}let E=0;switch(a.type){case Rv:{v=a.status,E=1/0;break}case Pv:{I=a.status,I?(h=[...h,u],l[u]=new kr({type:"@ngrx/devtools/pause"},+Date.now()),u++,E=h.length-1,g=g.concat(g[g.length-1]),f===h.length-2&&f++,E=1/0):D();break}case wv:{l={0:ts(Aa)},u=1,h=[0],d=[],p=t,f=0,g=[];break}case Iv:{D();break}case Tv:{l={0:ts(Aa)},u=1,h=[0],d=[],f=0,g=[];break}case Av:{let{id:M}=a;d.indexOf(M)===-1?d=[M,...d]:d=d.filter($=>$!==M),E=h.indexOf(M);break}case FP:{let{start:M,end:A,active:$}=a,B=[];for(let Se=M;Se<A;Se++)B.push(Se);$?d=_v(d,B):d=[...d,...B],E=h.indexOf(M);break}case bv:{f=a.index,E=1/0;break}case Cv:{let M=h.indexOf(a.actionId);M!==-1&&(f=M),E=1/0;break}case Sv:{h=_v(h,d),d=[],f=Math.min(f,h.length-1);break}case ns:{if(v)return o||e;if(I||o&&Pd(o.computedStates[f],a,i.predicate,i.actionsSafelist,i.actionsBlocklist)){let A=g[g.length-1];g=[...g.slice(0,-1),Fv(s,a.action,A.state,A.error,n)],E=1/0;break}i.maxAge&&h.length===i.maxAge&&P(1),f===h.length-1&&f++;let M=u++;l[M]=a,h=[...h,M],E=h.length-1;break}case Rd:{({monitorState:c,actionsById:l,nextActionId:u,stagedActionIds:h,skippedActionIds:d,committedState:p,currentStateIndex:f,computedStates:g,isLocked:v,isPaused:I}=a.nextLiftedState);break}case Fa:{E=0,i.maxAge&&h.length>i.maxAge&&(g=Sa(g,E,s,p,l,h,d,n,I),P(h.length-i.maxAge),E=1/0);break}case Va:{if(g.filter(A=>A.error).length>0)E=0,i.maxAge&&h.length>i.maxAge&&(g=Sa(g,E,s,p,l,h,d,n,I),P(h.length-i.maxAge),E=1/0);else{if(!I&&!v){f===h.length-1&&f++;let A=u++;l[A]=new kr(a,+Date.now()),h=[...h,A],E=h.length-1,g=Sa(g,E,s,p,l,h,d,n,I)}g=g.map(A=>ce(Q({},A),{state:s(A.state,zP)})),f=h.length-1,i.maxAge&&h.length>i.maxAge&&P(h.length-i.maxAge),E=1/0}break}default:{E=1/0;break}}return g=Sa(g,E,s,p,l,h,d,n,I),c=r(c,a),{monitorState:c,actionsById:l,nextActionId:u,stagedActionIds:h,skippedActionIds:d,committedState:p,currentStateIndex:f,computedStates:g,isLocked:v,isPaused:I}}}var vv=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,u){let h=WP(l,u.monitor),d=GP(l,h,c,u.monitor,u),p=Gn(Gn(i.asObservable().pipe(Yd(1)),o.actions$).pipe(ie(ts)),r,o.liftedActions$).pipe(Dr(is)),f=s.pipe(ie(d)),g=Mv(u.connectInZone),v=new qd(1);this.liftedStateSubscription=p.pipe(as(f),Ev(g),Hd(({state:D},[E,M])=>{let A=M(D,E);return E.type!==ns&&xv(u)&&(A=$P(A,u.predicate,u.actionsSafelist,u.actionsBlocklist)),o.notify(E,A),{state:A,action:E}},{state:h,action:null})).subscribe(({state:D,action:E})=>{if(v.next(D),E.type===ns){let M=E.action;a.next(M)}}),this.extensionStartSubscription=o.start$.pipe(Ev(g)).subscribe(()=>{this.refresh()});let I=v.asObservable(),P=I.pipe(ie(kv));Object.defineProperty(P,"state",{value:Ef(P,{manualCleanup:!0,requireSync:!0})}),this.dispatcher=r,this.liftedState=I,this.state=P}ngOnDestroy(){this.liftedStateSubscription.unsubscribe(),this.extensionStartSubscription.unsubscribe()}dispatch(r){this.dispatcher.next(r)}next(r){this.dispatcher.next(r)}error(r){}complete(){}performAction(r){this.dispatch(new kr(r,+Date.now()))}refresh(){this.dispatch(new gd)}reset(){this.dispatch(new _d(+Date.now()))}rollback(){this.dispatch(new yd(+Date.now()))}commit(){this.dispatch(new vd(+Date.now()))}sweep(){this.dispatch(new Ed)}toggleAction(r){this.dispatch(new wd(r))}jumpToAction(r){this.dispatch(new Id(r))}jumpToState(r){this.dispatch(new Td(r))}importState(r){this.dispatch(new Sd(r))}lockChanges(r){this.dispatch(new Ad(r))}pauseRecording(r){this.dispatch(new bd(r))}};e.\u0275fac=function(i){return new(i||e)(G(Ca),G(us),G(Af),G(Lv),G(hs),G(ls),G(Tf),G(ba))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})();function Ev({ngZone:t,connectInZone:e}){return n=>e?new Kt(r=>n.subscribe({next:i=>t.run(()=>r.next(i)),error:i=>t.run(()=>r.error(i)),complete:()=>t.run(()=>r.complete())})):n}var KP=new Z("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function HP(t,e){return!!t||e.monitor!==Nv}function QP(){let t="__REDUX_DEVTOOLS_EXTENSION__";return typeof window=="object"&&typeof window[t]<"u"?window[t]:null}function Vv(t={}){return cs([Lv,Ca,vv,{provide:gv,useValue:t},{provide:KP,deps:[Cd,ba],useFactory:HP},{provide:Cd,useFactory:QP},{provide:ba,deps:[gv],useFactory:UP},{provide:Cf,deps:[vv],useFactory:YP},{provide:bf,useExisting:Ca}])}function YP(t){return t.state}var Ra=(()=>{let e=class e{constructor(){this.firestore=K(Vt),this.db=Pr(),this.dbPath="currentRound",this.getRounds$=Ct(()=>this.getRounds()),this.getCurrentRound$=Ct(()=>this.getCurrentRound())}incrementTry(r){let{userIndex:i,tries:s}=r;this.setTries(i,s),this.setCurrentTryPoints(i,0)}incrementPoints(r){let{userIndex:i,points:s,currentTryPoints:o,actionOrder:a}=r;this.setPoints(i,s),this.setCurrentTryPoints(i,o),this.setCurrentAction(i,a)}getRounds(){return m(this,null,function*(){let r=jt(this.db);try{let i=yield Zi(Xi(r,"rounds"));if(i.exists())return i.val();console.log("No current round available")}catch(i){console.error("error",i)}})}getCurrentRound(){return m(this,null,function*(){let r=jt(this.db);try{let i=yield Zi(Xi(r,this.dbPath));if(i.exists())return i.val();console.log("No current round available")}catch(i){console.error("error",i)}})}setTries(r,i){es(jt(this.db,`currentRound/users/${r}/tries`),i)}setCurrentTryPoints(r,i){es(jt(this.db,`currentRound/users/${r}/currentTry/points`),i)}setPoints(r,i){es(jt(this.db,`currentRound/users/${r}/points`),i)}setCurrentAction(r,i){es(jt(this.db,`currentRound/users/${r}/currentTry/currentAction`),i)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Nd(t){return Or(e=>{let n=t(e),r=Array.isArray(n)?n:[n];return Ht(e).pipe(as(...r))})}var Uv=(()=>{let e=class e{constructor(){this.actions=K(Nr),this.store=K(Yt),this.roundsService=K(Ra),this.getCurrentRound$=pn(()=>this.actions.pipe(mn(ds),Qt(()=>this.roundsService.getCurrentRound$.pipe(ie(r=>fs({currentRound:r})),Qe(()=>bt))))),this.incrementTries$=pn(()=>this.actions.pipe(mn(ps),Nd(()=>this.store.select(Ba)),Kn(([{userIndex:r},i])=>Ct(()=>(this.roundsService.incrementTry({userIndex:r,tries:this.userTries(i,r)}),Ht(null))).pipe(ie(()=>Ua()))))),this.incrementPoints$=pn(()=>this.actions.pipe(mn(ms),Nd(()=>this.store.select(Ba)),Kn(([{userIndex:r},i])=>Ct(()=>(this.roundsService.incrementPoints({userIndex:r,points:this.userPoints(i,r),currentTryPoints:this.userCurrentTryPoints(i,r),actionOrder:this.userActionOrder(i,r)}),Ht(null))).pipe(ie(()=>Ua())))))}userTries(r,i){return r.users[i].tries}userPoints(r,i){return r.users[i].points}userCurrentTryPoints(r,i){return r.users[i].currentTry.points}userActionOrder(r,i){return r.users[i].currentTry.currentAction}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})();var kd=function(t){return t[t.Starting=0]="Starting",t[t.Ongoing=1]="Ongoing",t[t.Cosed=2]="Cosed",t}(kd||{});var Dd={id:"",startedAt:0,status:kd.Starting,users:[]},Bv=Hn(Dd,je(ds,(t,e)=>t),je(fs,(t,{currentRound:e})=>e),je(Pf,(t,{pokemon:e,userId:n})=>{let r=t.users.findIndex(i=>i.id===n);if(r!==-1){let i=t.users.map((s,o)=>o===r?ce(Q({},s),{currentTry:ce(Q({},s.currentTry),{pokemon:e})}):s);return ce(Q({},t),{users:i})}return t}),je(ps,(t,{tries:e,userId:n})=>{let r=t.users.findIndex(i=>i.id===n);if(r!==-1){let i=t.users.map((s,o)=>o===r?ce(Q({},s),{tries:s.tries+1,currentTry:ce(Q({},s.currentTry),{currentAction:-1,points:0,pokemon:{id:1,name:"Bulbasaur"}})}):s);return ce(Q({},t),{users:i})}return t}),je(ms,(t,{points:e,actionOrder:n,userId:r})=>{let i=t.users.findIndex(s=>s.id===r);if(i!==-1){let s=t.users.map((o,a)=>a===i?ce(Q({},o),{points:o.points+e,currentTry:ce(Q({},o.currentTry),{points:o.currentTry.points+e,currentAction:n})}):o);return ce(Q({},t),{users:s})}return t}));var Od=[{bestTry:void 0,id:"",name:"",wins:""}],qv=Hn(Od,je(gs,(t,e)=>t),je(_s,(t,{users:e})=>e));var $v=(()=>{let e=class e{constructor(){this.getUsers$=Ct(()=>this.getUsers()),this.firestore=K(Vt),this.dbPath="users"}getUsers(){return m(this,null,function*(){let r=jt(Pr());try{let i=yield Zi(Xi(r,this.dbPath));if(i.exists())return i.val();console.log("No users available")}catch(i){console.error("error",i)}})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var jv=(()=>{let e=class e{constructor(){this.actions=K(Nr),this.usersService=K($v),this.getUsers$=pn(()=>this.actions.pipe(mn(gs),Qt(()=>this.usersService.getUsers$.pipe(ie(r=>_s({users:r})),Qe(()=>bt)))))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})();var xd=[],zv=Hn(xd,je(ys,(t,e)=>t),je(vs,(t,{rounds:e})=>e));var Wv=(()=>{let e=class e{constructor(){this.actions=K(Nr),this.store=K(Yt),this.roundsService=K(Ra),this.getRounds$=pn(()=>this.actions.pipe(mn(ys),Qt(()=>this.roundsService.getRounds$.pipe(ie(r=>vs({rounds:r})),Qe(()=>bt)))))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac});let t=e;return t})();var Gv={rounds:xd,currentRound:Dd,users:Od},Kv={rounds:zv,currentRound:Bv,users:qv},Hv=[],Qv=[Wv,Uv,jv];var Yv={providers:[yf(Nf),gf(),op(),uv,mv(Qv),Rf(Kv,{metaReducers:Hv,initialState:Gv}),Vv({maxAge:25,logOnly:!df(),connectInZone:!0})]};var Jv=(()=>{let e=class e{constructor(){this.title="PIL"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Xd({type:e,selectors:[["app-root"]],standalone:!0,features:[lf],decls:3,vars:0,template:function(i,s){i&1&&(of(0,"main"),cf(1,"app-navbar")(2,"router-outlet"),af())},dependencies:[_f,vf],styles:["[_nghost-%COMP%]   main[_ngcontent-%COMP%]{background-color:var(--color-dark-blue);min-height:100%;max-width:100vw;overflow-x:hidden;max-height:100vh}"]});let t=e;return t})();mf(Jv,Yv).catch(t=>console.error(t));
